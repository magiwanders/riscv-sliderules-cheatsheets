(function(n,a){typeof exports=="object"&&typeof module<"u"?module.exports=a():typeof define=="function"&&define.amd?define(a):(n=typeof globalThis<"u"?globalThis:n||self,n["riscv-sliderules-cheatsheets"]=a())})(this,function(){"use strict";function Encoder(){return _div({class:"input-wrapper",id:"encoder"},[_input({id:"assemblyString",type:"text",placeholder:"Assembly string"}),_br(),_button({onclick:"sliderules.updateEncode()"},"Encode"),_br()])}function Decoder(){return _div({id:"decoder"},[_div({class:"input-wrapper"},[_input({id:"encodedvalue",type:"text",placeholder:"Enter 32 bit binary value to decode, like: 00000000001000001000000000110011"})]),_br(),_button({onclick:"sliderules.updateDecode()"},"Decode"),_br()])}function Pruner(){var n=32,a=[],c=["","0","1"];function f(q){var d=q.target,o=c.indexOf(d.textContent),h=(o+1)%c.length;d.textContent=c[h],sliderules.updatePruned()}for(var k=0;k<n;k++){var R=_button({class:"bit-button",textContent:""});R.addEventListener("click",f),a.push(R)}return _div({id:"pruner"},a)}const immediates={I:{[2047<<20]:2047,[1<<31]:-2048},S:{3968:31,[63<<25]:2016,[1<<31]:-2048},B:{3840:30,128:2048,[63<<25]:2016,[1<<31]:-4096},U:{[-4096]:-4096},J:{1044480:1044480,[1<<20]:2048,[1023<<21]:2046,[1<<31]:-1048576}},instructions={add:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = rs1 + rs2",description:"Addition",type:"R",arch_width:[32,64],extension:"I",fields:{opcode:{value:51,mask:127},funct3:{value:0,mask:28672},funct7:{value:0,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},sub:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = rs1 - rs2",description:"Subtraction",type:"R",arch_width:[32,64],extension:"I",fields:{opcode:{value:51,mask:127},funct3:{value:0,mask:28672},funct7:{value:32,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},xor:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = rs1 ^ rs2",description:"Bitwise XOR",type:"R",arch_width:[32,64],extension:"I",fields:{opcode:{value:51,mask:127},funct3:{value:4,mask:28672},funct7:{value:0,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},slt:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = { 31'b0, ( rs1[31] == rs2[31] ) ? (rs1<rs2) : (rs1[31])}",description:"Set Less Than",type:"R",arch_width:[32,64],extension:"I",fields:{opcode:{value:51,mask:127},funct3:{value:2,mask:28672},funct7:{value:0,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},or:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = rs1 | rs2",description:"Bitwise OR",type:"R",arch_width:[32,64],extension:"I",fields:{opcode:{value:51,mask:127},funct3:{value:6,mask:28672},funct7:{value:0,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},sll:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = rs1 <<(zero extends) rs2",description:"Shift Left Logical",type:"R",arch_width:[32,64],extension:"I",fields:{opcode:{value:51,mask:127},funct3:{value:1,mask:28672},funct7:{value:0,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},srl:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = rs1 (zero extends)>> rs2",description:"Shift Right Logical",type:"R",arch_width:[32,64],extension:"I",fields:{opcode:{value:51,mask:127},funct3:{value:5,mask:28672},funct7:{value:0,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},sra:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = rs1 (msb extends)>> rs2",description:"Shift Right Arithmetic",type:"R",arch_width:[32,64],extension:"I",fields:{opcode:{value:51,mask:127},funct3:{value:5,mask:28672},funct7:{value:32,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},sltu:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = { 31'b0, rs1 < rs2 }",description:"Set Less Than Unsigned",type:"R",arch_width:[32,64],extension:"I",fields:{opcode:{value:51,mask:127},funct3:{value:3,mask:28672},funct7:{value:0,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},and:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = rs1 & rs2",description:"Bitwise AND",type:"R",arch_width:[32,64],extension:"I",fields:{opcode:{value:51,mask:127},funct3:{value:7,mask:28672},funct7:{value:0,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},addi:{ISA:"RV",assembly:["rd","rs1","imm"],pseudocode:"rd = rs1 + imm",description:"Add Immediate",type:"I",arch_width:[32,64],extension:"I",fields:{opcode:{value:19,mask:127},funct3:{value:0,mask:28672},rs1:{mask:31<<15},rd:{mask:3968}}},slti:{ISA:"RV",assembly:["rd","rs1","imm"],pseudocode:"rd = (rs1 < imm) ? 1 : 0",description:"Set Less Than Immediate",type:"I",arch_width:[32,64],extension:"I",fields:{opcode:{value:19,mask:127},funct3:{value:2,mask:28672},rs1:{mask:31<<15},rd:{mask:3968}}},sltiu:{ISA:"RV",assembly:["rd","rs1","imm"],pseudocode:"rd = (rs1 < imm) ? 1 : 0",description:"Set Less Than Immediate Unsigned",type:"I",arch_width:[32,64],extension:"I",fields:{opcode:{value:19,mask:127},funct3:{value:3,mask:28672},rs1:{mask:31<<15},rd:{mask:3968}}},xori:{ISA:"RV",assembly:["rd","rs1","imm"],pseudocode:"rd = rs1 ^ imm",description:"Bitwise XOR Immediate",type:"I",arch_width:[32,64],extension:"I",fields:{opcode:{value:19,mask:127},funct3:{value:4,mask:28672},rs1:{mask:31<<15},rd:{mask:3968}}},ori:{ISA:"RV",assembly:["rd","rs1","imm"],pseudocode:"rd = rs1 | imm",description:"Bitwise OR Immediate",type:"I",arch_width:[32,64],extension:"I",fields:{opcode:{value:19,mask:127},funct3:{value:6,mask:28672},rs1:{mask:31<<15},rd:{mask:3968}}},andi:{ISA:"RV",assembly:["rd","rs1","imm"],pseudocode:"rd = rs1 & imm",description:"Bitwise AND Immediate",type:"I",arch_width:[32,64],extension:"I",fields:{opcode:{value:19,mask:127},funct3:{value:7,mask:28672},rs1:{mask:31<<15},rd:{mask:3968}}},lb:{ISA:"RV",assembly:["rd","rs1","imm"],pseudocode:"rd = M[rs1 + imm]",description:"Load Byte",type:"I",arch_width:[32,64],extension:"I",fields:{opcode:{value:3,mask:127},funct3:{value:0,mask:28672},rs1:{mask:31<<15},rd:{mask:3968}}},lh:{ISA:"RV",assembly:["rd","rs1","imm"],pseudocode:"rd = M[rs1 + imm]",description:"Load Halfword",type:"I",arch_width:[32,64],extension:"I",fields:{opcode:{value:3,mask:127},funct3:{value:1,mask:28672},rs1:{mask:31<<15},rd:{mask:3968}}},lw:{ISA:"RV",assembly:["rd","rs1","imm"],pseudocode:"rd = M[rs1 + imm]",description:"Load Word",type:"I",arch_width:[32,64],extension:"I",fields:{opcode:{value:3,mask:127},funct3:{value:2,mask:28672},rs1:{mask:31<<15},rd:{mask:3968}}},lbu:{ISA:"RV",assembly:["rd","rs1","imm"],pseudocode:"rd = M[rs1 + imm]",description:"Load Byte Unsigned",type:"I",arch_width:[32,64],extension:"I",fields:{opcode:{value:3,mask:127},funct3:{value:4,mask:28672},rs1:{mask:31<<15},rd:{mask:3968}}},lhu:{ISA:"RV",assembly:["rd","rs1","imm"],pseudocode:"rd = M[rs1 + imm]",description:"Load Halfword Unsigned",type:"I",arch_width:[32,64],extension:"I",fields:{opcode:{value:3,mask:127},funct3:{value:5,mask:28672},rs1:{mask:31<<15},rd:{mask:3968}}},jalr:{ISA:"RV",assembly:["rd","rs1","imm"],pseudocode:"rd = PC + 4; PC = (rs1 + imm) & ~1",description:"Jump and Link Register",type:"I",arch_width:[32,64],extension:"I",fields:{opcode:{value:103,mask:127},funct3:{value:0,mask:28672},rs1:{mask:31<<15},rd:{mask:3968}}},lui:{ISA:"RV",assembly:["rd","imm"],pseudocode:"rd = imm << 12",description:"Load Upper Immediate",type:"U",arch_width:[32,64],extension:"I",fields:{opcode:{value:55,mask:127},rd:{mask:3968}}},auipc:{ISA:"RV",assembly:["rd","imm"],pseudocode:"rd = PC + imm",description:"Add Upper Immediate to PC",type:"U",arch_width:[32,64],extension:"I",fields:{opcode:{value:23,mask:127},rd:{mask:3968}}},jal:{ISA:"RV",assembly:["rd","imm"],pseudocode:"rd = PC + 4; PC = PC + imm",description:"Jump and Link",type:"J",arch_width:[32,64],extension:"I",fields:{opcode:{value:111,mask:127},rd:{mask:3968}}},beq:{ISA:"RV",assembly:["rs1","rs2","imm"],pseudocode:"if(rs1 == rs2) PC = PC + imm",description:"Branch Equal",type:"B",arch_width:[32,64],extension:"I",fields:{opcode:{value:99,mask:127},funct3:{value:0,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20}}},bne:{ISA:"RV",assembly:["rs1","rs2","imm"],pseudocode:"if(rs1 != rs2) PC = PC + imm",description:"Branch Not Equal",type:"B",arch_width:[32,64],extension:"I",fields:{opcode:{value:99,mask:127},funct3:{value:1,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20}}},blt:{ISA:"RV",assembly:["rs1","rs2","imm"],pseudocode:"if(rs1 < rs2) PC = PC + imm",description:"Branch Less Than",type:"B",arch_width:[32,64],extension:"I",fields:{opcode:{value:99,mask:127},funct3:{value:4,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20}}},bge:{ISA:"RV",assembly:["rs1","rs2","imm"],pseudocode:"if(rs1 >= rs2) PC = PC + imm",description:"Branch Greater Than or Equal",type:"B",arch_width:[32,64],extension:"I",fields:{opcode:{value:99,mask:127},funct3:{value:5,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20}}},bltu:{ISA:"RV",assembly:["rs1","rs2","imm"],pseudocode:"if(rs1 < rs2) PC = PC + imm",description:"Branch Less Than Unsigned",type:"B",arch_width:[32,64],extension:"I",fields:{opcode:{value:99,mask:127},funct3:{value:6,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20}}},bgeu:{ISA:"RV",assembly:["rs1","rs2","imm"],pseudocode:"if(rs1 >= rs2) PC = PC + imm",description:"Branch Greater Than or Equal Unsigned",type:"B",arch_width:[32,64],extension:"I",fields:{opcode:{value:99,mask:127},funct3:{value:7,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20}}},sb:{ISA:"RV",assembly:["rs1","rs2","imm"],pseudocode:"Memory[rs1 + imm] = rs2[0:7]",description:"Store Byte",type:"S",arch_width:[32,64],extension:"I",fields:{opcode:{value:35,mask:127},funct3:{value:0,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20}}},sh:{ISA:"RV",assembly:["rs1","rs2","imm"],pseudocode:"Memory[rs1 + imm] = rs2[0:15]",description:"Store Halfword",type:"S",arch_width:[32,64],extension:"I",fields:{opcode:{value:35,mask:127},funct3:{value:1,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20}}},sw:{ISA:"RV",assembly:["rs1","rs2","imm"],pseudocode:"Memory[rs1 + imm] = rs2",description:"Store Word",type:"S",arch_width:[32,64],extension:"I",fields:{opcode:{value:35,mask:127},funct3:{value:2,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20}}},slli:{ISA:"RV",assembly:["rd","rs1","shamt"],pseudocode:"rd = rs1 << shamt",description:"Shift Left Logical Immediate",type:"I",arch_width:[32,64],extension:"I",fields:{opcode:{value:19,mask:127},funct3:{value:1,mask:28672},funct7:{value:0,mask:127<<25},rs1:{mask:31<<15},shamt:{mask:31<<20},rd:{mask:3968}}},srli:{ISA:"RV",assembly:["rd","rs1","shamt"],pseudocode:"rd = rs1 >>> shamt",description:"Shift Right Logical Immediate",type:"I",arch_width:[32,64],extension:"I",fields:{opcode:{value:19,mask:127},funct3:{value:5,mask:28672},funct7:{value:0,mask:127<<25},rs1:{mask:31<<15},shamt:{mask:31<<20},rd:{mask:3968}}},srai:{ISA:"RV",assembly:["rd","rs1","shamt"],pseudocode:"rd = rs1 >> shamt",description:"Shift Right Arithmetic Immediate",type:"I",arch_width:[32,64],extension:"I",fields:{opcode:{value:19,mask:127},funct3:{value:5,mask:28672},funct7:{value:32,mask:127<<25},rs1:{mask:31<<15},shamt:{mask:31<<20},rd:{mask:3968}}},fence:{ISA:"RV",assembly:["pred","succ"],pseudocode:"Fence(pred, succ)",description:"Synchronize",type:"I",arch_width:[32,64],extension:"I",fields:{opcode:{value:15,mask:127},rd:{mask:3968},funct3:{value:0,mask:28672},rs1:{mask:31<<15},succ:{mask:15<<20},pred:{mask:15<<24},fm:{mask:15<<28}}},ecall:{ISA:"RV",assembly:["ecall"],pseudocode:"ECALL",description:"Environment Call",type:"I",arch_width:[32,64],extension:"I",fields:{opcode:{value:115,mask:127},funct3:{value:0,mask:28672},rd:{value:0,mask:3968},rs1:{value:0,mask:31<<15},funct12:{value:0,mask:-1048576}}},ebreak:{ISA:"RV",assembly:["ebreak"],pseudocode:"EBREAK",description:"Environment Breakpoint",type:"I",arch_width:[32,64],extension:"I",fields:{opcode:{value:115,mask:127},funct3:{value:0,mask:28672},rd:{value:0,mask:3968},rs1:{value:0,mask:31<<15},funct12:{value:1,mask:-1048576}}},lwu:{ISA:"RV",assembly:["rd","imm(rs1)"],pseudocode:"rd = M[rs1 + imm]",description:"Load Word Unsigned",type:"I",arch_width:[64],extension:"I",fields:{opcode:{value:3,mask:127},funct3:{value:6,mask:28672},rs1:{mask:31<<15},rd:{mask:3968}}},ld:{ISA:"RV",assembly:["rd","imm(rs1)"],pseudocode:"rd = M[rs1 + imm]",description:"Load Doubleword",type:"I",arch_width:[64],extension:"I",fields:{opcode:{value:3,mask:127},funct3:{value:3,mask:28672},rs1:{mask:31<<15},rd:{mask:3968}}},sd:{ISA:"RV",assembly:["rs2","imm(rs1)"],pseudocode:"M[rs1 + imm] = rs2",description:"Store Doubleword",type:"S",arch_width:[64],extension:"I",fields:{opcode:{value:35,mask:127},funct3:{value:3,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20}}},slli64:{ISA:"RV",assembly:["rd","rs1","shamt"],pseudocode:"rd = rs1 << shamt",description:"Shift Left Logical Immediate (64-bit)",type:"I",arch_width:[64],extension:"I",fields:{opcode:{value:19,mask:127},funct3:{value:1,mask:28672},imm:{value:0,mask:127<<26},rs1:{mask:31<<15},shamt:{mask:63<<20},rd:{mask:3968}}},srli64:{ISA:"RV",assembly:["rd","rs1","shamt"],pseudocode:"rd = rs1 >> shamt (logical)",description:"Shift Right Logical Immediate (64-bit)",type:"I",arch_width:[64],extension:"I",fields:{opcode:{value:19,mask:127},funct3:{value:5,mask:28672},imm:{value:0,mask:127<<26},rs1:{mask:31<<15},shamt:{mask:63<<20},rd:{mask:3968}}},srai64:{ISA:"RV",assembly:["rd","rs1","shamt"],pseudocode:"rd = rs1 >> shamt (arithmetic)",description:"Shift Right Arithmetic Immediate (64-bit)",type:"I",arch_width:[64],extension:"I",fields:{opcode:{value:19,mask:127},funct3:{value:5,mask:28672},imm:{value:16,mask:127<<26},rs1:{mask:31<<15},shamt:{mask:63<<20},rd:{mask:3968}}},addiw:{ISA:"RV",assembly:["rd","rs1","imm"],pseudocode:"rd = rs1 + imm (signed immediate)",description:"Add Immediate (64-bit)",type:"I",arch_width:[64],extension:"I",fields:{opcode:{value:27,mask:127},funct3:{value:0,mask:28672},rs1:{mask:31<<15},rd:{mask:3968}}},slliw:{ISA:"RV",assembly:["rd","rs1","shamt"],pseudocode:"rd = rs1 << shamt (64-bit)",description:"Shift Left Logical Immediate (64-bit)",type:"I",arch_width:[64],extension:"I",fields:{opcode:{value:27,mask:127},funct3:{value:1,mask:28672},funct7:{value:0,mask:127<<25},rs1:{mask:31<<15},shamt:{mask:31<<20},rd:{mask:3968}}},srliw:{ISA:"RV",assembly:["rd","rs1","shamt"],pseudocode:"rd = rs1 >> shamt (logical, 64-bit)",description:"Shift Right Logical Immediate (64-bit)",type:"I",arch_width:[64],extension:"I",fields:{opcode:{value:27,mask:127},funct3:{value:5,mask:28672},funct7:{value:0,mask:127<<25},rs1:{mask:31<<15},shamt:{mask:31<<20},rd:{mask:3968}}},sraiw:{ISA:"RV",assembly:["rd","rs1","shamt"],pseudocode:"rd = rs1 >> shamt (arithmetic, 64-bit)",description:"Shift Right Arithmetic Immediate (64-bit)",type:"I",arch_width:[64],extension:"I",fields:{opcode:{value:27,mask:127},funct3:{value:5,mask:20480},funct7:{value:32,mask:127<<25},rs1:{mask:31<<15},shamt:{mask:31<<20},rd:{mask:3968}}},addw:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = rs1 + rs2 (64-bit)",description:"Add (64-bit)",type:"R",arch_width:[64],extension:"I",fields:{opcode:{value:59,mask:127},funct3:{value:0,mask:28672},funct7:{value:0,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},subw:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = rs1 - rs2 (64-bit)",description:"Subtract (64-bit)",type:"R",arch_width:[64],extension:"I",fields:{opcode:{value:59,mask:127},funct3:{value:0,mask:28672},funct7:{value:32,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},sllw:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = rs1 << rs2 (64-bit)",description:"Shift Left Logical (64-bit)",type:"R",arch_width:[64],extension:"I",fields:{opcode:{value:59,mask:127},funct3:{value:1,mask:28672},funct7:{value:0,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},srlw:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = rs1 >> rs2 (logical, 64-bit)",description:"Shift Right Logical (64-bit)",type:"R",arch_width:[64],extension:"I",fields:{opcode:{value:59,mask:127},funct3:{value:5,mask:28672},funct7:{value:0,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},sraw:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = rs1 >> rs2 (arithmetic, 64-bit)",description:"Shift Right Arithmetic (64-bit)",type:"R",arch_width:[64],extension:"I",fields:{opcode:{value:59,mask:127},funct3:{value:5,mask:20480},funct7:{value:32,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},fence_i:{ISA:"RV",assembly:["imm","rs1"],pseudocode:"fence",description:"Fence for instruction stream",type:"I",arch_width:[32,64],extension:"Zifencei",fields:{opcode:{value:15,mask:127},funct3:{value:1,mask:28672},rs1:{mask:31<<15},rd:{mask:3968}}},csrrw:{ISA:"RV",assembly:["csr","rd","rs1"],pseudocode:"rd = CSRs[csr]; CSRs[csr] = rs1",description:"Atomic Read and Write of CSR",type:"I",arch_width:[32,64],extension:"Zicsr",fields:{opcode:{value:115,mask:127},funct3:{value:1,mask:28672},csr:{mask:-1048576},rs1:{mask:31<<15},rd:{mask:3968}}},csrrs:{ISA:"RV",assembly:["csr","rd","rs1"],pseudocode:"rd = CSRs[csr]; CSRs[csr] = CSRs[csr] | rs1",description:"Atomic Read and Set of CSR Bits",type:"I",arch_width:[32,64],extension:"Zicsr",fields:{opcode:{value:115,mask:127},funct3:{value:2,mask:28672},csr:{mask:-1048576},rs1:{mask:31<<15},rd:{mask:3968}}},csrrc:{ISA:"RV",assembly:["csr","rd","rs1"],pseudocode:"rd = CSRs[csr]; CSRs[csr] = CSRs[csr] & (~rs1)",description:"Atomic Read and Clear of CSR Bits",type:"I",arch_width:[32,64],extension:"Zicsr",fields:{opcode:{value:115,mask:127},funct3:{value:3,mask:28672},csr:{mask:-1048576},rs1:{mask:31<<15},rd:{mask:3968}}},csrrwi:{ISA:"RV",assembly:["uimm","rd","csr"],pseudocode:"rd = CSRs[csr]; CSRs[csr] = uimm",description:"Atomic Read and Write of CSR with Immediate",type:"I",arch_width:[32,64],extension:"Zicsr",fields:{opcode:{value:115,mask:127},funct3:{value:5,mask:28672},csr:{mask:-1048576},uimm:{mask:31<<15},rd:{mask:3968}}},csrrsi:{ISA:"RV",assembly:["uimm","rd","csr"],pseudocode:"rd = CSRs[csr]; CSRs[csr] = CSRs[csr] | uimm",description:"Atomic Read and Set of CSR Bits with Immediate",type:"I",arch_width:[32,64],extension:"Zicsr",fields:{opcode:{value:115,mask:127},funct3:{value:6,mask:28672},csr:{mask:-1048576},uimm:{mask:31<<15},rd:{mask:3968}}},csrrci:{ISA:"RV",assembly:["uimm","rd","csr"],pseudocode:"rd = CSRs[csr]; CSRs[csr] = CSRs[csr] & (~uimm)",description:"Atomic Read and Clear of CSR Bits with Immediate",type:"I",arch_width:[32,64],extension:"Zicsr",fields:{opcode:{value:115,mask:127},funct3:{value:7,mask:28672},csr:{mask:-1048576},uimm:{mask:31<<15},rd:{mask:3968}}},mul:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = rs1 * rs2",description:"Multiply",type:"R",arch_width:[32,64],extension:"M",fields:{opcode:{value:51,mask:127},funct3:{value:0,mask:28672},funct7:{value:1,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},mulh:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = (rs1 * rs2) >> XLEN",description:"Multiply High",type:"R",arch_width:[32,64],extension:"M",fields:{opcode:{value:51,mask:127},funct3:{value:1,mask:28672},funct7:{value:1,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},mulhsu:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = (rs1 * rs2) >> XLEN",description:"Multiply High Signed Unsigned",type:"R",arch_width:[32,64],extension:"M",fields:{opcode:{value:51,mask:127},funct3:{value:2,mask:28672},funct7:{value:1,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},mulhu:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = (rs1 * rs2) >> XLEN",description:"Multiply High Unsigned",type:"R",arch_width:[32,64],extension:"M",fields:{opcode:{value:51,mask:127},funct3:{value:3,mask:28672},funct7:{value:1,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},div:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = rs1 / rs2",description:"Divide",type:"R",arch_width:[32,64],extension:"M",fields:{opcode:{value:51,mask:127},funct3:{value:4,mask:28672},funct7:{value:1,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},divu:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = rs1 / rs2",description:"Divide Unsigned",type:"R",arch_width:[32,64],extension:"M",fields:{opcode:{value:51,mask:127},funct3:{value:5,mask:28672},funct7:{value:1,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},rem:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = rs1 % rs2",description:"Remainder",type:"R",arch_width:[32,64],extension:"M",fields:{opcode:{value:51,mask:127},funct3:{value:6,mask:28672},funct7:{value:1,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},remu:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = rs1 % rs2",description:"Remainder Unsigned",type:"R",arch_width:[32,64],extension:"M",fields:{opcode:{value:51,mask:127},funct3:{value:7,mask:28672},funct7:{value:1,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},mulw:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = rs1 * rs2 (signed 64x64-bit multiplication, result stored in 64-bit rd)",description:"Multiply Word",type:"R",arch_width:[64],extension:"M",fields:{opcode:{value:59,mask:127},funct3:{value:0,mask:28672},funct7:{value:1,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},divw:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = rs1 / rs2 (signed 64/64-bit division, quotient stored in 64-bit rd)",description:"Divide Word",type:"R",arch_width:[64],extension:"M",fields:{opcode:{value:59,mask:127},funct3:{value:4,mask:28672},funct7:{value:1,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},divuw:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = rs1 / rs2 (unsigned 64/64-bit division, quotient stored in 64-bit rd)",description:"Divide Unsigned Word",type:"R",arch_width:[64],extension:"M",fields:{opcode:{value:59,mask:127},funct3:{value:5,mask:28672},funct7:{value:1,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},remw:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = rs1 % rs2 (signed 64/64-bit remainder, result stored in 64-bit rd)",description:"Remainder Word",type:"R",arch_width:[64],extension:"M",fields:{opcode:{value:59,mask:127},funct3:{value:6,mask:28672},funct7:{value:1,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},remuw:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = rs1 % rs2 (unsigned 64/64-bit remainder, result stored in 64-bit rd)",description:"Remainder Unsigned Word",type:"R",arch_width:[64],extension:"M",fields:{opcode:{value:59,mask:127},funct3:{value:7,mask:28672},funct7:{value:1,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},lr_w:{ISA:"RV",assembly:["rd","rs1","aq","rl"],pseudocode:"rd = M[rs1]; if aq then aq = 0; if rl then rl = 0;",description:"Load Reserved (Word)",type:"R",arch_width:[32,64],extension:"A",fields:{opcode:{value:47,mask:127},funct3:{value:2,mask:28672},funct5:{value:2,mask:31<<27},rs2:{value:0,mask:31<<20},aq:{mask:1<<26},rl:{mask:1<<25},rs1:{mask:31<<15},rd:{mask:3968}}},sc_w:{ISA:"RV",assembly:["rd","rs1","aq","rl","rs2"],pseudocode:"rd = M[rs1]; if aq then aq = 0; if rl then rl = 0; if successful SC, rd = 0; else rd = 1;",description:"Store Conditional (Word)",type:"R",arch_width:[32,64],extension:"A",fields:{opcode:{value:47,mask:127},funct3:{value:2,mask:28672},funct5:{value:3,mask:31<<27},aq:{mask:1<<26},rl:{mask:1<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},amoswap_w:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = M[rs1]; if aq then aq = 0; if rl then rl = 0; M[rs1] = rs2;",description:"Atomic Swap (Word)",type:"R",arch_width:[32,64],extension:"A",fields:{opcode:{value:47,mask:127},funct3:{value:2,mask:28672},funct5:{value:1,mask:31<<27},aq:{mask:1<<26},rl:{mask:1<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},amoadd_w:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = Memory[rs1]; Memory[rs1] = rd + rs2;",description:"Atomic Add Word",type:"R",arch_width:[32,64],extension:"A",fields:{opcode:{value:47,mask:127},funct3:{value:2,mask:28672},funct5:{value:0,mask:31<<27},aq:{mask:1<<26},rl:{mask:1<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},amoxor_w:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = Memory[rs1]; Memory[rs1] = rd ^ rs2;",description:"Atomic XOR Word",type:"R",arch_width:[32,64],extension:"A",fields:{opcode:{value:47,mask:127},funct3:{value:2,mask:28672},funct5:{value:4,mask:31<<27},aq:{mask:1<<26},rl:{mask:1<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},amoand_w:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = Memory[rs1]; Memory[rs1] = rd & rs2;",description:"Atomic AND Word",type:"R",arch_width:[32,64],extension:"A",fields:{opcode:{value:47,mask:127},funct3:{value:2,mask:28672},funct5:{value:12,mask:31<<27},aq:{mask:1<<26},rl:{mask:1<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},amoor_w:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = Memory[rs1]; Memory[rs1] = rd | rs2;",description:"Atomic OR Word",type:"R",arch_width:[32,64],extension:"A",fields:{opcode:{value:47,mask:127},funct3:{value:2,mask:28672},funct5:{value:8,mask:31<<27},aq:{mask:1<<26},rl:{mask:1<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},amomin_w:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = Memory[rs1]; Memory[rs1] = min(rd, rs2);",description:"Atomic Minimum Word",type:"R",arch_width:[32,64],extension:"A",fields:{opcode:{value:47,mask:127},funct3:{value:2,mask:28672},funct5:{value:16,mask:31<<27},aq:{mask:1<<26},rl:{mask:1<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},amomax_w:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = Memory[rs1]; Memory[rs1] = max(rd, rs2);",description:"Atomic Maximum Word",type:"R",arch_width:[32,64],extension:"A",fields:{opcode:{value:47,mask:127},funct3:{value:2,mask:28672},funct5:{value:20,mask:31<<27},aq:{mask:1<<26},rl:{mask:1<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},amominu_w:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = Memory[rs1]; Memory[rs1] = minu(rd, rs2);",description:"Atomic Minimum Unsigned Word",type:"R",arch_width:[32,64],extension:"A",fields:{opcode:{value:47,mask:127},funct3:{value:2,mask:28672},funct5:{value:24,mask:31<<27},aq:{mask:1<<26},rl:{mask:1<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},amomaxu_w:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = Memory[rs1]; Memory[rs1] = maxu(rd, rs2);",description:"Atomic Maximum Unsigned Word",type:"R",arch_width:[32,64],extension:"A",fields:{opcode:{value:47,mask:127},funct3:{value:2,mask:28672},funct5:{value:28,mask:31<<27},aq:{mask:1<<26},rl:{mask:1<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},lr_d:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = Memory[rs1];",description:"Load Reserved Doubleword",type:"R",arch_width:[64],extension:"A",fields:{opcode:{value:47,mask:127},funct3:{value:3,mask:28672},funct5:{value:2,mask:31<<27},rs2:{value:0,mask:31<<20},aq:{mask:1<<26},rl:{mask:1<<25},rs1:{mask:31<<15},rd:{mask:3968}}},sc_d:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"if (Memory[rs1] == rd) { Memory[rs1] = rs2; rd = 1; } else rd = 0;",description:"Store Conditional Doubleword",type:"R",arch_width:[64],extension:"A",fields:{opcode:{value:47,mask:127},funct3:{value:3,mask:28672},funct5:{value:3,mask:31<<27},aq:{mask:1<<26},rl:{mask:1<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},amoswap_d:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = Memory[rs1]; Memory[rs1] = rs2;",description:"Atomic Swap Doubleword",type:"R",arch_width:[64],extension:"A",fields:{opcode:{value:47,mask:127},funct3:{value:3,mask:28672},funct5:{value:1,mask:31<<27},aq:{mask:1<<26},rl:{mask:1<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},amoadd_d:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = Memory[rs1]; Memory[rs1] = rd + rs2;",description:"Atomic Add Double",type:"R",arch_width:[64],extension:"A",fields:{opcode:{value:47,mask:127},funct3:{value:3,mask:28672},funct5:{value:1,mask:31<<27},aq:{mask:1<<26},rl:{mask:1<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},amoxor_d:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = Memory[rs1]; Memory[rs1] = rd ^ rs2;",description:"Atomic XOR Double",type:"R",arch_width:[64],extension:"A",fields:{opcode:{value:47,mask:127},funct3:{value:3,mask:28672},funct5:{value:4,mask:31<<27},aq:{mask:1<<26},rl:{mask:1<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},amoand_d:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = Memory[rs1]; Memory[rs1] = rd & rs2;",description:"Atomic AND Double",type:"R",arch_width:[64],extension:"A",fields:{opcode:{value:47,mask:127},funct3:{value:3,mask:28672},funct5:{value:12,mask:31<<27},aq:{mask:1<<26},rl:{mask:1<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},amoor_d:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = Memory[rs1]; Memory[rs1] = rd | rs2;",description:"Atomic OR Double",type:"R",arch_width:[64],extension:"A",fields:{opcode:{value:47,mask:127},funct3:{value:3,mask:28672},funct5:{value:8,mask:31<<27},aq:{mask:1<<26},rl:{mask:1<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},amomin_d:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = Memory[rs1]; Memory[rs1] = min(rd, rs2);",description:"Atomic Minimum Double",type:"R",arch_width:[64],extension:"A",fields:{opcode:{value:47,mask:127},funct3:{value:3,mask:28672},funct5:{value:16,mask:31<<27},aq:{mask:1<<26},rl:{mask:1<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},amomax_d:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = Memory[rs1]; Memory[rs1] = max(rd, rs2);",description:"Atomic Maximum Double",type:"R",arch_width:[64],extension:"A",fields:{opcode:{value:47,mask:127},funct3:{value:3,mask:28672},funct5:{value:20,mask:31<<27},aq:{mask:1<<26},rl:{mask:1<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},amominu_d:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = Memory[rs1]; Memory[rs1] = min(rd, rs2);",description:"Atomic Minimum Unsigned Double",type:"R",arch_width:[64],extension:"A",fields:{opcode:{value:47,mask:127},funct3:{value:3,mask:28672},funct5:{value:24,mask:31<<27},aq:{mask:1<<26},rl:{mask:1<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},amomaxu_d:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = Memory[rs1]; Memory[rs1] = max(rd, rs2);",description:"Atomic Maximum Unsigned Double",type:"R",arch_width:[64],extension:"A",fields:{opcode:{value:47,mask:127},funct3:{value:3,mask:28672},funct5:{value:28,mask:31<<27},aq:{mask:1<<26},rl:{mask:1<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},flw:{ISA:"RV",assembly:["rd","rs1","imm"],pseudocode:"f(rd) = Memory[rs1 + imm];",description:"Load Floating-Point Word",type:"I",arch_width:[32,64],extension:"F",fields:{opcode:{value:7,mask:127},funct3:{value:2,mask:28672},rs1:{mask:31<<15},rd:{mask:3968}}},fsw:{ISA:"RV",assembly:["rd","rs1","rs2","imm"],pseudocode:"Memory[rs1 + imm] = f(rs2);",description:"Store Floating-Point Word",type:"S",arch_width:[32,64],extension:"F",fields:{opcode:{value:39,mask:127},funct3:{value:2,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20}}},fmadd_s:{ISA:"RV",assembly:["rd","rs1","rs2","rs3"],pseudocode:"f(rd) = f(rs1) * f(rs2) + f(rs3);",description:"Floating-Point Multiply-Add Single Precision",type:"R4",arch_width:[32,64],extension:"F",fields:{opcode:{value:67,mask:127},funct2:{value:0,mask:3<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rs3:{mask:31<<27},rd:{mask:3968},rm:{mask:28672}}},fmsub_s:{ISA:"RV",assembly:["rd","rs1","rs2","rs3"],pseudocode:"f(rd) = f(rs1) * f(rs2) - f(rs3);",description:"Floating-Point Multiply-Subtract Single Precision",type:"R4",arch_width:[32,64],extension:"F",fields:{opcode:{value:71,mask:127},funct2:{value:0,mask:3<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rs3:{mask:31<<27},rd:{mask:3968},rm:{mask:28672}}},fnmsub_s:{ISA:"RV",assembly:["rd","rs1","rs2","rs3"],pseudocode:"f(rd) = -f(rs1) * f(rs2) - f(rs3);",description:"Floating-Point Negate-Multiply-Subtract Single Precision",type:"R4",arch_width:[32,64],extension:"F",fields:{opcode:{value:75,mask:127},funct2:{value:0,mask:3<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rs3:{mask:31<<27},rd:{mask:3968},rm:{mask:28672}}},fnmadd_s:{ISA:"RV",assembly:["rd","rs1","rs2","rs3"],pseudocode:"f(rd) = -f(rs1) * f(rs2) + f(rs3);",description:"Floating-Point Negate-Multiply-Add Single Precision",type:"R4",arch_width:[32,64],extension:"F",fields:{opcode:{value:79,mask:127},funct2:{value:0,mask:3<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rs3:{mask:31<<27},rd:{mask:3968},rm:{mask:28672}}},fadd_s:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"f(rd) = f(rs1) + f(rs2);",description:"Floating-Point Add Single Precision",type:"R4",arch_width:[32,64],extension:"F",fields:{opcode:{value:83,mask:127},funct7:{value:0,mask:127<<25},rm:{mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},fsub_s:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"f(rd) = f(rs1) - f(rs2);",description:"Floating-Point Subtract Single Precision",type:"R4",arch_width:[32,64],extension:"F",fields:{opcode:{value:83,mask:127},funct7:{value:4,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968},rm:{mask:28672}}},fmul_s:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"f(rd) = f(rs1) * f(rs2);",description:"Floating-Point Multiply Single Precision",type:"R4",arch_width:[32,64],extension:"F",fields:{opcode:{value:83,mask:127},funct7:{value:8,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968},rm:{mask:28672}}},fdiv_s:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"f(rd) = f(rs1) / f(rs2);",description:"Floating-Point Divide Single Precision",type:"R4",arch_width:[32,64],extension:"F",fields:{opcode:{value:83,mask:127},funct7:{value:12,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968},rm:{mask:28672}}},fsqrt_s:{ISA:"RV",assembly:["rd","rs1"],pseudocode:"f(rd) = sqrt(f(rs1));",description:"Floating-Point Square Root Single Precision",type:"R4",arch_width:[32,64],extension:"F",fields:{opcode:{value:83,mask:127},funct7:{value:44,mask:127<<25},rs2:{value:0,mask:31<<20},rs1:{mask:31<<15},rd:{mask:3968},rm:{mask:28672}}},fsgnj_s:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"f(rd) = f(rs1) with sign of f(rs2);",description:"Floating-Point Sign Inject Single Precision",type:"R4",arch_width:[32,64],extension:"F",fields:{opcode:{value:83,mask:127},funct7:{value:16,mask:127<<25},funct3:{value:0,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},fsgnjn_s:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"f(rd) = f(rs1) with sign of -f(rs2);",description:"Floating-Point Sign Inject Negate Single Precision",type:"R4",arch_width:[32,64],extension:"F",fields:{opcode:{value:83,mask:127},funct7:{value:16,mask:127<<25},funct3:{value:1,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},fsgnjx_s:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"f(rd) = f(rs1) with sign of f(rs2), and value of abs(f(rs1));",description:"Floating-Point Sign Inject with Exchange Single Precision",type:"R4",arch_width:[32,64],extension:"F",fields:{opcode:{value:83,mask:127},funct7:{value:16,mask:127<<25},funct3:{value:2,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},fmin_s:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"f(rd) = min(f(rs1), f(rs2));",description:"Floating-Point Minimum Single Precision",type:"R4",arch_width:[32,64],extension:"F",fields:{opcode:{value:83,mask:127},funct7:{value:20,mask:127<<25},funct3:{value:0,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},fmax_s:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"f(rd) = max(f(rs1), f(rs2));",description:"Floating-Point Maximum Single Precision",type:"R4",arch_width:[32,64],extension:"F",fields:{opcode:{value:83,mask:127},funct7:{value:20,mask:127<<25},funct3:{value:1,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},fcvt_w_s:{ISA:"RV",assembly:["rd","rs1"],pseudocode:"rd = (int32_t)f(rs1);",description:"Floating-Point Convert to Signed Word Single Precision",type:"R4",arch_width:[32],extension:"F",fields:{opcode:{value:83,mask:127},funct7:{value:96,mask:127<<25},rs2:{value:0,mask:31<<20},rs1:{mask:31<<15},rd:{mask:3968},rm:{mask:28672}}},fcvt_wu_s:{ISA:"RV",assembly:["rd","rs1"],pseudocode:"rd = (uint32_t)f(rs1);",description:"Floating-Point Convert to Unsigned Word Single Precision",type:"R4",arch_width:[32,64],extension:"F",fields:{opcode:{value:83,mask:127},funct7:{value:96,mask:127<<25},rs2:{value:1,mask:31<<20},rs1:{mask:31<<15},rd:{mask:3968},rm:{mask:28672}}},fmv_x_w:{ISA:"RV",assembly:["rd","rs1"],pseudocode:"rd = rs1;",description:"Floating-Point Move to Integer Register Single Precision",type:"R4",arch_width:[32,64],extension:"F",fields:{opcode:{value:83,mask:127},funct7:{value:112,mask:127<<25},funct3:{value:0,mask:28672},rs2:{value:0,mask:31<<20},rs1:{mask:31<<15},rd:{mask:3968}}},feq_s:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = (f(rs1) == f(rs2)) ? 1 : 0;",description:"Floating-Point Equal Single Precision",type:"R4",arch_width:[32,64],extension:"F",fields:{opcode:{value:83,mask:127},funct7:{value:80,mask:127<<25},funct3:{value:2,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},flt_s:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = (f(rs1) < f(rs2)) ? 1 : 0;",description:"Floating-Point Less Than Single Precision",type:"R4",arch_width:[32,64],extension:"F",fields:{opcode:{value:83,mask:127},funct7:{value:80,mask:127<<25},funct3:{value:1,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},fle_s:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = (f(rs1) <= f(rs2)) ? 1 : 0;",description:"Floating-Point Less Than or Equal Single Precision",type:"R4",arch_width:[32,64],extension:"F",fields:{opcode:{value:83,mask:127},funct7:{value:80,mask:127<<25},funct3:{value:0,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},fclass_s:{ISA:"RV",assembly:["rd","rs1"],pseudocode:"rd = fclass_s(rs1);",description:"Floating-Point Classify Single Precision",type:"R4",arch_width:[32,64],extension:"F",fields:{opcode:{value:83,mask:127},funct7:{value:112,mask:127<<25},funct3:{value:1,mask:28672},rs2:{value:0,mask:31<<20},rs1:{mask:31<<15},rd:{mask:3968}}},fcvt_s_w:{ISA:"RV",assembly:["rd","rs1"],pseudocode:"rd = f32_to_i32(rs1, RM, true);",description:"Floating-Point Convert to Signed Word Single Precision",type:"R4",arch_width:[32],extension:"F",fields:{opcode:{value:83,mask:127},funct7:{value:104,mask:127<<25},rs2:{value:0,mask:31<<20},rs1:{mask:31<<15},rd:{mask:3968},rm:{mask:28672}}},fcvt_s_wu:{ISA:"RV",assembly:["rd","rs1"],pseudocode:"rd = f32_to_ui32(rs1, RM, true);",description:"Floating-Point Convert to Unsigned Word Single Precision",type:"R4",arch_width:[32],extension:"F",fields:{opcode:{value:83,mask:127},funct7:{value:104,mask:127<<25},rs2:{value:1,mask:31<<20},rs1:{mask:31<<15},rd:{mask:3968},rm:{mask:28672}}},fmv_w_x:{ISA:"RV",assembly:["rd","rs1"],pseudocode:"rd = rs1;",description:"Floating-Point Move to Integer Register Single Precision",type:"R4",arch_width:[32],extension:"F",fields:{opcode:{value:83,mask:127},funct7:{value:120,mask:127<<25},funct3:{value:0,mask:28672},rs2:{value:0,mask:31<<20},rs1:{mask:31<<15},rd:{mask:3968}}},fcvt_l_s:{ISA:"RV",assembly:["rd","rs1"],pseudocode:"rd = f64_to_i64(rs1, RM, true);",description:"Floating-Point Convert to Signed Long Double Precision",type:"R4",arch_width:[64],extension:"F",fields:{opcode:{value:83,mask:127},funct7:{value:96,mask:127<<25},rs2:{value:2,mask:31<<20},rs1:{mask:31<<15},rd:{mask:3968},rm:{mask:28672}}},fcvt_lu_s:{ISA:"RV",assembly:["rd","rs1"],pseudocode:"rd = f64_to_ui64(rs1, RM, true);",description:"Floating-Point Convert to Unsigned Long Double Precision",type:"R4",arch_width:[64],extension:"F",fields:{opcode:{value:83,mask:127},funct7:{value:96,mask:127<<25},rs2:{value:3,mask:31<<20},rs1:{mask:31<<15},rd:{mask:3968},rm:{mask:28672}}},fcvt_s_l:{ISA:"RV",assembly:["rd","rs1"],pseudocode:"rd = f64_to_f32(rs1, RM);",description:"Floating-Point Convert to Single Precision from Long Double Precision",type:"R4",arch_width:[64],extension:"F",fields:{opcode:{value:83,mask:127},funct7:{value:104,mask:127<<25},rs2:{value:2,mask:31<<20},rs1:{mask:31<<15},rd:{mask:3968},rm:{mask:28672}}},fcvt_s_lu:{ISA:"RV",assembly:["rd","rs1"],pseudocode:"rd = f64_to_f32(rs1, RM);",description:"Floating-Point Convert to Single Precision from Unsigned Long Double Precision",type:"R4",arch_width:[64],extension:"F",fields:{opcode:{value:83,mask:127},funct7:{value:104,mask:127<<25},rs2:{value:3,mask:31<<20},rs1:{mask:31<<15},rd:{mask:3968},rm:{mask:28672}}},fld:{ISA:"RV",assembly:["rd","rs1","imm"],pseudocode:"rd = Memory[rs1 + imm];",description:"Floating-Point Load Double Precision",type:"I",arch_width:[32,64],extension:"D",fields:{opcode:{value:7,mask:127},funct3:{value:3,mask:28672},rs1:{mask:31<<15},rd:{mask:3968}}},fsd:{ISA:"RV",assembly:["rs1","rs2","imm"],pseudocode:"Memory[rs1 + imm] = rs2;",description:"Floating-Point Store Double Precision",type:"S",arch_width:[32,64],extension:"D",fields:{opcode:{value:39,mask:127},funct3:{value:3,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20}}},fmadd_d:{ISA:"RV",assembly:["rd","rs1","rs2","rs3"],pseudocode:"rd = f64_mulAdd(rs1, rs2, rs3, RM);",description:"Floating-Point Multiply-Add Double Precision",type:"R4",arch_width:[32,64],extension:"D",fields:{opcode:{value:67,mask:127},funct2:{value:1,mask:3<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rs3:{mask:31<<27},rd:{mask:3968},rm:{mask:28672}}},fmsub_d:{ISA:"RV",assembly:["rd","rs1","rs2","rs3"],pseudocode:"rd = f64_mulAdd(rs1, rs2, rs3, RM);",description:"Floating-Point Multiply-Subtract Double Precision",type:"R4",arch_width:[32,64],extension:"D",fields:{opcode:{value:71,mask:127},funct2:{value:1,mask:3<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rs3:{mask:31<<27},rd:{mask:3968},rm:{mask:28672}}},fnmsub_d:{ISA:"RV",assembly:["rd","rs1","rs2","rs3"],pseudocode:"rd = -f64_mulAdd(rs1, rs2, rs3, RM);",description:"Floating-Point Negate-Multiply-Subtract Double Precision",type:"R4",arch_width:[32,64],extension:"D",fields:{opcode:{value:75,mask:127},funct2:{value:1,mask:3<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rs3:{mask:31<<27},rd:{mask:3968},rm:{mask:28672}}},fnmadd_d:{ISA:"RV",assembly:["rd","rs1","rs2","rs3"],pseudocode:"rd = -f64_mulAdd(rs1, rs2, rs3, RM);",description:"Floating-Point Negate-Multiply-Add Double Precision",type:"R4",arch_width:[32,64],extension:"D",fields:{opcode:{value:79,mask:127},funct2:{value:1,mask:3<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rs3:{mask:31<<27},rd:{mask:3968},rm:{mask:28672}}},fadd_d:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = f64_add(rs1, rs2, RM);",description:"Floating-Point Add Double Precision",type:"R",arch_width:[32,64],extension:"D",fields:{opcode:{value:83,mask:127},funct7:{value:1,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968},rm:{mask:28672}}},fsub_d:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = f64_sub(rs1, rs2, RM);",description:"Floating-Point Subtract Double Precision",type:"R",arch_width:[32,64],extension:"D",fields:{opcode:{value:83,mask:127},funct7:{value:5,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968},rm:{mask:28672}}},fmul_d:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = f64_mul(rs1, rs2, RM);",description:"Floating-Point Multiply Double Precision",type:"R",arch_width:[32,64],extension:"D",fields:{opcode:{value:83,mask:127},funct7:{value:9,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968},rm:{mask:28672}}},fdiv_d:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = f64_div(rs1, rs2, RM);",description:"Floating-Point Divide Double Precision",type:"R",arch_width:[32,64],extension:"D",fields:{opcode:{value:83,mask:127},funct7:{value:13,mask:127<<25},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968},rm:{mask:28672}}},fsqrt_d:{ISA:"RV",assembly:["rd","rs1"],pseudocode:"rd = sqrt(f(rs1));",description:"Floating-Point Divide Double Precision",type:"R",arch_width:[32,64],extension:"D",fields:{opcode:{value:83,mask:127},funct7:{value:45,mask:127<<25},rs2:{value:0,mask:31<<20},rs1:{mask:31<<15},rd:{mask:3968},rm:{mask:28672}}},fsgnj_d:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = f64_gnj(rs1, rs2, false);",description:"Floating-Point Sign Injection Double Precision",type:"R",arch_width:[32,64],extension:"D",fields:{opcode:{value:83,mask:127},funct7:{value:17,mask:127<<25},funct3:{value:0,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},fsgnjn_d:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = f64_gnj(rs1, rs2, true);",description:"Floating-Point Sign Injection (Negate) Double Precision",type:"R",arch_width:[32,64],extension:"D",fields:{opcode:{value:83,mask:127},funct7:{value:17,mask:127<<25},funct3:{value:1,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},fsgnjx_d:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = f64_gnjn(rs1, rs2);",description:"Floating-Point Sign Injection (XOR) Double Precision",type:"R",arch_width:[32,64],extension:"D",fields:{opcode:{value:83,mask:127},funct7:{value:17,mask:127<<25},funct3:{value:2,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},fmin_d:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = f64_min(rs1, rs2);",description:"Floating-Point Minimum Double Precision",type:"R",arch_width:[32,64],extension:"D",fields:{opcode:{value:83,mask:127},funct7:{value:21,mask:127<<25},funct3:{value:0,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},fmax_d:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = f64_max(rs1, rs2);",description:"Floating-Point Maximum Double Precision",type:"R",arch_width:[32,64],extension:"D",fields:{opcode:{value:83,mask:127},funct7:{value:21,mask:127<<25},funct3:{value:1,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},fcvt_s_d:{ISA:"RV",assembly:["rd","rs1"],pseudocode:"rd = f32_to_f64(rs1, RM);",description:"Floating-Point Convert to Single Precision from Double Precision",type:"R",arch_width:[32,64],extension:"D",fields:{opcode:{value:83,mask:127},funct7:{value:32,mask:127<<25},rs2:{value:1,mask:31<<20},rs1:{mask:31<<15},rd:{mask:3968},rm:{mask:28672}}},fcvt_d_s:{ISA:"RV",assembly:["rd","rs1"],pseudocode:"rd = f64_to_f32(rs1, RM);",description:"Floating-Point Convert to Double Precision from Single Precision",type:"R",arch_width:[32,64],extension:"D",fields:{opcode:{value:83,mask:127},funct7:{value:33,mask:127<<25},rs2:{value:0,mask:31<<20},rs1:{mask:31<<15},rd:{mask:3968},rm:{mask:28672}}},feq_d:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = f64_eq(rs1, rs2);",description:"Floating-Point Equality Double Precision",type:"R",arch_width:[32,64],extension:"D",fields:{opcode:{value:83,mask:127},funct7:{value:81,mask:127<<25},funct3:{value:2,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},flt_d:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = f64_lt(rs1, rs2);",description:"Floating-Point Less Than Double Precision",type:"R",arch_width:[32,64],extension:"D",fields:{opcode:{value:83,mask:127},funct7:{value:81,mask:127<<25},funct3:{value:1,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},fle_d:{ISA:"RV",assembly:["rd","rs1","rs2"],pseudocode:"rd = f64_le(rs1, rs2);",description:"Floating-Point Less Than or Equal Double Precision",type:"R",arch_width:[32,64],extension:"D",fields:{opcode:{value:83,mask:127},funct7:{value:81,mask:127<<25},funct3:{value:0,mask:28672},rs1:{mask:31<<15},rs2:{mask:31<<20},rd:{mask:3968}}},fclass_d:{ISA:"RV",assembly:["rd","rs1"],pseudocode:"rd = f64_classify(rs1);",description:"Floating-Point Classify Double Precision",type:"R",arch_width:[32,64],extension:"D",fields:{opcode:{value:83,mask:127},funct7:{value:113,mask:127<<25},rs2:{value:0,mask:31<<20},funct3:{value:1,mask:28672},rs1:{mask:31<<15},rd:{mask:3968}}},fcvt_w_d:{ISA:"RV",assembly:["rd","rs1"],pseudocode:"rd = f64_to_i32(rs1, RM, true);",description:"Floating-Point Convert to Signed Word Double Precision",type:"R",arch_width:[32,64],extension:"D",fields:{opcode:{value:83,mask:127},funct7:{value:97,mask:127<<25},rs2:{value:0,mask:31<<20},rs1:{mask:31<<15},rd:{mask:3968},rm:{mask:28672}}},fcvt_wu_d:{ISA:"RV",assembly:["rd","rs1"],pseudocode:"rd = f64_to_ui32(rs1, RM, true);",description:"Floating-Point Convert to Unsigned Word Double Precision",type:"R",arch_width:[32,64],extension:"D",fields:{opcode:{value:83,mask:127},funct7:{value:97,mask:127<<25},rs2:{value:1,mask:31<<20},rs1:{mask:31<<15},rd:{mask:3968},rm:{mask:28672}}},fcvt_d_w:{ISA:"RV",assembly:["rd","rs1"],pseudocode:"rd = i32_to_f64(rs1, RM);",description:"Floating-Point Convert to Double Precision from Signed Word",type:"R",arch_width:[32,64],extension:"D",fields:{opcode:{value:83,mask:127},funct7:{value:105,mask:127<<25},rs2:{value:0,mask:31<<20},rs1:{mask:31<<15},rd:{mask:3968},rm:{mask:28672}}},fcvt_d_wu:{ISA:"RV",assembly:["rd","rs1"],pseudocode:"rd = ui32_to_f64(rs1, RM);",description:"Floating-Point Convert to Double Precision from Unsigned Word",type:"R",arch_width:[32,64],extension:"D",fields:{opcode:{value:83,mask:127},funct7:{value:105,mask:127<<25},rs2:{value:1,mask:31<<20},rs1:{mask:31<<15},rd:{mask:3968},rm:{mask:28672}}},fcvt_l_d:{ISA:"RV",assembly:["rd","rs1"],pseudocode:"rd = f64_to_i64(rs1, RM, true);",description:"Floating-Point Convert to Signed Long Double Precision",type:"R",arch_width:[64],extension:"D",fields:{opcode:{value:83,mask:127},funct7:{value:97,mask:127<<25},rs2:{value:2,mask:31<<20},rs1:{mask:31<<15},rd:{mask:3968},rm:{mask:28672}}},fcvt_lu_d:{ISA:"RV",assembly:["rd","rs1"],pseudocode:"rd = f64_to_ui64(rs1, RM, true);",description:"Floating-Point Convert to Unsigned Long Double Precision",type:"R",arch_width:[64],extension:"D",fields:{opcode:{value:83,mask:127},funct7:{value:97,mask:127<<25},rs2:{value:3,mask:31<<20},rs1:{mask:31<<15},rd:{mask:3968},rm:{mask:28672}}},fmv_x_d:{ISA:"RV",assembly:["rd","rs1"],pseudocode:"rd = rs1;",description:"Floating-Point Move Double Precision",type:"R",arch_width:[64],extension:"D",fields:{opcode:{value:83,mask:127},funct7:{value:113,mask:127<<25},funct3:{value:0,mask:28672},rs2:{value:0,mask:31<<20},rs1:{mask:31<<15},rd:{mask:3968}}},fcvt_d_l:{ISA:"RV",assembly:["rd","rs1"],pseudocode:"rd = i64_to_f64(rs1, RM);",description:"Floating-Point Convert to Double Precision from Signed Long",type:"R",arch_width:[64],extension:"D",fields:{opcode:{value:83,mask:127},funct7:{value:105,mask:127<<25},rs2:{value:2,mask:31<<20},rs1:{mask:31<<15},rd:{mask:3968},rm:{mask:28672}}},fcvt_d_lu:{ISA:"RV",assembly:["rd","rs1"],pseudocode:"rd = ui64_to_f64(rs1, RM);",description:"Floating-Point Convert to Double Precision from Unsigned Long",type:"R",arch_width:[64],extension:"D",fields:{opcode:{value:83,mask:127},funct7:{value:105,mask:127<<25},rs2:{value:3,mask:31<<20},rs1:{mask:31<<15},rd:{mask:3968},rm:{mask:28672}}},fmv_d_x:{ISA:"RV",assembly:["rd","rs1"],pseudocode:"rd = rs1;",description:"Floating-Point Move Double Precision",type:"R",arch_width:[64],extension:"D",fields:{opcode:{value:83,mask:127},funct7:{value:121,mask:127<<25},funct3:{value:0,mask:28672},rs2:{value:0,mask:31<<20},rs1:{mask:31<<15},rd:{mask:3968}}},illegal_instruction:{ISA:"RV",assembly:["imm"],pseudocode:"Raise an illegal instruction exception;",description:"Illegal Instruction",type:"CI",arch_width:[32,64],extension:"C",fields:{quadrant:{value:0,mask:3},funct3:{value:0,mask:!0},imm_value:{value:0,mask:8160},rd:{value:0,mask:28}}},c_addi4spn:{ISA:"RV",assembly:["rd","nzuimm"],pseudocode:"addi rd' = sp + nzuimm = sp + 4*imm",description:"Compressed Add imm*4 to SP",type:"CIW",arch_width:["RES"],extension:"C",fields:{quadrant:{value:0,mask:3},funct3:{value:0,mask:!0},nzuimm:{mask:8160},rd:{mask:28}}},c_fld:{ISA:"RV",assembly:["rd","rs1","uimm"],pseudocode:"rd = M64[rs1 + uimm];",description:"Compressed Load Double Floating-Point",type:"CI",arch_width:[32,64],extension:"C",fields:{quadrant:{value:0,mask:3},funct3:{value:1,mask:57344},uimm1:{mask:7168},uimm2:{mask:96},rs1:{mask:896},rd:{mask:28}}},c_lq:{ISA:"RV",assembly:["rd","rs1","uimm"],pseudocode:"rd = M128[rs1 + uimm];",description:"Compressed Load Quadruple Floating-Point",type:"CIW",arch_width:[128],extension:"C",fields:{quadrant:{value:0,mask:3},funct3:{value:1,mask:57344},uimm1:{mask:6144},m1:{mask:1024},uimm2:{mask:96},rs1:{mask:896},rd:{mask:28}}},c_lw:{ISA:"RV",assembly:["rd","rs1","uimm"],pseudocode:"rd' <- M[ rs1' + offset ];",description:"Compressed Load Word",type:"CL",arch_width:[32,64],extension:"C",fields:{quadrant:{value:0,mask:3},funct3:{value:2,mask:57344},uimm:{mask:7168},m2:{mask:64},m1:{mask:32},rs1:{mask:896},rd:{mask:28}}},c_flw:{ISA:"RV",assembly:["rd","rs1","uimm"],pseudocode:"rd = M32[rs1 + uimm];",description:"Compressed Load Float",type:"CIW",arch_width:[32],extension:"C",fields:{quadrant:{value:0,mask:3},funct3:{value:3,mask:57344},uimm:{mask:7168},m2:{mask:64},m1:{mask:32},rs1:{mask:896},rd:{mask:28}}},c_ld:{ISA:"RV",assembly:["rd","rs1","uimm"],pseudocode:"rd = M64[rs1 + uimm];",description:"Compressed Load Double",type:"CI",arch_width:[64,128],extension:"C",fields:{quadrant:{value:0,mask:3},funct3:{value:3,mask:57344},uimm1:{mask:7168},uimm2:{mask:96},rs1:{mask:896},rd:{mask:28}}},c_fsd:{ISA:"RV",assembly:["rs1","rs2","uimm"],pseudocode:"M64[rs1 + uimm] = rs2;",description:"Compressed Store Double Floating-Point",type:"CI",arch_width:[32,64],extension:"C",fields:{quadrant:{value:0,mask:3},funct3:{value:5,mask:57344},uimm1:{mask:7168},uimm2:{mask:96},rs1:{mask:896},rs2:{mask:28}}},c_sq:{ISA:"RV",assembly:["rs1","rs2","uimm"],pseudocode:"M128[rs1 + uimm] = rs2;",description:"Compressed Store Quadruple Floating-Point",type:"CI",arch_width:[128],extension:"C",fields:{quadrant:{value:0,mask:3},funct3:{value:5,mask:57344},uimm1:{mask:6144},m1:{mask:1024},uimm2:{mask:96},rs1:{mask:896},rs2:{mask:28}}},c_sw:{ISA:"RV",assembly:["rs1","rs2","uimm"],pseudocode:"M32[rs1 + uimm] = rs2;",description:"Compressed Store Word",type:"CS",arch_width:[32,64],extension:"C",fields:{quadrant:{value:0,mask:3},funct3:{value:6,mask:57344},uimm:{mask:7168},m2:{mask:64},m1:{mask:32},rs1:{mask:896},rs2:{mask:28}}},c_fsw:{ISA:"RV",assembly:["rs1","rs2","uimm"],pseudocode:"M32[rs1 + uimm] = rs2;",description:"Compressed Store Float",type:"CIW",arch_width:[32],extension:"C",fields:{quadrant:{value:0,mask:3},funct3:{value:7,mask:57344},uimm:{mask:7168},m2:{mask:64},m1:{mask:32},rs1:{mask:896},rs2:{mask:28}}},c_sd:{ISA:"RV",assembly:["rs1","rs2","uimm"],pseudocode:"M64[rs1 + uimm] = rs2;",description:"Compressed Store Double",type:"CI",arch_width:[64,128],extension:"C",fields:{quadrant:{value:0,mask:3},funct3:{value:7,mask:57344},uimm1:{mask:7168},uimm2:{mask:96},rs1:{mask:896},rs2:{mask:28}}},c_nop:{ISA:"RV",assembly:[],pseudocode:"",description:"Compressed No OPeration",type:"CI",arch_width:[32,64],extension:"C",fields:{quadrant:{value:1,mask:3},funct3:{value:0,mask:57344},op_val:{value:0}}},c_addi:{ISA:"RV",assembly:["rd","nzimm"],pseudocode:"rd = rd + sext(nzimm);",description:"Compressed Add Immediate",type:"CI",arch_width:[32,64],extension:"C",fields:{quadrant:{value:1,mask:3},funct3:{value:0,mask:57344},m1:{mask:4096},imm1:{mask:124},rd:{mask:3968}}},c_jal:{ISA:"RV",assembly:["imm","rd"],pseudocode:"rd = PC + sext(imm);",description:"Compressed Jump and Link",type:"CJ",arch_width:[32,64],extension:"C",fields:{quadrant:{value:1,mask:3},funct3:{value:1,mask:57344},m1:{mask:4096},m2:{mask:2048},imm2:{mask:1536},m3:{mask:256},m4:{mask:128},m5:{mask:64},imm1:{mask:56},m6:{mask:4}}},c_addiw:{ISA:"RV",assembly:["rd","nzimm"],pseudocode:"rd = rd + sext(nzimm);",description:"Compressed Add Immediate Word",type:"CW",arch_width:[64,128],extension:"C",fields:{quadrant:{value:1,mask:3},funct3:{value:1,mask:57344},m1:{mask:4096},imm1:{mask:124},rd:{mask:3968}}},c_li:{ISA:"RV",assembly:["rd","imm"],pseudocode:"rd = sext(imm);",description:"Compressed Load Immediate",type:"CI",arch_width:[32,64],extension:"C",fields:{quadrant:{value:1,mask:3},funct3:{value:2,mask:57344},m1:{mask:4096},imm1:{mask:124},rd:{mask:3968}}},c_addi16sp:{ISA:"RV",assembly:["nzuimm"],pseudocode:"sp = sp + sext(nzuimm);",description:"Compressed Add Immediate to SP",type:"CI",arch_width:[32,64],extension:"C",fields:{quadrant:{value:1,mask:3},funct3:{value:3,mask:57344},nzuimm5:{mask:4096},nzuimm2:{mask:24},nzuimm1:{mask:4},nzuimm3:{mask:32},nzuimm4:{mask:64},rd:{value:2,mask:3968}}},c_lui:{ISA:"RV",assembly:["rd","nzimm"],pseudocode:"rd = imm << 12 (zero extends);",description:"Compressed Load Upper Immediate",type:"CI",arch_width:[32,64],extension:"C",fields:{quadrant:{value:1,mask:3},funct3:{value:3,mask:57344},imm1:{mask:124},m1:{mask:4096},rd:{mask:3968}}},c_srli:{ISA:"RV",assembly:["rd","nzuimm","rs1"],pseudocode:"rd = rd (zero)>> shamt;",description:"Compressed Shift Right Logical Immediate",type:"CB",arch_width:[32,64],extension:"C",fields:{quadrant:{value:1,mask:3},funct6:{value:32,mask:64512},nzuimm:{mask:124},rd:{mask:896}}},c_srai:{ISA:"RV",assembly:["rd","nzuimm","rs1"],pseudocode:"rd = rd (msb)>> nzuimm;",description:"Compressed Shift Right Arithmetic Immediate",type:"CB",arch_width:[32,64],extension:"C",fields:{quadrant:{value:1,mask:3},funct6:{value:33,mask:64512},nzuimm:{mask:124},rd:{mask:896}}},c_andi:{ISA:"RV",assembly:["rd","imm"],pseudocode:"rd &= imm;",description:"Compressed AND Immediate",type:"CB",arch_width:[32,64],extension:"C",fields:{quadrant:{value:1,mask:3},funct3:{value:4,mask:57344},funct2:{value:2,mask:3072},m1:{mask:4096},imm1:{mask:124},rd:{mask:896}}},c_sub:{ISA:"RV",assembly:["rd","rs2"],pseudocode:"rd' -= rs';",description:"Compressed Subtract",type:"CA",arch_width:[32,64],extension:"C",fields:{quadrant:{value:1,mask:3},funct6:{value:35,mask:64512},funct2:{value:0,mask:96},rs2:{mask:28},rd:{mask:896}}},c_xor:{ISA:"RV",assembly:["rd","rs2"],pseudocode:"rd' ^= rs';",description:"Compressed XOR",type:"CA",arch_width:[32,64],extension:"C",fields:{quadrant:{value:1,mask:3},funct6:{value:35,mask:64512},funct2:{value:1,mask:96},rs2:{mask:28},rd:{mask:896}}},c_or:{ISA:"RV",assembly:["rd","rs2"],pseudocode:"rd' |= rs';",description:"Compressed OR",type:"CA",arch_width:[32,64],extension:"C",fields:{quadrant:{value:1,mask:3},funct6:{value:35,mask:64512},funct2:{value:2,mask:96},rs2:{mask:28},rd:{mask:896}}},c_and:{ISA:"RV",assembly:["rd","rs2","rs1"],pseudocode:"rd = rd & rs;",description:"Compressed AND",type:"CA",arch_width:[32,64],extension:"C",fields:{quadrant:{value:1,mask:3},funct6:{value:35,mask:64512},funct2:{value:3,mask:96},rs2:{mask:28},rd:{mask:896}}},c_subw:{ISA:"RV",assembly:["rd","rs2"],pseudocode:"rd = rd - rs2;",description:"Compressed Subtract Word",type:"CA",arch_width:[64,128,"RES"],extension:"C",fields:{quadrant:{value:1,mask:3},funct6:{value:39,mask:64512},funct2:{value:0,mask:96},rs2:{mask:28},rd:{mask:896}}},c_addw:{ISA:"RV",assembly:["rd","rs2"],pseudocode:"rd = rd + rs2;",description:"Compressed Add Word",type:"CA",arch_width:[64,128,"RES"],extension:"C",fields:{quadrant:{value:1,mask:3},funct6:{value:39,mask:64512},funct2:{value:1,mask:96},rs2:{mask:28},rd:{mask:896}}},c_reserved1:{ISA:"RV",assembly:[],pseudocode:"",description:"Reserved",type:"CR",arch_width:[32,64],extension:"C",fields:{quadrant:{value:1,mask:3},funct6:{value:39,mask:64512},funct2:{value:2,mask:96}}},c_reserved2:{ISA:"RV",assembly:[],pseudocode:"",description:"Reserved",type:"CR",arch_width:[32,64],extension:"C",fields:{quadrant:{value:1,mask:3},funct6:{value:39,mask:64512},funct2:{value:3,mask:96}}},c_j:{ISA:"RV",assembly:["imm"],pseudocode:"PC += sext(imm);",description:"Compressed Jump",type:"CJ",arch_width:[32,64],extension:"C",fields:{quadrant:{value:1,mask:3},funct3:{value:5,mask:57344},m1:{mask:4096},m2:{mask:2048},imm2:{mask:1536},m3:{mask:256},m4:{mask:128},m5:{mask:64},imm1:{mask:56},m6:{mask:4}}},c_beqz:{ISA:"RV",assembly:["rs1","imm"],pseudocode:"if (rs1 == 0) PC += sext(imm);",description:"Compressed Branch if Equal to Zero",type:"CB",arch_width:[32,64],extension:"C",fields:{quadrant:{value:1,mask:3},funct3:{value:6,mask:57344},imm1:{mask:24},imm2:{mask:96},imm3:{mask:3072},m1:{mask:4096},m2:{mask:4},rs1:{mask:896}}},c_bnez:{ISA:"RV",assembly:["rs1","imm"],pseudocode:"if (rs1 != 0) PC += sext(imm);",description:"Compressed Branch if Not Equal to Zero",type:"CB",arch_width:[32,64],extension:"C",fields:{quadrant:{value:1,mask:3},funct3:{value:7,mask:57344},imm1:{mask:24},imm2:{mask:96},imm3:{mask:3072},m1:{mask:4096},m2:{mask:4},rs1:{mask:896}}},c_slli:{ISA:"RV",assembly:["rd","nzuimm"],pseudocode:"rd = rs1 << nzuimm;",description:"Compressed Shift Left Logical Immediate",type:"CI",arch_width:[32,64],extension:"C",fields:{quadrant:{value:2,mask:3},funct3:{value:0,mask:57344},nzuimm:{mask:124},m1:{mask:4096},rs1:{mask:3968}}},c_fldsp:{ISA:"RV",assembly:["rd","uimm"],pseudocode:"rd = M[sp + uimm];",description:"Compressed Load Doubleword from SP",type:"CL",arch_width:[32,64],extension:"C",fields:{quadrant:{value:2,mask:3},funct3:{value:1,mask:57344},m1:{mask:4096},uimm2:{mask:28},uimm1:{mask:96},rd:{mask:3968}}},c_lqsp:{ISA:"RV",assembly:["rd","uimm"],pseudocode:"rd = M[sp + uimm];",description:"Compressed Load Quadrupleword from SP",type:"CL",arch_width:[128,"RES"],extension:"C",fields:{quadrant:{value:2,mask:3},funct3:{value:1,mask:57344},uimm1:{mask:60},m1:{mask:4096},m2:{mask:64},rd:{mask:3968}}},c_lwsp:{ISA:"RV",assembly:["rd","uimm"],pseudocode:"rd = M[sp + uimm];",description:"Compressed Load Word from SP",type:"CL",arch_width:["RES"],extension:"C",fields:{quadrant:{value:2,mask:3},funct3:{value:2,mask:57344},m1:{mask:4096},uimm2:{mask:28},uimm1:{mask:96},rd:{mask:3968}}},c_flwsp:{ISA:"RV",assembly:["rd","uimm"],pseudocode:"rd = M[sp + uimm];",description:"Compressed Load Float from SP",type:"CL",arch_width:[32],extension:"C",fields:{quadrant:{value:2,mask:3},funct3:{value:3,mask:57344},m1:{mask:4096},uimm2:{mask:28},uimm1:{mask:96},rd:{mask:3968}}},c_ldsp:{ISA:"RV",assembly:["rd","uimm"],pseudocode:"rd = M[sp + uimm];",description:"Compressed Load Double from SP",type:"CL",arch_width:[64,128],extension:"C",fields:{quadrant:{value:2,mask:3},funct3:{value:3,mask:57344},m1:{mask:4096},uimm2:{mask:28},uimm1:{mask:96},rd:{mask:3968}}},c_jr:{ISA:"RV",assembly:["rd","rs1"],pseudocode:"PC = rs1;",description:"Compressed Jump Register",type:"CR",arch_width:[32,64],extension:"C",fields:{quadrant:{value:2,mask:3},funct4:{value:8,mask:61440},rs2:{value:0,mask:124},rs1:{mask:3968}}},c_mv:{ISA:"RV",assembly:["rd","rs2"],pseudocode:"rd = rs2;",description:"Compressed Move",type:"CR",arch_width:[32,64],extension:"C",fields:{quadrant:{value:2,mask:3},funct4:{value:8,mask:61440},rs2:{mask:124},rd:{mask:3968}}},c_ebreak:{ISA:"RV",assembly:[],pseudocode:"Breakpoint",description:"Compressed EBREAK",type:"CR",arch_width:[32,64],extension:"C",fields:{quadrant:{value:2,mask:3},funct4:{value:9,mask:61440},rs2:{value:0,mask:124},rd:{value:0,mask:3968}}},c_jalr:{ISA:"RV",assembly:["rs1"],pseudocode:"rd = PC + 2; PC = rs;",description:"Compressed Jump and Link Register",type:"CR",arch_width:[32,64],extension:"C",fields:{quadrant:{value:2,mask:3},funct4:{value:9,mask:61440},rs2:{value:0,mask:124},rs1:{mask:3968}}},c_add:{ISA:"RV",assembly:["rd","rs2"],pseudocode:"rd += rs;",description:"Compressed Add",type:"CR",arch_width:[32,64],extension:"C",fields:{quadrant:{value:2,mask:3},funct4:{value:9,mask:61440},rs2:{mask:124},rd:{mask:3968}}},c_fsdsp:{ISA:"RV",assembly:["rs2","uimm"],pseudocode:"M[sp + uimm] = rs2;",description:"Compressed Store Double from SP",type:"CS",arch_width:[32,64],extension:"C",fields:{quadrant:{value:2,mask:3},funct3:{value:5,mask:57344},uimm1:{mask:7168},uimm2:{mask:896},rs2:{mask:124}}},c_sqsp:{ISA:"RV",assembly:["rs2","uimm"],pseudocode:"M[sp + uimm] = rs2;",description:"Compressed Store Quadruple from SP",type:"CS",arch_width:[128],extension:"C",fields:{quadrant:{value:2,mask:3},funct3:{value:5,mask:57344},uimm1:{mask:6144},uimm2:{mask:1920},rs2:{mask:124}}},c_swsp:{ISA:"RV",assembly:["rs2","uimm"],pseudocode:"M[sp + uimm] = rs2;",description:"Compressed Store Word from SP",type:"CSS",arch_width:[32,64],extension:"C",fields:{quadrant:{value:2,mask:3},funct3:{value:6,mask:57344},uimm2:{mask:7680},uimm1:{mask:384},rs2:{mask:124}}},c_fswsp:{ISA:"RV",assembly:["rs2","uimm"],pseudocode:"M[sp + uimm] = rs2;",description:"Compressed Store Float from SP",type:"CSS",arch_width:[32],extension:"C",fields:{quadrant:{value:2,mask:3},funct3:{value:7,mask:57344},uimm2:{mask:7680},uimm1:{mask:384},rs2:{mask:124}}},c_sdsp:{ISA:"RV",assembly:["rs2","uimm"],pseudocode:"M[sp + uimm] = rs2;",description:"Compressed Store Double from SP",type:"CSS",arch_width:[64,128],extension:"C",fields:{quadrant:{value:2,mask:3},funct3:{value:7,mask:57344},uimm1:{mask:7168},uimm2:{mask:896},rs2:{mask:124}}}};function _extractRegisterNumber({register:n="x0"}){return parseInt(n.slice(1))}function _assembleInstruction({mnemonic:n="mnemonic",operands:a={}}){const f=instructions[n].assembly.map(k=>a[k]).join(" ");return`${n} ${f}`}function _parseAssemblyInstruction({assemblyString:n="mnemonic op1 op2 op3"}){const[a,...c]=n.split(" "),f=instructions[a].assembly,k=instructions[a].type;var R={};return k=="I"||k=="R"?f.forEach((q,d)=>{R[q]=c[d]}):k=="S"&&(R={rs1:c[0],rs2:c[1].split("(")[1].replace(/[()]/g,""),imm:c[1].split("(")[0]}),{mnemonic:a,operands:R,instructionType:k}}function _binaryHexString({value:n=0}){const a=`0b${(n>>>0).toString(2).padStart(32,"0")}`,c=`0x${(n>>>0).toString(16).padStart(8,"0").toUpperCase()}`;return{binary:a,hex:c}}function _extractValues({binaryvalue:n=0,binaryMask:a=0}){let c=0,f=0;for(let k=0;k<32;k++)if((a>>k&1)===1){const q=n>>k&1;c|=q<<f,f++}return c}function _matchesConstraints({instruction:n={},constraints:a=[]}){const c=_getInstructionBinary({instruction:n});for(let f=0;f<c.length;f++){const k=a[f];if(k!=="-"&&c[f]!=="n"&&k!==c[f])return!1}return!0}function _getInstructionBinary({instruction:n={}}){const a=n.fields,c=new Array(32).fill("n");for(const f in a)if(a[f].hasOwnProperty("value")){const k=_calculateShift({mask:a[f].mask}),R=a[f].value.toString(2).padStart(maskWidth({mask:a[f].mask}),"0");for(let q=0;q<R.length;q++)c[31-(k+q)]=R[R.length-1-q]}else{const k=_calculateShift({mask:a[f].mask}),R=maskWidth({mask:a[f].mask});for(let q=0;q<R;q++)c[31-(k+q)]="n"}return c}function _calculateShift({mask:n=0}){return 31-n.toString(2).padStart(32,"0").lastIndexOf("1")}function _encodeImmediate({instructionType:n="I",operands:a={}}){const c=immediates[n];let f=0;if(n==="I"){const q=a.imm;for(const[d,o]of Object.entries(c)){let h=0,_=_binaryHexString({value:d}).binary,V=_binaryHexString({value:o}).binary;if(_.toString(2).replace(/0/g,"").length===V.toString(2).replace(/0/g,"").length)h=q&V,f|=h<<_calculateShift({mask:_})+2;else{var k=_calculateShift({mask:V})+2,R=_binaryHexString({value:q}).binary>>k&1;f|=R<<_calculateShift({mask:_})+2}}return f}else if(n==="S"){const q=a.imm;for(const[d,o]of Object.entries(c)){let h=0,_=_binaryHexString({value:d}).binary,V=_binaryHexString({value:o}).binary;if(_.toString(2).replace(/0/g,"").length===V.toString(2).replace(/0/g,"").length)h=q&V,f|=h<<_calculateShift({mask:_})+2;else{var k=_calculateShift({mask:V})+2,R=_binaryHexString({value:q}).binary>>k&1;f|=R<<_calculateShift({mask:_})+2}}return f}else if(n==="B"||n==="U"||n==="J")for(const q in c){const d=c[q];if(a.imm===d){f|=(q&c[q].value_mask)>>_calculateShift({mask:q});break}}return f}function encodeInstruction({assemblyString:n="mnemonic op1 op2 op3"}){const{mnemonic:a,operands:c,instructionType:f}=_parseAssemblyInstruction({assemblyString:n}),R=instructions[a].fields;let q=0;for(const d in R)R[d].hasOwnProperty("value")?q|=R[d].value<<_calculateShift({mask:R[d].mask}):["rd","rs1","rs2","rs3"].includes(d)&&(q|=_extractRegisterNumber({register:c[d]})<<_calculateShift({mask:R[d].mask}));if(["I","S","B","U","J"].includes(f)){let d=0;d=_encodeImmediate({instructionType:f,operands:c}),q|=d}return _binaryHexString({value:q})}function decodeInstruction({value:n=0}){let a=null,c=null;for(const f in instructions){const k=instructions[f];let R=!0;for(const q in k.fields){const d=k.fields[q],o=_extractValues({binaryvalue:n,binaryMask:d.mask});if(d.hasOwnProperty("value")){const h=d.value;if(o!==h){R=!1;break}}else{const _=`x${_extractValues({binaryvalue:n,binaryMask:d.mask})}`;c=c||{},c[q]=_}}if(R){a=f;break}}return _assembleInstruction({mnemonic:a,operands:c})}function pruneInstructions({constraints:n={}}){const a={};for(const c in instructions){const f=instructions[c];_matchesConstraints({instruction:f,constraints:n})&&(a[c]=f)}return a}function maskWidth({mask:n=0}){return n=n>>>0,n.toString(2).split("").filter(c=>c==="1").length}function tableEncoder({prunedInstructions:n}){var a={},c=[];return a=Object.values(n),a=a.map(f=>{var k=Object.keys(f.fields||{}),R=k.join(", ");return{...f,fields:R}}),c=[{title:"ISA",width:25},{title:"Mnemonic",width:100},{title:"Pseudocode",width:350},{title:"Description",width:350},{title:"Type",width:50},{title:"Architecture",width:120},{title:"Extension",width:50},{title:"Fields",width:300}],{tabulatedData:a,generatedColumns:c}}function getDefaultExportFromCjs(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function commonjsRequire(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var dist={exports:{}},jsuites$1={exports:{}},jsuites=jsuites$1.exports,hasRequiredJsuites;function requireJsuites(){return hasRequiredJsuites||(hasRequiredJsuites=1,function(n,a){(function(f,k){n.exports=k()})(jsuites,function(){return function(){var c={195:function(q){(function(d,o){q.exports=o()})(this,function(){return function(Ee){function o(Ie,Me){this.highOrder=Ie,this.lowOrder=Me}var h=[new o(1779033703,4089235720),new o(3144134277,2227873595),new o(1013904242,4271175723),new o(2773480762,1595750129),new o(1359893119,2917565137),new o(2600822924,725511199),new o(528734635,4215389547),new o(1541459225,327033209)],_=[new o(1116352408,3609767458),new o(1899447441,602891725),new o(3049323471,3964484399),new o(3921009573,2173295548),new o(961987163,4081628472),new o(1508970993,3053834265),new o(2453635748,2937671579),new o(2870763221,3664609560),new o(3624381080,2734883394),new o(310598401,1164996542),new o(607225278,1323610764),new o(1426881987,3590304994),new o(1925078388,4068182383),new o(2162078206,991336113),new o(2614888103,633803317),new o(3248222580,3479774868),new o(3835390401,2666613458),new o(4022224774,944711139),new o(264347078,2341262773),new o(604807628,2007800933),new o(770255983,1495990901),new o(1249150122,1856431235),new o(1555081692,3175218132),new o(1996064986,2198950837),new o(2554220882,3999719339),new o(2821834349,766784016),new o(2952996808,2566594879),new o(3210313671,3203337956),new o(3336571891,1034457026),new o(3584528711,2466948901),new o(113926993,3758326383),new o(338241895,168717936),new o(666307205,1188179964),new o(773529912,1546045734),new o(1294757372,1522805485),new o(1396182291,2643833823),new o(1695183700,2343527390),new o(1986661051,1014477480),new o(2177026350,1206759142),new o(2456956037,344077627),new o(2730485921,1290863460),new o(2820302411,3158454273),new o(3259730800,3505952657),new o(3345764771,106217008),new o(3516065817,3606008344),new o(3600352804,1432725776),new o(4094571909,1467031594),new o(275423344,851169720),new o(430227734,3100823752),new o(506948616,1363258195),new o(659060556,3750685593),new o(883997877,3785050280),new o(958139571,3318307427),new o(1322822218,3812723403),new o(1537002063,2003034995),new o(1747873779,3602036899),new o(1955562222,1575990012),new o(2024104815,1125592928),new o(2227730452,2716904306),new o(2361852424,442776044),new o(2428436474,593698344),new o(2756734187,3733110249),new o(3204031479,2999351573),new o(3329325298,3815920427),new o(3391569614,3928383900),new o(3515267271,566280711),new o(3940187606,3454069534),new o(4118630271,4000239992),new o(116418474,1914138554),new o(174292421,2731055270),new o(289380356,3203993006),new o(460393269,320620315),new o(685471733,587496836),new o(852142971,1086792851),new o(1017036298,365543100),new o(1126000580,2618297676),new o(1288033470,3409855158),new o(1501505948,4234509866),new o(1607167915,987167468),new o(1816402316,1246189591)],V=new Array(64),b,u,g,v,m,C,S,L,H,N,M,T,G=8;function Y(Ie){return unescape(encodeURIComponent(Ie))}function ae(Ie){for(var Me=[],Te=(1<<G)-1,ze=Ie.length*G,Ge=0;Ge<ze;Ge+=G)Me[Ge>>5]|=(Ie.charCodeAt(Ge/G)&Te)<<32-G-Ge%32;return Me}function be(Ie){for(var Me="0123456789abcdef",Te="",ze=Ie.length*4,Ge,Qe=0;Qe<ze;Qe+=1)Ge=Ie[Qe>>2]>>(3-Qe%4)*8,Te+=Me.charAt(Ge>>4&15)+Me.charAt(Ge&15);return Te}function se(Ie,Me){var Te,ze,Ge,Qe;return Te=(Ie.lowOrder&65535)+(Me.lowOrder&65535),ze=(Ie.lowOrder>>>16)+(Me.lowOrder>>>16)+(Te>>>16),Ge=(ze&65535)<<16|Te&65535,Te=(Ie.highOrder&65535)+(Me.highOrder&65535)+(ze>>>16),ze=(Ie.highOrder>>>16)+(Me.highOrder>>>16)+(Te>>>16),Qe=(ze&65535)<<16|Te&65535,new o(Qe,Ge)}function xe(Ie,Me,Te,ze){var Ge,Qe,ct,it;return Ge=(Ie.lowOrder&65535)+(Me.lowOrder&65535)+(Te.lowOrder&65535)+(ze.lowOrder&65535),Qe=(Ie.lowOrder>>>16)+(Me.lowOrder>>>16)+(Te.lowOrder>>>16)+(ze.lowOrder>>>16)+(Ge>>>16),ct=(Qe&65535)<<16|Ge&65535,Ge=(Ie.highOrder&65535)+(Me.highOrder&65535)+(Te.highOrder&65535)+(ze.highOrder&65535)+(Qe>>>16),Qe=(Ie.highOrder>>>16)+(Me.highOrder>>>16)+(Te.highOrder>>>16)+(ze.highOrder>>>16)+(Ge>>>16),it=(Qe&65535)<<16|Ge&65535,new o(it,ct)}function Se(Ie,Me,Te,ze,Ge){var Qe,ct,it,dt;return Qe=(Ie.lowOrder&65535)+(Me.lowOrder&65535)+(Te.lowOrder&65535)+(ze.lowOrder&65535)+(Ge.lowOrder&65535),ct=(Ie.lowOrder>>>16)+(Me.lowOrder>>>16)+(Te.lowOrder>>>16)+(ze.lowOrder>>>16)+(Ge.lowOrder>>>16)+(Qe>>>16),it=(ct&65535)<<16|Qe&65535,Qe=(Ie.highOrder&65535)+(Me.highOrder&65535)+(Te.highOrder&65535)+(ze.highOrder&65535)+(Ge.highOrder&65535)+(ct>>>16),ct=(Ie.highOrder>>>16)+(Me.highOrder>>>16)+(Te.highOrder>>>16)+(ze.highOrder>>>16)+(Ge.highOrder>>>16)+(Qe>>>16),dt=(ct&65535)<<16|Qe&65535,new o(dt,it)}function je(Ie,Me,Te){return new o(Ie.highOrder&Me.highOrder^Ie.highOrder&Te.highOrder^Me.highOrder&Te.highOrder,Ie.lowOrder&Me.lowOrder^Ie.lowOrder&Te.lowOrder^Me.lowOrder&Te.lowOrder)}function ie(Ie,Me,Te){return new o(Ie.highOrder&Me.highOrder^~Ie.highOrder&Te.highOrder,Ie.lowOrder&Me.lowOrder^~Ie.lowOrder&Te.lowOrder)}function Fe(Ie,Me){return Me<=32?new o(Ie.highOrder>>>Me|Ie.lowOrder<<32-Me,Ie.lowOrder>>>Me|Ie.highOrder<<32-Me):new o(Ie.lowOrder>>>Me|Ie.highOrder<<32-Me,Ie.highOrder>>>Me|Ie.lowOrder<<32-Me)}function $e(Ie){var Me=Fe(Ie,28),Te=Fe(Ie,34),ze=Fe(Ie,39);return new o(Me.highOrder^Te.highOrder^ze.highOrder,Me.lowOrder^Te.lowOrder^ze.lowOrder)}function Ue(Ie){var Me=Fe(Ie,14),Te=Fe(Ie,18),ze=Fe(Ie,41);return new o(Me.highOrder^Te.highOrder^ze.highOrder,Me.lowOrder^Te.lowOrder^ze.lowOrder)}function He(Ie){var Me=Fe(Ie,1),Te=Fe(Ie,8),ze=U(Ie,7);return new o(Me.highOrder^Te.highOrder^ze.highOrder,Me.lowOrder^Te.lowOrder^ze.lowOrder)}function lt(Ie){var Me=Fe(Ie,19),Te=Fe(Ie,61),ze=U(Ie,6);return new o(Me.highOrder^Te.highOrder^ze.highOrder,Me.lowOrder^Te.lowOrder^ze.lowOrder)}function U(Ie,Me){return Me<=32?new o(Ie.highOrder>>>Me,Ie.lowOrder>>>Me|Ie.highOrder<<32-Me):new o(0,Ie.highOrder<<32-Me)}var Ee=Y(Ee),Ye=Ee.length*G;Ee=ae(Ee),Ee[Ye>>5]|=128<<24-Ye%32,Ee[(Ye+128>>10<<5)+31]=Ye;for(var H=0;H<Ee.length;H+=32){b=h[0],u=h[1],g=h[2],v=h[3],m=h[4],C=h[5],S=h[6],L=h[7];for(var N=0;N<80;N++)N<16?V[N]=new o(Ee[N*2+H],Ee[N*2+H+1]):V[N]=xe(lt(V[N-2]),V[N-7],He(V[N-15]),V[N-16]),M=Se(L,Ue(m),ie(m,C,S),_[N],V[N]),T=se($e(b),je(b,u,g)),L=S,S=C,C=m,m=se(v,M),v=g,g=u,u=b,b=se(M,T);h[0]=se(b,h[0]),h[1]=se(u,h[1]),h[2]=se(g,h[2]),h[3]=se(v,h[3]),h[4]=se(m,h[4]),h[5]=se(C,h[5]),h[6]=se(S,h[6]),h[7]=se(L,h[7])}for(var ht=[],H=0;H<h.length;H++)ht.push(h[H].highOrder),ht.push(h[H].lowOrder);return be(ht)}})}},f={};function k(q){var d=f[q];if(d!==void 0)return d.exports;var o=f[q]={exports:{}};return c[q].call(o.exports,o,o.exports,k),o.exports}(function(){k.n=function(q){var d=q&&q.__esModule?function(){return q.default}:function(){return q};return k.d(d,{a:d}),d}})(),function(){k.d=function(q,d){for(var o in d)k.o(d,o)&&!k.o(q,o)&&Object.defineProperty(q,o,{enumerable:!0,get:d[o]})}}(),function(){k.o=function(q,d){return Object.prototype.hasOwnProperty.call(q,d)}}();var R={};return function(){k.d(R,{default:function(){return St}});var q={};q.two=function(j){return j=""+j,j.length==1&&(j="0"+j),j},q.focus=function(j){if(j.innerText.length){var A=document.createRange(),l=window.getSelection(),r=j.childNodes[j.childNodes.length-1];A.setStart(r,r.length),A.collapse(!0),l.removeAllRanges(),l.addRange(A),j.scrollLeft=j.scrollWidth}},q.isNumeric=function(j){return typeof j=="string"&&(j=j.trim()),!isNaN(j)&&j!==null&&j!==""},q.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(j){var A=Math.random()*16|0,l=j=="x"?A:A&3|8;return l.toString(16)})},q.getNode=function(){var j=document.getSelection().anchorNode;return j?j.nodeType==3?j.parentNode:j:null},q.hash=function(j){var A=0,l,r;if(j.length===0)return A;for(l=0;l<j.length;l++)r=j.charCodeAt(l),r>32&&(A=(A<<5)-A+r,A|=0);return A},q.randomColor=function(j){var A=-.25,l=("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");l.length<6&&(l=l[0]+l[0]+l[1]+l[1]+l[2]+l[2]);var r=[],F,Q;for(Q=0;Q<3;Q++)F=parseInt(l.substr(Q*2,2),16),F=Math.round(Math.min(Math.max(0,F+F*A),255)).toString(16),r.push(("00"+F).substr(F.length));return j==!0?"#"+q.two(r[0].toString(16))+q.two(r[1].toString(16))+q.two(r[2].toString(16)):r},q.getWindowWidth=function(){var j=window,A=document,l=A.documentElement,r=A.getElementsByTagName("body")[0],F=j.innerWidth||l.clientWidth||r.clientWidth;return F},q.getWindowHeight=function(){var j=window,A=document,l=A.documentElement,r=A.getElementsByTagName("body")[0],F=j.innerHeight||l.clientHeight||r.clientHeight;return F},q.getPosition=function(j){if(j.changedTouches&&j.changedTouches[0])var A=j.changedTouches[0].pageX,l=j.changedTouches[0].pageY;else var A=window.Event?j.pageX:j.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),l=window.Event?j.pageY:j.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[A,l]},q.click=function(j){if(j.click)j.click();else{var A=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});j.dispatchEvent(A)}},q.findElement=function(j,A){var l=!1;function r(F){F&&!l&&(typeof A=="function"?l=A(F):typeof A=="string"&&F.classList&&F.classList.contains(A)&&(l=F)),F.parentNode&&!l&&r(F.parentNode)}return r(j),l};var d=q;function o(){var j={};j.now=function(F,Q){var ee=null,D=null,I=null,B=null,K=null,ne=null;return Array.isArray(F)?(ee=F[0],D=F[1],I=F[2],B=F[3],K=F[4],ne=F[5]):(F||(F=new Date),ee=F.getFullYear(),D=F.getMonth()+1,I=F.getDate(),B=F.getHours(),K=F.getMinutes(),ne=F.getSeconds()),Q==!0?d.two(ee)+"-"+d.two(D)+"-"+d.two(I):d.two(ee)+"-"+d.two(D)+"-"+d.two(I)+" "+d.two(B)+":"+d.two(K)+":"+d.two(ne)},j.toArray=function(F){var ee=F.split(F.indexOf("T")!==-1?"T":" "),Q=ee[1],ee=ee[0].split("-"),D=parseInt(ee[0]),I=parseInt(ee[1]),B=parseInt(ee[2]),K=0,ne=0;return Q&&(Q=Q.split(":"),K=parseInt(Q[0]),ne=parseInt(Q[1])),[D,I,B,K,ne,0]};var A=Date.UTC(1900,0,0),l=Date.UTC(1900,1,29),r=864e5;return j.dateToNum=function(F){typeof F=="string"&&(F=new Date(F+"  GMT+0"));var Q=F.getTime();return Q>=l&&(Q+=r),Q-=A,Q/r},j.numToDate=function(F){var Q=A+F*r;Q>=l&&(Q-=r);const ee=new Date(Q);var D=[ee.getUTCFullYear(),ee.getUTCMonth()+1,ee.getUTCDate(),ee.getUTCHours(),ee.getUTCMinutes(),ee.getUTCSeconds()];return j.now(D)},j.weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],j.months=["January","February","March","April","May","June","July","August","September","October","November","December"],j.weekdaysShort=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],j.monthsShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],j}var h=o(),_=function(j){document.dictionary||(document.dictionary={});var A=null,l=null,r=Object.keys(j);for(l=0;l<r.length;l++)document.dictionary[r[l]]=j[r[l]];for(l=0;l<h.weekdays.length;l++)A=V(h.weekdays[l]),h.weekdays[l]&&(h.weekdays[l]=A,h.weekdaysShort[l]=A.substr(0,3));for(l=0;l<h.months.length;l++)A=V(h.months[l]),A&&(h.months[l]=A,h.monthsShort[l]=A.substr(0,3))},V=function(j){return typeof document<"u"&&document.dictionary&&document.dictionary[j]||j},b={setDictionary:_,translate:V};function u(j,A){if(A==!0)document.jsuitesComponents=document.jsuitesComponents.filter(function(r){return r!==null}),setTimeout(function(){document.jsuitesComponents.push(j)},0);else{var l=document.jsuitesComponents.indexOf(j);l>=0&&document.jsuitesComponents.splice(l,1)}}function g(j,A,l){if(j=j.split("."),j.length){let r=this,F=null;for(;j.length>1;)if(F=j.shift(),r.hasOwnProperty(F))r=r[F];else{if(typeof A>"u")return;r[F]={},r=r[F]}if(F=j.shift(),typeof A<"u")return l===!0?delete r[F]:r[F]=A,!0;if(r)return r[F]}return!1}function v(j,A){var l={};l.options={};var r={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},F=null;for(var Q in r)A&&A.hasOwnProperty(Q)?l.options[Q]=A[Q]:l.options[Q]=r[Q];j.classList.add("jsorting"),j.addEventListener("dragstart",function(I){var B=Array.prototype.indexOf.call(I.target.parentNode.children,I.target);F={element:I.target,o:B,d:B},I.target.style.opacity="0.25",typeof l.options.ondragstart=="function"&&l.options.ondragstart(j,I.target,I)}),j.addEventListener("dragover",function(I){if(I.preventDefault(),ee(I.target)&&F&&I.target.getAttribute("draggable")=="true"&&F.element!=I.target){if(l.options.direction)var B=I.target.clientWidth/2>I.offsetX;else var B=I.target.clientHeight/2>I.offsetY;B?I.target.parentNode.insertBefore(F.element,I.target):I.target.parentNode.insertBefore(F.element,I.target.nextSibling),F.d=Array.prototype.indexOf.call(I.target.parentNode.children,F.element)}}),j.addEventListener("dragleave",function(I){I.preventDefault()}),j.addEventListener("dragend",function(I){I.preventDefault(),F&&(typeof l.options.ondragend=="function"&&l.options.ondragend(j,F.element,I),F.o<F.d?I.target.parentNode.insertBefore(F.element,I.target.parentNode.children[F.o]):I.target.parentNode.insertBefore(F.element,I.target.parentNode.children[F.o].nextSibling),F.element.style.opacity="",F=null)}),j.addEventListener("drop",function(I){I.preventDefault(),F&&F.o!=F.d&&typeof l.options.ondrop=="function"&&l.options.ondrop(j,F.o,F.d,F.element,I.target,I),F.element.style.opacity="",F=null});for(var ee=function(I){var B=!1;function K(ne){ne.className&&ne.classList.contains("jsorting")&&(B=!0),B||K(ne.parentNode)}return K(I),B},D=0;D<j.children.length;D++)j.children[D].hasAttribute("draggable")||j.children[D].setAttribute("draggable","true");return j.val=function(){for(var I=null,B=[],K=0;K<j.children.length;K++)(I=j.children[K].getAttribute("data-id"))&&B.push(I);return B},j}function m(j,A){var l={};(!A.loadUp||typeof A.loadUp!="function")&&(A.loadUp=function(){return!1}),(!A.loadDown||typeof A.loadDown!="function")&&(A.loadDown=function(){return!1}),A.timer||(A.timer=100);var r=null,F=function(Q){if(r==null){var ee=!1,D=j.scrollTop;j.scrollTop+j.clientHeight*2>=j.scrollHeight?A.loadDown()&&(D==j.scrollTop&&(j.scrollTop=j.scrollTop-j.clientHeight),ee=!0):j.scrollTop<=j.clientHeight&&A.loadUp()&&(D==j.scrollTop&&(j.scrollTop=j.scrollTop+j.clientHeight),ee=!0),r=setTimeout(function(){r=null},A.timer),ee&&typeof A.onupdate=="function"&&A.onupdate()}};return j.onscroll=function(Q){F()},j.onwheel=function(Q){F()},l}function C(){var j=function(A,l){if(Array.isArray(A)){var r={instance:[],complete:l};if(A.length>0)for(var F=0;F<A.length;F++)A[F].multiple=r,r.instance.push(j(A[F]));return r}if(A.data||(A.data={}),A.type&&(A.method=A.type),A.method||(A.method="GET"),A.dataType||(A.dataType="json"),A.data){var Q=function(ne,ge){var de=[];if(ne){var fe=Object.keys(ne);if(fe.length)for(var le=0;le<fe.length;le++){if(ge)var he=ge+"["+fe[le]+"]";else var he=fe[le];if(ne[he]instanceof FileList)de[he]=ne[fe[le]];else if(ne[fe[le]]===null||ne[fe[le]]===void 0)de[he]="";else if(typeof ne[fe[le]]=="object")for(var Le=Q(ne[fe[le]],he),We=Object.keys(Le),Je=0;Je<We.length;Je++)de[We[Je]]=Le[We[Je]];else de[he]=ne[fe[le]]}}return de},ee=Q(A.data),D=Object.keys(ee);if(A.method=="GET"){if(D.length){for(var I=[],F=0;F<D.length;F++)I.push(D[F]+"="+encodeURIComponent(ee[D[F]]));A.url.indexOf("?")<0&&(A.url+="?"),A.url+=I.join("&")}}else for(var I=new FormData,F=0;F<D.length;F++)if(ee[D[F]]instanceof FileList){if(ee[D[F]].length)for(var B=0;B<ee[D[F]].length;B++)I.append(D[F],ee[D[F]][B],ee[D[F]][B].name)}else I.append(D[F],ee[D[F]])}var K=new XMLHttpRequest;return K.open(A.method,A.url,!0),K.setRequestHeader("X-Requested-With","XMLHttpRequest"),A.contentType&&K.setRequestHeader("Content-Type",A.contentType),A.method==="POST"?K.setRequestHeader("Accept","application/json"):A.dataType==="blob"?K.responseType="blob":A.contentType||(A.dataType==="json"?K.setRequestHeader("Content-Type","text/json"):A.dataType==="html"&&K.setRequestHeader("Content-Type","text/html")),A.cache!==!0&&(K.setRequestHeader("pragma","no-cache"),K.setRequestHeader("cache-control","no-cache")),A.withCredentials===!0&&(K.withCredentials=!0),typeof A.beforeSend=="function"&&A.beforeSend(K),typeof j.beforeSend=="function"&&j.beforeSend(K),document.ajax&&typeof document.ajax.beforeSend=="function"&&document.ajax.beforeSend(K),K.onload=function(){if(K.status>=200&&K.status<300)if(A.dataType==="json")try{var ne=JSON.parse(K.responseText);A.success&&typeof A.success=="function"&&A.success(ne)}catch(de){A.error&&typeof A.error=="function"&&A.error(de,ne)}else{if(A.dataType==="blob")var ne=K.response;else var ne=K.responseText;A.success&&typeof A.success=="function"&&A.success(ne)}else A.error&&typeof A.error=="function"&&A.error(K.responseText,K.status);if(j.queue&&j.queue.length>0&&j.send(j.queue.shift()),j.requests&&j.requests.length){var ge=j.requests.indexOf(K);if(j.requests.splice(ge,1),j.requests.length||A.complete&&typeof A.complete=="function"&&A.complete(ne),A.group&&j.oncomplete&&typeof j.oncomplete[A.group]=="function"&&(j.pending(A.group)||(j.oncomplete[A.group](),j.oncomplete[A.group]=null)),A.multiple&&A.multiple.instance){var ge=A.multiple.instance.indexOf(K);A.multiple.instance.splice(ge,1),A.multiple.instance.length||A.multiple.complete&&typeof A.multiple.complete=="function"&&A.multiple.complete(ne)}}},K.options=A,K.data=I,A.queue===!0&&j.requests.length>0?j.queue.push(K):j.send(K),K};return j.send=function(A){A.data?Array.isArray(A.data)?A.send(A.data.join("&")):A.send(A.data):A.send(),j.requests.push(A)},j.exists=function(A,l){var r=new XMLHttpRequest;r.open("HEAD",A,!1),r.send(),r.status&&l(r.status)},j.pending=function(A){var l=0,r=j.requests;if(r&&r.length)for(var F=0;F<r.length;F++)(!A||A==r[F].options.group)&&l++;return l},j.oncomplete={},j.requests=[],j.queue=[],j}var S=C();function L(){const j={loading:{}};return j.loading.show=function(A){j.loading.element||(j.loading.element=document.createElement("div"),j.loading.element.className="jloading"),document.body.appendChild(j.loading.element),A>0&&setTimeout(function(){j.loading.hide()},A*1e3)},j.loading.hide=function(){j.loading.element&&j.loading.element.parentNode&&document.body.removeChild(j.loading.element)},j.slideLeft=function(A,l,r){l==!0?(A.classList.add("slide-left-in"),setTimeout(function(){A.classList.remove("slide-left-in"),typeof r=="function"&&r()},400)):(A.classList.add("slide-left-out"),setTimeout(function(){A.classList.remove("slide-left-out"),typeof r=="function"&&r()},400))},j.slideRight=function(A,l,r){l===!0?(A.classList.add("slide-right-in"),setTimeout(function(){A.classList.remove("slide-right-in"),typeof r=="function"&&r()},400)):(A.classList.add("slide-right-out"),setTimeout(function(){A.classList.remove("slide-right-out"),typeof r=="function"&&r()},400))},j.slideTop=function(A,l,r){l===!0?(A.classList.add("slide-top-in"),setTimeout(function(){A.classList.remove("slide-top-in"),typeof r=="function"&&r()},400)):(A.classList.add("slide-top-out"),setTimeout(function(){A.classList.remove("slide-top-out"),typeof r=="function"&&r()},400))},j.slideBottom=function(A,l,r){l===!0?(A.classList.add("slide-bottom-in"),setTimeout(function(){A.classList.remove("slide-bottom-in"),typeof r=="function"&&r()},400)):(A.classList.add("slide-bottom-out"),setTimeout(function(){A.classList.remove("slide-bottom-out"),typeof r=="function"&&r()},100))},j.fadeIn=function(A,l){A.style.display="",A.classList.add("fade-in"),setTimeout(function(){A.classList.remove("fade-in"),typeof l=="function"&&l()},2e3)},j.fadeOut=function(A,l){A.classList.add("fade-out"),setTimeout(function(){A.style.display="none",A.classList.remove("fade-out"),typeof l=="function"&&l()},1e3)},j}var H=L();function N(){var j={text:["@"],currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","MONTH","MON","HH24","HH12","HH","\\[H\\]","H","AM/PM","MI","SS","MS","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},A=function(){if(this.mask.toLowerCase().indexOf("[h]")!==-1){var w=0;this.date[4]&&(w=parseFloat(this.date[4]/60));var P=parseInt(this.date[3])+w;P/=24}else!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])?P=d.two(this.date[3])+":"+d.two(this.date[4])+":"+d.two(this.date[5]):(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),P=d.two(this.date[0])+"-"+d.two(this.date[1])+"-"+d.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(P+=" "+d.two(this.date[3])+":"+d.two(this.date[4])+":"+d.two(this.date[5])));return P},l=function(){var w="";if(!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])){if(this.mask.toLowerCase().indexOf("[h]")!==-1)w=parseInt(this.date[3]);else{let J=parseInt(this.date[3]);J<13&&this.values.indexOf("PM")!==-1?w=(J+12)%24:w=J%24}this.date[4]&&(w+=parseFloat(this.date[4]/60)),this.date[5]&&(w+=parseFloat(this.date[5]/3600)),w/=24}else if(this.date[0]||this.date[1]||this.date[2]||this.date[3]||this.date[4]||this.date[5]){this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1);var P=h.now(this.date);w=h.dateToNum(P),this.date[4]&&(w+=parseFloat(this.date[4]/60))}return isNaN(w)&&(w=""),w},r=function(w){return w===null||w===""||w===void 0},F=function(w){var P=(""+w)[0];return P=="="},Q=function(w){return w==="currency"||w==="percentage"||w==="numeric"},ee=function(w){if(w&&Number(w)==w)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var P=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=P[1]}else{w||(w=this.mask);var J=new RegExp("0{1}(.{1})0+","ig"),P=J.exec(w);if(P&&P[1]&&P[1].length==1)return this.options.decimal=P[1],P[1];var J=new RegExp("#{1}(.{1})#+","ig"),P=J.exec(w);P&&P[1]&&P[1].length==1?P[1]===","?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2)}return this.options.decimal?this.options.decimal:null},D=function(w,P){if(w=="")return"";P||(P=ee.call(this)),w=(""+w).split(P);var J=w[0].match(/[-]+/g);if(J&&J.length?J=!0:J=!1,w[0]=w[0].match(/[0-9]+/g),w[0]?(J&&w[0].unshift("-"),w[0]=w[0].join("")):J&&(w[0]="-"),w[0]||w[1])w[1]!==void 0&&(w[1]=w[1].match(/[0-9]+/g),w[1]?w[1]=w[1].join(""):w[1]="");else return"";return w},I=function(w,P){if(w==="")return"";var J=ee.call(this),me=this.options;if(w=D.call(this,w),w==="")return"";var Z=null;if(w[0]&&(me.style==="percent"?Z=parseFloat(w[0])/100:Z=parseFloat(w[0]+".1")),(w[0]==="-"||w[0]==="-00")&&!w[1]&&P&&P.inputType=="deleteContentBackward")return"";var ue=new Intl.NumberFormat(this.locale,me).format(Z);if(ue=ue.split(J),me.style==="percent"&&ue[0].indexOf("%")!==-1&&(ue[0]=ue[0].replace("%",""),ue[2]="%"),typeof ue[1]<"u"){var ye=ue[1].replace(/[0-9]*/g,"");ye&&(ue[2]=ye)}return w[1]!==void 0?ue[1]=J+w[1]:ue[1]="",ue.join("")},B=function(w,P){var J=ge.call(w);if(J){var me=I.call(this,J,P),Z=me.length-J.length,ue=ne.call(w)+Z;ge.call(w,me,ue,!0)}},K=function(w){var P=D.call(this,w);return P?(P[0]==="-"&&(P[0]="-0"),parseFloat(P.join("."))):null},ne=function(w,P){if(w===void 0)if(this.tagName=="DIV"){var J=0,me=window.getSelection();if(me&&me.rangeCount!==0){var Z=me.getRangeAt(0),ue=Z.cloneRange();ue.selectNodeContents(this),ue.setEnd(Z.endContainer,Z.endOffset),J=ue.toString().length}return J}else return this.selectionStart;else{var ye=ge.call(this);if(P){for(var ue=null,Re=0;Re<ye.length;Re++)(ye[Re].match(/[\-0-9]/g)||ye[Re]==="."||ye[Re]===",")&&(ue=Re);ue===null&&(ue=ye.indexOf(" ")),w>=ue&&(w=ue+1)}if(w>ye.length&&(w=ye.length),w)if(this.tagName=="DIV"){var me=window.getSelection(),Z=document.createRange();this.childNodes[0]&&(Z.setStart(this.childNodes[0],w),me.removeAllRanges(),me.addRange(Z))}else this.selectionStart=w,this.selectionEnd=w}},ge=function(w,P,J){if(this.tagName=="DIV")if(w===void 0){var w=this.innerText;return this.value&&this.value.length>w.length&&(w=this.value),w}else this.innerText!==w&&(this.innerText=w,P&&ne.call(this,P,J));else{if(w===void 0)return this.value;this.value!==w&&(this.value=w,P&&ne.call(this,P,J))}},de=h.weekdays,fe=h.weekdaysShort,le=h.months,he=h.monthsShort,Le={YEAR:function(w,P){var J=""+new Date().getFullYear();if(typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(w)>=0&&parseInt(w)<=10&&this.values[this.index].length<P&&(this.values[this.index]+=w),this.values[this.index].length==P){if(P==2)var J=J.substr(0,2)+this.values[this.index];else if(P==3)var J=J.substr(0,1)+this.values[this.index];else if(P==4)var J=this.values[this.index];this.date[0]=J,this.index++}},YYYY:function(w){Le.YEAR.call(this,w,4)},YYY:function(w){Le.YEAR.call(this,w,3)},YY:function(w){Le.YEAR.call(this,w,2)},FIND:function(w,P){if(r(this.values[this.index])&&(this.values[this.index]=""),this.event&&this.event.inputType&&this.event.inputType.indexOf("delete")>-1){this.values[this.index]+=w;return}for(var J=0,me=0,Z=(this.values[this.index]+w).toLowerCase(),ue=0;ue<P.length;ue++)P[ue].toLowerCase().indexOf(Z)==0&&(J=ue,me++);if(me>1)this.values[this.index]+=w;else if(me==1){var ye=P[J].length-this.values[this.index].length-1;return this.position+=ye,this.values[this.index]=P[J],this.index++,J}},MMM:function(w){var P=Le.FIND.call(this,w,he);P!==void 0&&(this.date[1]=P+1)},MON:function(w){Le.MMM.call(this,w)},MMMM:function(w){var P=Le.FIND.call(this,w,le);P!==void 0&&(this.date[1]=P+1)},MONTH:function(w){Le.MMMM.call(this,w)},MMMMM:function(w){r(this.values[this.index])&&(this.values[this.index]="");for(var P=(this.values[this.index]+w).toLowerCase(),J=0;J<le.length;J++)if(le[J][0].toLowerCase().indexOf(P)==0){this.values[this.index]=le[J][0],this.date[1]=J+1,this.index++;break}},MM:function(w){r(this.values[this.index])?parseInt(w)>1&&parseInt(w)<10?(this.date[1]=this.values[this.index]="0"+w,this.index++):parseInt(w)<2&&(this.values[this.index]=w):this.values[this.index]==1&&parseInt(w)<3?(this.date[1]=this.values[this.index]+=w,this.index++):this.values[this.index]==0&&parseInt(w)>0&&parseInt(w)<10&&(this.date[1]=this.values[this.index]+=w,this.index++)},M:function(w){var P=!1;if(parseInt(w)>=0&&parseInt(w)<10)if(r(this.values[this.index]))this.values[this.index]=w,w>1&&(this.date[1]=this.values[this.index],this.index++);else if(this.values[this.index]==1&&parseInt(w)<3)this.date[1]=this.values[this.index]+=w,this.index++;else if(this.values[this.index]==0&&parseInt(w)>0)this.date[1]=this.values[this.index]+=w,this.index++;else var P=!0;else var P=!0;if(P==!0){var J=parseInt(this.values[this.index]);J>0&&J<12&&(this.date[1]=this.values[this.index],this.index++,this.position--)}},D:function(w){var P=!1;if(parseInt(w)>=0&&parseInt(w)<10)if(r(this.values[this.index]))this.values[this.index]=w,parseInt(w)>3&&(this.date[2]=this.values[this.index],this.index++);else if(this.values[this.index]==3&&parseInt(w)<2)this.date[2]=this.values[this.index]+=w,this.index++;else if(this.values[this.index]==1||this.values[this.index]==2)this.date[2]=this.values[this.index]+=w,this.index++;else if(this.values[this.index]==0&&parseInt(w)>0)this.date[2]=this.values[this.index]+=w,this.index++;else var P=!0;else var P=!0;if(P==!0){var J=parseInt(this.values[this.index]);J>0&&J<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(w){r(this.values[this.index])?parseInt(w)>3&&parseInt(w)<10?(this.date[2]=this.values[this.index]="0"+w,this.index++):parseInt(w)<10&&(this.values[this.index]=w):this.values[this.index]==3&&parseInt(w)<2?(this.date[2]=this.values[this.index]+=w,this.index++):(this.values[this.index]==1||this.values[this.index]==2)&&parseInt(w)<10?(this.date[2]=this.values[this.index]+=w,this.index++):this.values[this.index]==0&&parseInt(w)>0&&parseInt(w)<10&&(this.date[2]=this.values[this.index]+=w,this.index++)},DDD:function(w){Le.FIND.call(this,w,fe)},DY:function(w){Le.DDD.call(this,w)},DDDD:function(w){Le.FIND.call(this,w,de)},DAY:function(w){Le.DDDD.call(this,w)},HH12:function(w,P){r(this.values[this.index])?parseInt(w)>1&&parseInt(w)<10?(P&&(w=0+w),this.date[3]=this.values[this.index]=w,this.index++):parseInt(w)<10&&(this.values[this.index]=w):this.values[this.index]==1&&parseInt(w)<3?(this.date[3]=this.values[this.index]+=w,this.index++):this.values[this.index]<1&&parseInt(w)<10&&(this.date[3]=this.values[this.index]+=w,this.index++)},HH24:function(w,P){parseInt(w)>=0&&parseInt(w)<10&&(this.values[this.index]==null||this.values[this.index]==""?parseInt(w)>2&&parseInt(w)<10?(P&&(w=0+w),this.date[3]=this.values[this.index]=w,this.index++):parseInt(w)<10&&(this.values[this.index]=w):this.values[this.index]==2&&parseInt(w)<4?(!P&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=w,this.index++):this.values[this.index]<2&&parseInt(w)<10&&(!P&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=w,this.index++))},HH:function(w){Le.HH24.call(this,w,1)},H:function(w){Le.HH24.call(this,w,0)},"\\[H\\]":function(w){this.values[this.index]==null&&(this.values[this.index]=""),w.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=w:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(w,P){this.values[this.index]==null||this.values[this.index]==""?parseInt(w)>5&&parseInt(w)<10?(this.date[P]=this.values[this.index]="0"+w,this.index++):parseInt(w)<10&&(this.values[this.index]=w):parseInt(w)<10&&(this.date[P]=this.values[this.index]+=w,this.index++)},MI:function(w){Le.N60.call(this,w,4)},SS:function(w){Le.N60.call(this,w,5)},"AM/PM":function(w){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),this.values[this.index]===""?w.match(/a/i)&&this.date[3]<13?this.values[this.index]+="A":w.match(/p/i)&&(this.values[this.index]+="P"):(this.values[this.index]==="A"||this.values[this.index]==="P")&&(this.values[this.index]+="M",this.index++)},WD:function(w){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(w)>=0&&parseInt(w)<7&&(this.values[this.index]=w),this.values[this.index].length==1&&this.index++},"0{1}(.{1}0+)?":function(w){var P=ee.call(this),J=!1;r(this.values[this.index])?this.values[this.index]="":this.values[this.index]=="-"&&(J=!0);var me=D.call(this,this.values[this.index],P);me&&(this.values[this.index]=me.join(P)),parseInt(w)>=0&&parseInt(w)<10?(this.values[this.index]=="0"&&w>0?this.values[this.index]="":this.values[this.index]=="-0"&&w>0&&(this.values[this.index]="-"),(this.values[this.index]!="0"&&this.values[this.index]!="-0"||w==P)&&(this.values[this.index]+=w)):P&&w==P?this.values[this.index].indexOf(P)==-1&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=w):w=="-"&&(J=!0),J===!0&&this.values[this.index][0]!=="-"&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?%":function(w){Le["0{1}(.{1}0+)?"].call(this,w),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&this.values[this.index].indexOf("%")==-1&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(w){Le["0{1}(.{1}0+)?"].call(this,w);var P=ee.call(this),J=this.tokens[this.index].substr(1,1),me=this.values[this.index][0]==="-",Z=D.call(this,this.values[this.index],P);if(Z!==""){var ue=Z[0].match(/[0-9]/g);if(ue){ue=ue.join("");for(var ye=[],Re=0,we=ue.length-1;we>=0;we--)ye.push(ue[we]),Re++,Re%3||ye.push(J);ye=ye.reverse(),Z[0]=ye.join(""),Z[0].substr(0,1)==J&&(Z[0]=Z[0].substr(1))}else Z[0]="";this.values[this.index]=Z.join(P),me&&(this.values[this.index]="-"+this.values[this.index])}},0:function(w){w.match(/[0-9]/g)&&(this.values[this.index]=w,this.index++)},"[0-9a-zA-Z$]+":function(w){r(this.values[this.index])&&(this.values[this.index]="");var P=this.tokens[this.index],J=this.values[this.index],me=J.length;P[me]==w?(this.values[this.index]+=w,this.values[this.index]==P&&this.index++):(this.values[this.index]=P,this.index++,w.match(/[\-0-9]/g)&&this.position--)},A:function(w){w.match(/[a-zA-Z]/gi)&&(this.values[this.index]=w,this.index++)},".":function(w){Le["[0-9a-zA-Z$]+"].call(this,w)},"@":function(w){r(this.values[this.index])&&(this.values[this.index]=""),this.values[this.index]+=w}},We=function(w){if(this.type=="general")var P=[].concat(j.general);else var P=[].concat(j.currency,j.datetime,j.percentage,j.numeric,j.text,j.general);var J=new RegExp(P.join("|"),"gi");return w.match(J)},Je=function(w){if(this.type)if(this.type=="text")var P=["text"];else if(this.type=="general")var P=["general"];else if(this.type=="datetime")var P=["numeric","datetime","general"];else var P=["currency","percentage","numeric","general"];else var P=Object.keys(j);for(var J=0;J<P.length;J++)for(var me=P[J],Z=0;Z<j[me].length;Z++){var ue=new RegExp(j[me][Z],"gi"),ye=w.match(ue);if(ye)return{type:me,method:j[me][Z]}}},ce=function(w){for(var P=[],J=0;J<w.length;J++){var me=Je.call(this,w[J]);me?P.push(me.method):P.push(null)}for(var J=0;J<P.length;J++)P[J]=="MM"&&(P[J-1]&&P[J-1].indexOf("H")>=0||P[J-2]&&P[J-2].indexOf("H")>=0||P[J+1]&&P[J+1].indexOf("S")>=0||P[J+2]&&P[J+2].indexOf("S")>=0)&&(P[J]="MI");return P},Ae=function(w){var P=Je.call(this,w);if(P)var J=P.type;if(J){for(var me=0,Z=We.call(this,w),ue=0;ue<Z.length;ue++)P=Je.call(this,Z[ue]),P&&Q(P.type)&&me++;me>1&&(J="general")}return J},X=function(){typeof Le[this.methods[this.index]]=="function"?(Le[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},W=function(w){return(""+ +w).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(P,J,me,Z,ue){return ue<0?J+"0."+Array(1-ue-me.length).join(0)+me+Z:J+me+Z+Array(ue-Z.length+1).join(0)})},oe=function(w,P,J){var me=null,Z={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if(typeof w=="object"){if(Z.input=w.target,Z.value=ge.call(w.target),Z.caret=ne.call(w.target),(me=w.target.getAttribute("data-mask"))&&(Z.mask=me),(me=w.target.getAttribute("data-type"))&&(Z.type=me),w.target.mask?(w.target.mask.options&&(Z.options=w.target.mask.options),w.target.mask.locale&&(Z.locale=w.target.mask.locale)):(me=w.target.getAttribute("data-locale"))&&(Z.locale=me,Z.mask&&(Z.options.style=Z.mask)),w.target.attributes&&w.target.attributes.length)for(var ue=0;ue<w.target.attributes.length;ue++){var ye=w.target.attributes[ue].name,Re=w.target.attributes[ue].value;ye.substr(0,4)=="data"&&(Z.options[ye.substr(5)]=Re)}}else{if(typeof P=="string")Z.mask=P;else for(var ye=Object.keys(P),ue=0;ue<ye.length;ue++)Z[ye[ue]]=P[ye[ue]];typeof w=="number"&&(ee.call(Z,Z.mask),w=(""+w).replace(".",Z.options.decimal)),Z.value=w,Z.input&&(ge.call(Z.input,w),d.focus(Z.input),Z.caret=ne.call(Z.input))}if(!F(Z.value)&&(Z.mask||Z.locale)){if(Z.mask){if(Z.mask=Z.mask.replace(new RegExp(/\[h]/),"|h|"),Z.mask=Z.mask.replace(new RegExp(/\[.*?\]/),""),Z.mask=Z.mask.replace(new RegExp(/\|h\|/),"[h]"),Z.mask.indexOf(";")!==-1){var me=Z.mask.split(";");Z.mask=me[0]}if(Z.mask.indexOf("##")!==-1){var we=Z.mask.split(";");we[0]&&(typeof w=="object"&&(we[0]=we[0].replace(new RegExp(/_\)/g),""),we[0]=we[0].replace(new RegExp(/_\(/g),"")),we[0]=we[0].replace("*","	"),we[0]=we[0].replace(new RegExp(/_-/g),""),we[0]=we[0].replace(new RegExp(/_/g),""),we[0]=we[0].replace("##0.###","##0.000"),we[0]=we[0].replace("##0.##","##0.00"),we[0]=we[0].replace("##0.#","##0.0"),we[0]=we[0].replace("##0,###","##0,000"),we[0]=we[0].replace("##0,##","##0,00"),we[0]=we[0].replace("##0,#","##0,0")),Z.mask=we[0]}if(Z.mask.indexOf("\\")!==-1){var we=Z.mask.split(";");we[0]=we[0].replace(new RegExp(/\\/g),""),Z.mask=we[0]}Z.type||(Z.type=Ae.call(Z,Z.mask)),Z.tokens=We.call(Z,Z.mask)}if(typeof w!="object"||!w.inputType||!w.inputType.indexOf("insert")||!w.inputType.indexOf("delete"))if(Z.locale)if(Z.input)B.call(Z,Z.input,w);else var Ne=I.call(Z,Z.value);else{for(Z.methods=ce.call(Z,Z.tokens),Z.event=w;Z.position<Z.value.length&&typeof Z.tokens[Z.index]<"u";)X.call(Z);var Ne=Z.values.join("");if(Q(Z.type)&&Ne!==""){for(;typeof Z.tokens[Z.index]<"u";){var me=Je.call(Z,Z.tokens[Z.index]);me&&me.type=="general"&&(Z.values[Z.index]=Z.tokens[Z.index]),Z.index++}var Be=!0}else var Be=!1;if(Ne=Z.values.join(""),Z.input){if(me=Ne.length-Z.value.length,me>0)var Ze=Z.caret+me;else var Ze=Z.caret;ge.call(Z.input,Ne,Ze,Be)}}if(Z.input){var te=null;if(Q(Z.type)){let ve=ge.call(Z.input);Z.number=K.call(Z,ve),Z.type=="percentage"&&ve.indexOf("%")!==-1?te=Z.number/100:te=Z.number}else Z.type=="datetime"&&(te=A.call(Z),Z.date[0]&&Z.date[1]&&Z.date[2]&&Z.input.setAttribute("data-completed",!0));te&&Z.input.setAttribute("data-value",te)}if(Ne!==void 0)return J?Z:Ne}};return oe.getType=Ae,oe.prepare=function(w,P){return P||(P={}),We.call(P,w)},oe.apply=function(w){var P=ge.call(w.target);w.key.length==1&&(P+=w.key),ge.call(w.target,oe(P,w.target.getAttribute("data-mask")))},oe.run=function(w,P,J){return oe(w,{mask:P,decimal:J})},oe.extract=function(w,P,J){if(r(w)||typeof P!="object")return w;if(P=Object.assign({},P),P.options||(P.options={}),!P.mask&&P.format&&(P.mask=P.format),P.mask){if(P.mask.indexOf(";")!==-1){var me=P.mask.split(";");P.mask=me[0]}P.mask=P.mask.replace(new RegExp(/\[h]/),"|h|"),P.mask=P.mask.replace(new RegExp(/\[.*?\]/),""),P.mask=P.mask.replace(new RegExp(/\|h\|/),"[h]")}ee.call(P,P.mask);var Z=null,ue=null;if(P.type=="percent"||P.options.style=="percent"?Z="percentage":P.mask&&(Z=Ae.call(P,P.mask)),Z==="general"){var ye=oe(w,P,!0);ue=w}else if(Z==="datetime"){w instanceof Date&&(w=oe.getDateString(w,P.mask));var ye=oe(w,P,!0);d.isNumeric(w)?ue=w:ue=l.call(ye)}else{ue=K.call(P,w),Z==="percentage"&&w.indexOf("%")!==-1&&(ue/=100);var ye=P}return ye.value=ue,!ye.type&&Z&&(ye.type=Z),J?ye:ue},oe.render=function(w,P,J){if(r(w)||typeof P!="object")return w;if(P=Object.assign({},P),P.options||(P.options={}),!P.mask&&P.format&&(P.mask=P.format),P.mask){if(P.mask.indexOf(";")!==-1){var me=P.mask.split(";");J||(me[0]=me[0].replace(new RegExp(/_\)/g),""),me[0]=me[0].replace(new RegExp(/_\(/g),"")),P.mask=me[0]}P.mask=P.mask.replace(new RegExp(/\[h]/),"|h|"),P.mask=P.mask.replace(new RegExp(/\[.*?\]/),""),P.mask=P.mask.replace(new RegExp(/\|h\|/),"[h]")}var Z=null;P.type=="percent"||P.options.style=="percent"?Z="percentage":P.mask?Z=Ae.call(P,P.mask):w instanceof Date&&(Z="datetime");var ue=!1;if(Z=="datetime"||P.type=="calendar"){var me=oe.getDateString(w,P.mask);me&&(w=me),P.mask&&J&&(ue=!0)}else if(Z=="percentage"&&(w*=100),typeof w=="number"){var me=null;if(P.mask&&J&&(""+w).indexOf("e")===-1){var ye=ee.call(P,P.mask);P.mask.indexOf(ye)!==-1?(ye=P.mask.split(ye),ye=""+ye[1].match(/[0-9]+/g),ye=ye.length,me=w.toFixed(ye)):me=w.toFixed(0)}else if(P.locale&&J){var ye=(""+w).split(".");if(P.options){typeof ye[1]>"u"&&(ye[1]="");var we=ye[1].length;if(P.options.minimumFractionDigits>we)for(var Re=0;Re<P.options.minimumFractionDigits-we;Re++)ye[1]+="0"}ye[1].length?me=ye.join("."):me=ye[0];var we=ye[1].length;P.options&&P.options.maximumFractionDigits<we&&(me=parseFloat(me).toFixed(P.options.maximumFractionDigits))}else me=W(w);me!==null&&(w=me,ee.call(P,P.mask),P.options.decimal&&(w=w.replace(".",P.options.decimal)))}else P.mask&&J&&(ue=!0);if(ue){var Ne=P.mask.length-w.length;if(Ne>0)for(var Re=0;Re<Ne;Re++)w+=" "}if(w=oe(w,P),J&&Z==="numeric"){var Be=P.mask.match(new RegExp(/^[0]+$/gm));if(Be&&Be.length===1){var Ze=Be[0].length;if(Ze>3)for(w=""+w;w.length<Ze;)w="0"+w}}return w},oe.set=function(w,P){if(P){w.setAttribute("data-mask",P);var J=new Event("input",{bubbles:!0,cancelable:!0});w.dispatchEvent(J)}},oe.extractDateFromString=function(w,P){var J=oe(w,{mask:P},!0);if(w>0&&Number(w)==w&&(J.values.join("")!==J.value||J.type=="numeric")){var me=new Date(Math.round((w-25569)*86400*1e3));return me.getFullYear()+"-"+d.two(me.getMonth())+"-"+d.two(me.getDate())+" 00:00:00"}var Z=!1;return J.values.length===J.tokens.length&&J.values[J.values.length-1].length>=J.tokens[J.tokens.length-1].length&&(Z=!0),J.date[0]&&J.date[1]&&(J.date[2]||Z)?(J.date[2]||(J.date[2]=1),J.date[0]+"-"+d.two(J.date[1])+"-"+d.two(J.date[2])+" "+d.two(J.date[3])+":"+d.two(J.date[4])+":"+d.two(J.date[5])):""},oe.getDateString=function(w,P){if(!P)var P={};if(P&&typeof P=="object")var J=P.format;else var J=P;if(J||(J="YYYY-MM-DD"),J.indexOf("[h]")>=0){var me=0;if(w&&d.isNumeric(w)&&(me=parseFloat(24*Number(w)),J.indexOf("mm")>=0)){var Z=(""+me).split(".");if(Z[1]){var ue=60*parseFloat("0."+Z[1]);ue=parseFloat(ue.toFixed(2))}else var ue=0;me=parseInt(Z[0])+":"+d.two(ue)}return me}w instanceof Date?w=h.now(w):w&&d.isNumeric(w)&&(w=h.numToDate(w));for(var ye=["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."],Re=new RegExp(ye.join("|"),"gi"),we=J.match(Re),Ne=0;Ne<we.length;Ne++)we[Ne].toUpperCase()=="MM"&&(we[Ne-1]&&we[Ne-1].toUpperCase().indexOf("H")>=0||we[Ne-2]&&we[Ne-2].toUpperCase().indexOf("H")>=0||we[Ne+1]&&we[Ne+1].toUpperCase().indexOf("S")>=0||we[Ne+2]&&we[Ne+2].toUpperCase().indexOf("S")>=0)&&(we[Ne]="mi");var Be={tokens:we};if(w){var ue=""+w,Ze=ue.indexOf("T")!==-1?"T":" ";ue=ue.split(Ze);var Z=0,te=0,ve=0;if(ue[1]&&(Z=ue[1].split(":"),te=Z[1]?Z[1]:0,ve=Z[2]?Z[2]:0,Z=Z[0]?Z[0]:0),ue=ue[0].split("-"),ue[0]&&ue[1]&&ue[2]&&ue[0]>0&&ue[1]>0&&ue[1]<13&&ue[2]>0&&ue[2]<32){Be.data=[ue[0],ue[1],ue[2],Z,te,ve],Be.value=[];for(var Ce=new Date(Be.data[0],Be.data[1]-1,Be.data[2],Be.data[3],Be.data[4],Be.data[5]),Oe=function(rt){var at=this.tokens[rt],Ve=at.toUpperCase(),qe=null;Ve==="YYYY"?qe=this.data[0]:Ve==="YYY"?qe=this.data[0].substring(1,4):Ve==="YY"?qe=this.data[0].substring(2,4):Ve==="Y"?qe=this.data[0].substring(3,4):at==="MON"?qe=h.months[Ce.getMonth()].substr(0,3).toUpperCase():at==="mon"?qe=h.months[Ce.getMonth()].substr(0,3).toLowerCase():at==="MONTH"?qe=h.months[Ce.getMonth()].toUpperCase():at==="month"?qe=h.months[Ce.getMonth()].toLowerCase():Ve==="MMMMM"?qe=h.months[Ce.getMonth()].substr(0,1):Ve==="MMMM"||at==="Month"?qe=h.months[Ce.getMonth()]:Ve==="MMM"||at=="Mon"?qe=h.months[Ce.getMonth()].substr(0,3):Ve==="MM"?qe=d.two(this.data[1]):Ve==="M"?qe=Ce.getMonth()+1:at==="DAY"?qe=h.weekdays[Ce.getDay()].toUpperCase():at==="day"?qe=h.weekdays[Ce.getDay()].toLowerCase():Ve==="DDDD"||at=="Day"?qe=h.weekdays[Ce.getDay()]:Ve==="DDD"?qe=h.weekdays[Ce.getDay()].substr(0,3):Ve==="DD"?qe=d.two(this.data[2]):Ve==="D"?qe=parseInt(this.data[2]):Ve==="Q"?qe=Math.floor((Ce.getMonth()+3)/3):Ve==="HH24"||Ve==="HH"?(qe=this.data[3],qe>12&&this.tokens.indexOf("am/pm")!==-1&&(qe-=12),qe=d.two(qe)):Ve==="HH12"?this.data[3]>12?qe=d.two(this.data[3]-12):qe=d.two(this.data[3]):Ve==="H"?(qe=this.data[3],qe>12&&this.tokens.indexOf("am/pm")!==-1&&(qe-=12,qe=d.two(qe))):Ve==="MI"?qe=d.two(this.data[4]):Ve==="SS"?qe=d.two(this.data[5]):Ve==="MS"?qe=Ce.getMilliseconds():Ve==="AM/PM"?this.data[3]>=12?qe="PM":qe="AM":Ve==="WD"&&(qe=h.weekdays[Ce.getDay()]),qe===null?this.value[rt]=this.tokens[rt]:this.value[rt]=qe},Ne=0;Ne<Be.tokens.length;Ne++)Oe.call(Be,Ne);w=Be.value.join("")}else w=""}return w},oe}var M=N();function T(){var j=function(A,l){if(A.calendar)return A.calendar.setOptions(l,!0);var r={type:"calendar"};r.options={},r.date=null,r.setOptions=function(W,oe){var w={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:h.monthsShort,monthsFull:h.months,weekdays:h.weekdays,textDone:b.translate("Done"),textReset:b.translate("Reset"),textUpdate:b.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null,controls:!0,autoSelect:!0};for(var P in w)W&&W.hasOwnProperty(P)?r.options[P]=W[P]:(typeof r.options[P]>"u"||oe===!0)&&(r.options[P]=w[P]);if(r.options.resetButton==!1?I.style.display="none":I.style.display="",r.options.readonly?A.setAttribute("readonly","readonly"):A.removeAttribute("readonly"),r.options.placeholder?A.setAttribute("placeholder",r.options.placeholder):A.removeAttribute("placeholder"),d.isNumeric(r.options.value)&&r.options.value>0&&(r.options.value=j.numToDate(r.options.value),r.options.dataType="numeric"),I.innerHTML=r.options.textReset,B.innerHTML=r.options.textDone,Je.innerHTML=r.options.textUpdate,A.setAttribute("data-mask",r.options.format.toLowerCase()),!r.options.value&&r.options.today)var J=j.now();else var J=r.options.value;return J&&(r.options.value=null,r.setValue(J)),r},r.open=function(W){if(!D.classList.contains("jcalendar-focus")&&!D.classList.contains("jcalendar-inline")){if(j.current=r,u(r,!0),r.getDays(),r.options.type=="year-month-picker"&&r.getMonths(),r.options.time&&(ce.value=r.date[3],Ae.value=r.date[4]),D.classList.add("jcalendar-focus"),d.getWindowWidth()<800||r.options.fullscreen)D.classList.add("jcalendar-fullsize"),H.slideBottom(ne,1);else{D.classList.remove("jcalendar-fullsize");var oe=A.getBoundingClientRect(),w=ne.getBoundingClientRect();if(r.options.position)K.style.position="fixed",window.innerHeight<oe.bottom+w.height?K.style.top=oe.top-(w.height+2)+"px":K.style.top=oe.top+oe.height+2+"px",K.style.left=oe.left+"px";else{if(window.innerHeight<oe.bottom+w.height){var P=-1*(oe.height+w.height+2);P+oe.top<0&&(P=-1*(oe.top+oe.height)),K.style.top=P+"px"}else K.style.top="2px";if(window.innerWidth<oe.left+w.width){var P=window.innerWidth-(oe.left+w.width+20);K.style.left=P+"px"}else K.style.left="0px"}}typeof r.options.onopen=="function"&&r.options.onopen(A)}},r.close=function(W,oe){if(r.options.autoSelect!==!0&&typeof oe>"u"&&(oe=!1),D.classList.contains("jcalendar-focus")){if(oe!==!1){var w=D.querySelector(".jcalendar-selected");if(typeof oe=="string")var P=oe;else if(!w||w.classList.contains("jcalendar-disabled"))var P=r.options.value;else var P=r.getValue();r.setValue(P)}else if(r.options.value){let J=r.options.value;r.options.value="",r.setValue(J)}!W&&typeof r.options.onclose=="function"&&r.options.onclose(A),D.classList.remove("jcalendar-focus"),u(r,!1),j.current=null}return r.options.value},r.prev=function(){r.options.mode=="years"?(r.date[0]=r.date[0]-12,r.getYears()):r.options.mode=="months"?(r.date[0]=parseInt(r.date[0])-1,r.getMonths()):(r.date[1]<2?(r.date[0]=r.date[0]-1,r.date[1]=12):r.date[1]=r.date[1]-1,r.getDays())},r.next=function(){r.options.mode=="years"?(r.date[0]=parseInt(r.date[0])+12,r.getYears()):r.options.mode=="months"?(r.date[0]=parseInt(r.date[0])+1,r.getMonths()):(r.date[1]>11?(r.date[0]=parseInt(r.date[0])+1,r.date[1]=1):r.date[1]=parseInt(r.date[1])+1,r.getDays())},r.setToday=function(){var W=new Date().toISOString().substr(0,10);return r.setValue(W),W},r.setValue=function(W){W||(W=""+W);var oe=W,w=r.options.value;if(w!=oe){if(oe){r.setLabel(oe,r.options);var J=oe.split(" ");J[1]||(J[1]="00:00:00");var P=J[1].split(":"),J=J[0].split("-"),me=parseInt(J[0]),Z=parseInt(J[1]),ue=parseInt(J[2]),ye=parseInt(P[0]),Re=parseInt(P[1]);r.date=[me,Z,ue,ye,Re,0];var W=r.setLabel(oe,r.options),we=j.now(new Date(me,Z-1,ue),!0);if(r.options.validRange){if(!r.options.validRange[0]||we>=r.options.validRange[0])var Ne=!0;else var Ne=!1;if(!r.options.validRange[1]||we<=r.options.validRange[1])var Be=!0;else var Be=!1;Ne&&Be?(A.classList.remove("jcalendar_warning"),A.title=""):(A.classList.add("jcalendar_warning"),A.title=b.translate("Date outside the valid range"))}else A.classList.remove("jcalendar_warning"),A.title=""}else{r.date=null;var W="";A.classList.remove("jcalendar_warning"),A.title=""}r.options.value=oe,typeof r.options.onchange=="function"&&r.options.onchange(A,oe,w),A.value!=W&&(A.value=W,typeof A.oninput=="function"&&A.oninput({type:"input",target:A,value:A.value}))}r.getDays(),r.options.type=="year-month-picker"&&r.getMonths()},r.getValue=function(){return r.date?r.options.time?d.two(r.date[0])+"-"+d.two(r.date[1])+"-"+d.two(r.date[2])+" "+d.two(r.date[3])+":"+d.two(r.date[4])+":"+d.two(0):d.two(r.date[0])+"-"+d.two(r.date[1])+"-"+d.two(r.date[2])+" "+d.two(0)+":"+d.two(0)+":"+d.two(0):""},r.update=function(W,oe){if(!W.classList.contains("jcalendar-disabled")){var w=D.querySelector(".jcalendar-selected");w&&w.classList.remove("jcalendar-selected"),W.classList.add("jcalendar-selected"),W.classList.contains("jcalendar-set-month")?(r.date[1]=oe,r.date[2]=1):r.date[2]=W.innerText,r.options.time?(r.date[3]=ce.value,r.date[4]=Ae.value):r.close(null,!0)}ee()},r.reset=function(){r.setValue(""),r.date=null,r.close(!1,!1)},r.getDays=function(){r.options.mode="days";var ye=new Date,W=r.date&&d.isNumeric(r.date[0])?r.date[0]:parseInt(ye.getFullYear()),oe=r.date&&d.isNumeric(r.date[1])?r.date[1]:parseInt(ye.getMonth())+1,w=r.date&&d.isNumeric(r.date[2])?r.date[2]:parseInt(ye.getDate()),P=r.date&&d.isNumeric(r.date[3])?r.date[3]:parseInt(ye.getHours()),J=r.date&&d.isNumeric(r.date[4])?r.date[4]:parseInt(ye.getMinutes());r.date=[W,oe,w,P,J,0],ge.innerHTML=W,de.innerHTML=r.options.months[oe-1];var me=ye.getMonth()==oe-1&&ye.getFullYear()==W,Z=ye.getDate(),ye=new Date(W,oe,0,0,0),ue=ye.getDate(),ye=new Date(W,oe-1,0,0,0),Re=ye.getDay()+1,Ze=r.options.startingDay||0;Re=Re-Ze,le.innerHTML="";var we=document.createElement("tr");we.setAttribute("align","center"),le.appendChild(we);for(var Ne=0;Ne<7;Ne++){var Be=document.createElement("td");Be.classList.add("jcalendar-weekday"),Be.innerHTML=r.options.weekdays[Ze].substr(0,1),we.appendChild(Be),Ze++,Ze>6&&(Ze=0)}for(var Ze=0,te=0,ve=0;ve<6;ve++){var we=document.createElement("tr");we.setAttribute("align","center"),we.style.height="34px";for(var Ne=0;Ne<7;Ne++){var Be=document.createElement("td");if(Be.classList.add("jcalendar-set-day"),Ze>=Re&&Ze<Re+ue){te++,Be.innerHTML=te,te==w&&Be.classList.add("jcalendar-selected"),me&&Z==te&&(Be.style.fontWeight="bold");var Ce=j.now(new Date(W,oe-1,te),!0);if(r.options.validRange){if(!r.options.validRange[0]||Ce>=r.options.validRange[0])var Oe=!0;else var Oe=!1;if(!r.options.validRange[1]||Ce<=r.options.validRange[1])var tt=!0;else var tt=!1;Oe&&tt||Be.classList.add("jcalendar-disabled")}}we.appendChild(Be),Ze++}le.appendChild(we)}r.options.time?Le.style.display="":Le.style.display="none",ee()},r.getMonths=function(){r.options.mode="months";var W=r.options.months;r.options.value;var oe=new Date,w=parseInt(oe.getFullYear()),P=parseInt(oe.getMonth())+1,J=r.date&&d.isNumeric(r.date[0])?r.date[0]:w,me=r.date&&d.isNumeric(r.date[1])?r.date[1]:P;ge.innerHTML=r.date[0],de.innerHTML=W[me-1];var Z=document.createElement("table");Z.setAttribute("width","100%");for(var ue=null,ye=0;ye<12;ye++){if(!(ye%4)){var ue=document.createElement("tr");ue.setAttribute("align","center"),Z.appendChild(ue)}var Re=document.createElement("td");if(Re.classList.add("jcalendar-set-month"),Re.setAttribute("data-value",ye+1),Re.innerText=W[ye],r.options.validRange){var we=J+"-"+d.two(ye+1);if(!r.options.validRange[0]||we>=r.options.validRange[0].substr(0,7))var Ne=!0;else var Ne=!1;if(!r.options.validRange[1]||we<=r.options.validRange[1].substr(0,7))var Be=!0;else var Be=!1;Ne&&Be||Re.classList.add("jcalendar-disabled")}ye+1==me&&Re.classList.add("jcalendar-selected"),w==J&&ye+1==P&&(Re.style.fontWeight="bold"),ue.appendChild(Re)}le.innerHTML='<tr><td colspan="7"></td></tr>',le.children[0].children[0].appendChild(Z),ee()},r.getYears=function(){r.options.mode="years";for(var W=new Date,oe=W.getFullYear(),w=r.date&&d.isNumeric(r.date[0])?r.date[0]:parseInt(W.getFullYear()),P=[],J=0;J<25;J++)P[J]=parseInt(r.date[0])+(J-12);var me=document.createElement("table");me.setAttribute("width","100%");for(var J=0;J<25;J++){if(!(J%5)){var Z=document.createElement("tr");Z.setAttribute("align","center"),me.appendChild(Z)}var ue=document.createElement("td");ue.classList.add("jcalendar-set-year"),ue.innerText=P[J],w==P[J]&&ue.classList.add("jcalendar-selected"),oe==P[J]&&(ue.style.fontWeight="bold"),Z.appendChild(ue)}le.innerHTML='<tr><td colspan="7"></td></tr>',le.firstChild.firstChild.appendChild(me),ee()},r.setLabel=function(W,oe){return j.getDateString(W,oe)},r.fromFormatted=function(W,oe){return j.extractDateFromString(W,oe)};var F=function(W){var oe=d.findElement(W.target,"jcalendar-container");if(oe){var w=W.target.className;if(w=="jcalendar-prev")r.prev();else if(w=="jcalendar-next")r.next();else if(w=="jcalendar-month")r.getMonths();else if(w=="jcalendar-year")r.getYears();else if(w=="jcalendar-set-year")r.date[0]=W.target.innerText,r.options.type=="year-month-picker"?r.getMonths():r.getDays();else if(W.target.classList.contains("jcalendar-set-month")){var P=parseInt(W.target.getAttribute("data-value"));r.options.type=="year-month-picker"?r.update(W.target,P):(r.date[1]=P,r.getDays())}else w=="jcalendar-confirm"||w=="jcalendar-update"||w=="jcalendar-close"?r.close(null,!0):w=="jcalendar-backdrop"?r.close(!1,!1):w=="jcalendar-reset"?r.reset():W.target.classList.contains("jcalendar-set-day")&&W.target.innerText&&r.update(W.target)}else r.close(!1,!1)},Q=function(W){if(W.target.value&&W.target.value.length>3){var oe=j.extractDateFromString(W.target.value,r.options.format);oe&&r.setValue(oe)}},ee=function(){var W=D.querySelector(".jcalendar-selected");W&&W.classList.contains("jcalendar-disabled")?(Je.setAttribute("disabled","disabled"),ce.setAttribute("disabled","disabled"),Ae.setAttribute("disabled","disabled")):(Je.removeAttribute("disabled"),ce.removeAttribute("disabled"),Ae.removeAttribute("disabled")),typeof r.options.onupdate=="function"&&r.options.onupdate(A,r.getValue())},D=null,I=null,B=null,K=null,ne=null,ge=null,de=null,fe=null,le=null,he=null,Le=null,We=null,Je=null,ce=null,Ae=null,X=function(){A.tagName=="INPUT"&&A.value&&(l.value=A.value),I=document.createElement("div"),I.className="jcalendar-reset",B=document.createElement("div"),B.className="jcalendar-confirm",he=document.createElement("div"),he.className="jcalendar-controls",he.style.borderBottom="1px solid #ddd",he.appendChild(I),he.appendChild(B),K=document.createElement("div"),K.className="jcalendar-container",ne=document.createElement("div"),ne.className="jcalendar-content",K.appendChild(ne),A.tagName=="DIV"?(D=A,D.classList.add("jcalendar-inline")):(ne.appendChild(he),D=document.createElement("div"),D.className="jcalendar"),D.classList.add("jcalendar-container"),D.appendChild(K);var W=document.createElement("div");W.className="jcalendar-table",ne.appendChild(W);var oe=document.createElement("td");oe.setAttribute("colspan","2"),oe.className="jcalendar-prev",ge=document.createElement("span"),ge.className="jcalendar-year",de=document.createElement("span"),de.className="jcalendar-month";var w=document.createElement("td");w.className="jcalendar-header",w.setAttribute("colspan","3"),w.appendChild(de),w.appendChild(ge);var P=document.createElement("td");P.setAttribute("colspan","2"),P.className="jcalendar-next";var J=document.createElement("thead"),me=document.createElement("tr");me.appendChild(oe),me.appendChild(w),me.appendChild(P),J.appendChild(me),fe=document.createElement("table"),le=document.createElement("tbody"),fe.setAttribute("cellpadding","0"),fe.setAttribute("cellspacing","0"),fe.appendChild(J),fe.appendChild(le),W.appendChild(fe),ce=document.createElement("select"),ce.className="jcalendar-select",ce.onchange=function(){r.date[3]=this.value,typeof r.options.onupdate=="function"&&r.options.onupdate(A,r.getValue())};for(var Z=0;Z<24;Z++){var ue=document.createElement("option");ue.value=Z,ue.innerHTML=d.two(Z),ce.appendChild(ue)}Ae=document.createElement("select"),Ae.className="jcalendar-select",Ae.onchange=function(){r.date[4]=this.value,typeof r.options.onupdate=="function"&&r.options.onupdate(A,r.getValue())};for(var Z=0;Z<60;Z++){var ue=document.createElement("option");ue.value=Z,ue.innerHTML=d.two(Z),Ae.appendChild(ue)}var ye=document.createElement("div");ye.className="jcalendar-controls",Le=document.createElement("div"),Le.className="jcalendar-time",Le.style.maxWidth="140px",Le.appendChild(ce),Le.appendChild(Ae),Je=document.createElement("button"),Je.setAttribute("type","button"),Je.className="jcalendar-update",We=document.createElement("div"),We.style.flexGrow="10",We.appendChild(Je),ye.appendChild(Le),A.tagName=="INPUT"&&ye.appendChild(We),ne.appendChild(ye);var Re=document.createElement("div");Re.className="jcalendar-backdrop",D.appendChild(Re),A.addEventListener("keyup",Q),D.addEventListener("swipeleft",function(we){H.slideLeft(fe,0,function(){r.next(),H.slideRight(fe,1)}),we.preventDefault(),we.stopPropagation()}),D.addEventListener("swiperight",function(we){H.slideRight(fe,0,function(){r.prev(),H.slideLeft(fe,1)}),we.preventDefault(),we.stopPropagation()}),"ontouchend"in document.documentElement?(D.addEventListener("touchend",F),A.addEventListener("touchend",r.open)):(D.addEventListener("mouseup",F),A.addEventListener("mouseup",r.open)),j.hasEvents||(j.hasEvents=!0,document.addEventListener("keydown",j.keydown)),r.setOptions(l),A.tagName=="INPUT"?(A.parentNode.insertBefore(D,A.nextSibling),A.setAttribute("autocomplete","off"),A.classList.add("jcalendar-input"),A.value=r.setLabel(r.getValue(),r.options)):(r.getDays(),r.options.time&&(ce.value=r.date[3],Ae.value=r.date[4])),r.options.opened==!0&&r.open(),r.options.controls==!1&&K.classList.add("jcalendar-hide-controls"),A.change=r.setValue,A.val=function(we){if(we===void 0)return r.getValue();r.setValue(we)},A.calendar=D.calendar=r};return X(),r};return j.keydown=function(A){var l=null;(l=j.current)&&(A.which==13?l.close(!1,!0):A.which==27&&l.close(!1,!1))},j.prettify=function(A,l){if(!l)var l={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"};A.indexOf("GMT")===-1&&A.indexOf("Z")===-1&&(A+=" GMT");var r=new Date,F=new Date(A),Q=parseInt((r-F)/1e3/60);if(String.prototype.format=function(D){return this.replace("{0}",D)},Q==0)var ee=l.justNow;else if(Q<90)var ee=l.xMinutesAgo.format(Q);else if(Q<1440)var ee=l.xHoursAgo.format(Math.round(Q/60));else if(Q<20160)var ee=l.xDaysAgo.format(Math.round(Q/1440));else if(Q<43200)var ee=l.xWeeksAgo.format(Math.round(Q/10080));else if(Q<1036800)var ee=l.xMonthsAgo.format(Math.round(Q/43200));else var ee=l.xYearsAgo.format(Math.round(Q/525600));return ee},j.prettifyAll=function(){for(var A=document.querySelectorAll(".prettydate"),l=0;l<A.length;l++)A[l].getAttribute("data-date")?A[l].innerHTML=j.prettify(A[l].getAttribute("data-date")):A[l].innerHTML&&(A[l].setAttribute("title",A[l].innerHTML),A[l].setAttribute("data-date",A[l].innerHTML),A[l].innerHTML=j.prettify(A[l].innerHTML))},j.now=h.now,j.toArray=h.toArray,j.dateToNum=h.dateToNum,j.numToDate=h.numToDate,j.weekdays=h.weekdays,j.months=h.months,j.weekdaysShort=h.weekdaysShort,j.monthsShort=h.monthsShort,j.extractDateFromString=M.extractDateFromString,j.getDateString=M.getDateString,j}var G=T();function Y(){var j={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},A=function(l){return j[l]?j[l]:j.material};return A.get=function(l){return j[l]?j[l]:j},A.set=function(l,r){j[l]=r},A}var ae=Y();function be(j,A){var l={};l.options={};var r={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var F in r)A&&A.hasOwnProperty(F)?l.options[F]=A[F]:l.options[F]=r[F];j.classList.add("jtabs");var Q=null,ee=null,D=null,I=function(de){if(l.options.animation){var fe=l.headers.children[de].getBoundingClientRect();l.options.palette==="modern"?(D.style.width=fe.width-4+"px",D.style.left=l.headers.children[de].offsetLeft+2+"px"):(D.style.width=fe.width+"px",D.style.left=l.headers.children[de].offsetLeft+"px"),l.options.position==="bottom"?D.style.top="0px":D.style.bottom="0px"}},B=function(de){typeof l.headers.scrollTo=="function"?l.headers.scrollTo({left:de,behavior:"smooth"}):l.headers.scrollLeft=de,de<=1?Q.classList.add("disabled"):Q.classList.remove("disabled"),de>=l.headers.scrollWidth-l.headers.offsetWidth?ee.classList.add("disabled"):ee.classList.remove("disabled"),l.headers.scrollWidth<=l.headers.offsetWidth?(Q.style.display="none",ee.style.display="none"):(Q.style.display="",ee.style.display="")};if(l.setBorder=I,l.open=function(de){for(var fe=null,le=0;le<l.headers.children.length;le++)l.headers.children[le].classList.contains("jtabs-selected")&&(fe=le),l.headers.children[le].classList.remove("jtabs-selected"),l.content.children[le]&&l.content.children[le].classList.remove("jtabs-selected");if(l.headers.children[de].classList.add("jtabs-selected"),l.content.children[de]&&l.content.children[de].classList.add("jtabs-selected"),fe!=de&&typeof l.options.onchange=="function"&&l.content.children[de]&&l.options.onchange(j,l,de,l.headers.children[de],l.content.children[de]),l.options.hideHeaders==!0&&l.headers.children.length<3&&l.options.allowCreate==!1)l.headers.parentNode.style.display="none";else{I(de),l.headers.parentNode.style.display="";var he=l.headers.children[de].offsetLeft,Le=he+l.headers.children[de].offsetWidth,We=l.headers.scrollLeft,Je=We+l.headers.offsetWidth;We<=he&&Je>=Le||B(he-1)}},l.selectIndex=function(de){var fe=Array.prototype.indexOf.call(l.headers.children,de);return fe>=0&&l.open(fe),fe},l.rename=function(de,fe){fe||(fe=prompt("New title",l.headers.children[de].innerText)),l.headers.children[de].innerText=fe,l.open(de)},l.create=function(de,fe){if(typeof l.options.onbeforecreate=="function"){var le=l.options.onbeforecreate(j);if(le===!1)return!1;de=le}var he=l.appendElement(de);return typeof l.options.oncreate=="function"&&l.options.oncreate(j,he),I(),he},l.remove=function(de){return l.deleteElement(de)},l.nextNumber=function(){for(var de=0,fe=0;fe<l.headers.children.length;fe++){var le=l.headers.children[fe].innerText.match(/[0-9].*/);le>de&&(de=parseInt(le))}return de?de++:de=1,de},l.deleteElement=function(de){if(l.headers.children[de])l.headers.removeChild(l.headers.children[de]),l.content.removeChild(l.content.children[de]);else return!1;l.open(0),typeof l.options.ondelete=="function"&&l.options.ondelete(j,de)},l.appendElement=function(de,fe){if(!de)var de=prompt("Title?","");if(de){var le=document.createElement("div");l.content.appendChild(le);var he=document.createElement("div");return he.innerHTML=de,he.content=le,l.headers.insertBefore(he,l.headers.lastChild),l.options.allowChangePosition&&he.setAttribute("draggable","true"),l.selectIndex(he),typeof fe=="function"&&fe(le,he),le}},l.getActive=function(){for(var de=0;de<l.headers.children.length;de++)if(l.headers.children[de].classList.contains("jtabs-selected"))return de;return 0},l.updateContent=function(de,fe){if(typeof fe!="string")var le=fe;else{var le=document.createElement("div");le.innerHTML=fe}l.content.children[de].classList.contains("jtabs-selected")&&fe.classList.add("jtabs-selected"),l.content.replaceChild(fe,l.content.children[de]),I()},l.updatePosition=function(de,fe){de>fe?l.content.insertBefore(l.content.children[de],l.content.children[fe]):l.content.insertBefore(l.content.children[de],l.content.children[fe].nextSibling),l.open(fe),typeof l.options.onchangeposition=="function"&&l.options.onchangeposition(l.headers,de,fe)},l.move=function(de,fe){de>fe?l.headers.insertBefore(l.headers.children[de],l.headers.children[fe]):l.headers.insertBefore(l.headers.children[de],l.headers.children[fe].nextSibling),l.updatePosition(de,fe)},l.setBorder=I,l.init=function(){j.innerHTML="",l.headers=document.createElement("div"),l.content=document.createElement("div"),l.headers.classList.add("jtabs-headers"),l.content.classList.add("jtabs-content"),l.options.palette?j.classList.add("jtabs-modern"):j.classList.remove("jtabs-modern"),l.options.padding&&(l.content.style.padding=parseInt(l.options.padding)+"px");var de=document.createElement("div");de.className="jtabs-headers-container",de.appendChild(l.headers),l.options.maxWidth&&(de.style.maxWidth=parseInt(l.options.maxWidth)+"px");var fe=document.createElement("div");if(fe.className="jtabs-controls",fe.setAttribute("draggable","false"),de.appendChild(fe),l.options.position=="bottom"?(j.appendChild(l.content),j.appendChild(de)):(j.appendChild(de),j.appendChild(l.content)),l.options.allowCreate==!0){var le=document.createElement("div");le.className="jtabs-add",le.onclick=function(){l.create()},fe.appendChild(le)}Q=document.createElement("div"),Q.className="jtabs-prev",Q.onclick=function(){B(l.headers.scrollLeft-l.headers.offsetWidth)},fe.appendChild(Q),ee=document.createElement("div"),ee.className="jtabs-next",ee.onclick=function(){B(l.headers.scrollLeft+l.headers.offsetWidth)},fe.appendChild(ee);for(var he=0;he<l.options.data.length;he++){if(l.options.data[he].titleElement)var Le=l.options.data[he].titleElement;else var Le=document.createElement("div");if(l.options.data[he].icon){var We=document.createElement("div"),Je=document.createElement("i");Je.classList.add("material-icons"),Je.innerHTML=l.options.data[he].icon,We.appendChild(Je),Le.appendChild(We)}if(l.options.data[he].title){var ce=document.createTextNode(l.options.data[he].title);Le.appendChild(ce)}if(l.options.data[he].width&&(Le.style.width=l.options.data[he].width),l.options.data[he].contentElement)var Ae=l.options.data[he].contentElement;else{var Ae=document.createElement("div");Ae.innerHTML=l.options.data[he].content}l.headers.appendChild(Le),l.content.appendChild(Ae)}D=document.createElement("div"),D.className="jtabs-border",l.headers.appendChild(D),l.options.animation&&j.classList.add("jtabs-animation"),l.headers.addEventListener("click",function(X){if(X.target.parentNode.classList.contains("jtabs-headers"))var W=X.target;else if(X.target.tagName=="I")var W=X.target.parentNode.parentNode;else var W=X.target.parentNode;var oe=l.selectIndex(W);typeof l.options.onclick=="function"&&l.options.onclick(j,l,oe,l.headers.children[oe],l.content.children[oe])}),l.headers.addEventListener("contextmenu",function(X){l.selectIndex(X.target)}),l.headers.children.length&&l.open(0),B(0),l.options.allowChangePosition==!0&&v(l.headers,{direction:1,ondrop:function(X,W,oe){l.updatePosition(W,oe)}}),typeof l.options.onload=="function"&&l.options.onload(j,l)},j.children[0]&&j.children[0].children.length)for(var K=0;K<j.children[0].children.length;K++){var ne=l.options.data&&l.options.data[K]?l.options.data[K]:{};j.children[1]&&j.children[1].children[K]?(ne.titleElement=j.children[0].children[K],ne.contentElement=j.children[1].children[K]):ne.contentElement=j.children[0].children[K],l.options.data[K]=ne}var ge=!1;if(l.options.data)for(var K=0;K<l.options.data.length;K++)l.options.data[K].url&&(S({url:l.options.data[K].url,type:"GET",dataType:"text/html",index:K,success:function(fe){l.options.data[this.index].content=fe},complete:function(){l.init()}}),ge=!0);return ge||l.init(),j.tabs=l,l}function se(j,A){if(j.color)return j.color.setOptions(A,!0);var l={type:"color"};l.options={};var r=null,F=null,Q=null,ee=null,D=null,I=null,B=null;l.setOptions=function(w,P){var J={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};w||(w={}),w&&!w.palette&&(w.palette=ae());for(var me in J)w&&w.hasOwnProperty(me)?l.options[me]=w[me]:(typeof l.options[me]>"u"||P===!0)&&(l.options[me]=J[me]);return ee&&(ee.innerHTML=l.options.resetLabel),D&&(D.innerHTML=l.options.doneLabel),l.options.palette&&B&&B.updateContent(0,fe()),typeof l.options.value=="string"&&(j.value=l.options.value,j.tagName==="INPUT"&&(j.style.color=j.value,j.style.backgroundColor=j.value)),l.options.placeholder?j.setAttribute("placeholder",l.options.placeholder):j.getAttribute("placeholder")&&j.removeAttribute("placeholder"),l},l.select=function(w){var P=r.querySelector(".jcolor-selected");P&&P.classList.remove("jcolor-selected"),l.values[w]&&l.values[w].classList.add("jcolor-selected"),l.options.value=w},l.open=function(){if(!r.classList.contains("jcolor-focus")){u(l,!0),r.classList.add("jcolor-focus"),l.options.value&&l.select(l.options.value),Q.style.marginTop="",Q.style.marginLeft="";var w=Q.getBoundingClientRect(),P=d.getWindowWidth(),J=d.getWindowHeight();if(P<800||l.options.fullscreen==!0?(Q.classList.add("jcolor-fullscreen"),H.slideBottom(Q,1),F.style.display="block"):(Q.classList.contains("jcolor-fullscreen")&&(Q.classList.remove("jcolor-fullscreen"),F.style.display=""),l.options.position?Q.style.position="fixed":Q.style.position="",w.left+w.width>P&&(Q.style.marginLeft=-1*(w.left+w.width-(P-20))+"px"),w.top+w.height>J&&(Q.style.marginTop=-1*(w.top+w.height-(J-20))+"px")),typeof l.options.onopen=="function"&&l.options.onopen(j,l),B.setBorder(B.getActive()),l.options.value){var me=de(l.options.value);Ae.forEach(function(Z,ue){Z.value=me[ue],Z.dispatchEvent(new Event("input"))})}}},l.close=function(w){return r.classList.contains("jcolor-focus")&&(r.classList.remove("jcolor-focus"),F.style.display="",!w&&typeof l.options.onclose=="function"&&l.options.onclose(j,l),u(l,!1)),l.options.value},l.setValue=function(w){w||(w=""),w!=l.options.value&&(l.options.value=w,ce=w,l.select(w),typeof l.options.onchange=="function"&&l.options.onchange(j,w,l),j.value!=l.options.value&&(j.value=l.options.value,j.tagName==="INPUT"&&(j.style.color=j.value,j.style.backgroundColor=j.value),typeof j.oninput=="function"&&j.oninput({type:"input",target:j,value:j.value})),l.options.closeOnChange==!0&&l.close())},l.getValue=function(){return l.options.value};var K=function(w){var P=w.toString(16);return P.length===1?"0"+P:P},ne=function(w,P,J){return"#"+K(w)+K(P)+K(J)},ge=function(w){return parseInt("0x"+w)},de=function(w){return[ge(w.substr(1,2)),ge(w.substr(3,2)),ge(w.substr(5,2))]},fe=function(){var w=document.createElement("div");w.className="jcolor-grid",l.values=[];var P=document.createElement("table");P.setAttribute("cellpadding","7"),P.setAttribute("cellspacing","0");for(var J=0;J<l.options.palette.length;J++){for(var me=document.createElement("tr"),Z=0;Z<l.options.palette[J].length;Z++){var ue=document.createElement("td"),ye=l.options.palette[J][Z];ye.length<7&&ye.substr(0,1)!=="#"&&(ye="#"+ye),ue.style.backgroundColor=ye,ue.setAttribute("data-value",ye),ue.innerHTML="",me.appendChild(ue),l.options.value==ye&&ue.classList.add("jcolor-selected"),l.values[ye]=ue}P.appendChild(me)}return w.appendChild(P),w},le=document.createElement("canvas");le.width=200,le.height=160;var he=le.getContext("2d"),Le=function(){var w=I.firstChild.getBoundingClientRect();le.width=w.width-14,We()},We=function(){var w=he.createLinearGradient(0,0,le.width,0);w.addColorStop(0,"rgb(255,0,0)"),w.addColorStop(.15,"rgb(255,0,255)"),w.addColorStop(.33,"rgb(0,0,255)"),w.addColorStop(.49,"rgb(0,255,255)"),w.addColorStop(.67,"rgb(0,255,0)"),w.addColorStop(.84,"rgb(255,255,0)"),w.addColorStop(1,"rgb(255,0,0)"),he.fillStyle=w,he.fillRect(0,0,le.width,le.height),w=he.createLinearGradient(0,0,0,le.height),w.addColorStop(0,"rgba(255,255,255,1)"),w.addColorStop(.5,"rgba(255,255,255,0)"),w.addColorStop(.5,"rgba(0,0,0,0)"),w.addColorStop(1,"rgba(0,0,0,1)"),he.fillStyle=w,he.fillRect(0,0,le.width,le.height)},Je=function(){var w=document.createElement("div");w.className="jcolor-hsl";var P=document.createElement("div");P.className="jcolor-point";var J=document.createElement("div");J.appendChild(le),J.appendChild(P),w.appendChild(J);var me=function(Z,ue,ye){if(Z===1){var Re=w.getBoundingClientRect(),we=ue-Re.left,Ne=ye-Re.top;we<0&&(we=0),Ne<0&&(Ne=0),we>Re.width&&(we=Re.width),Ne>Re.height&&(Ne=Re.height),P.style.left=we+"px",P.style.top=Ne+"px";var Be=he.getImageData(we,Ne,1,1).data;ce=ne(Be[0],Be[1],Be[2])}};return w.addEventListener("mousedown",function(Z){me(Z.buttons,Z.clientX,Z.clientY)}),w.addEventListener("mousemove",function(Z){me(Z.buttons,Z.clientX,Z.clientY)}),w.addEventListener("touchmove",function(Z){me(1,Z.changedTouches[0].clientX,Z.changedTouches[0].clientY)}),w},ce="",Ae=[],X=function(){if(ce!=="")for(var w=0;w<Ae.length;w++){var P=de(ce);P[w]=0;var J="linear-gradient(90deg, rgb(";J+=P.join(", "),J+="), rgb(",P[w]=255,J+=P.join(", "),J+="))",Ae[w].style.backgroundImage=J}},W=function(){var w=document.createElement("div");w.className="jcolor-sliders";var P=document.createElement("div"),J=function(ye){var Re=document.createElement("div");Re.className="jcolor-sliders-input-container";var we=document.createElement("label");we.innerText=ye;var Ne=document.createElement("div");Ne.className="jcolor-sliders-input-subcontainer";var Be=document.createElement("input");Be.type="range",Be.min=0,Be.max=255,Be.value=0,Re.appendChild(we),Ne.appendChild(Be);var Ze=document.createElement("div");return Ze.innerText=Be.value,Be.addEventListener("input",function(){Ze.innerText=Be.value}),Ne.appendChild(Ze),Re.appendChild(Ne),P.appendChild(Re),Be};Ae=[J("Red"),J("Green"),J("Blue")],w.appendChild(P);var me=document.createElement("div");me.className="jcolor-sliders-final-color";var Z=document.createElement("div");Z.style.visibility="hidden",Z.innerText="a",me.appendChild(Z);var ue=function(){var ye=ne(parseInt(Ae[0].value),parseInt(Ae[1].value),parseInt(Ae[2].value));Z.innerText=ye,Z.style.color=ye,Z.style.removeProperty("visibility"),ce=ye};return Ae.forEach(function(ye){ye.addEventListener("input",function(){ue(),X()})}),w.appendChild(me),w},oe=function(){l.setOptions(A),j.tagName=="INPUT"&&(j.classList.add("jcolor-input"),j.readOnly=!0),r=document.createElement("div"),r.className="jcolor",F=document.createElement("div"),F.className="jcolor-backdrop",r.appendChild(F),Q=document.createElement("div"),Q.className="jcolor-content";var w=document.createElement("div");w.className="jcolor-controls",Q.appendChild(w),ee=document.createElement("div"),ee.className="jcolor-reset",ee.innerHTML=l.options.resetLabel,w.appendChild(ee),D=document.createElement("div"),D.className="jcolor-close",D.innerHTML=l.options.doneLabel,w.appendChild(D),I=document.createElement("div"),Q.appendChild(I),B=be(I,{animation:!0,data:[{title:"Grid",contentElement:fe()},{title:"Spectrum",contentElement:Je()},{title:"Sliders",contentElement:W()}],onchange:function(P,J,me){if(me===1)Le();else{var Z=ce!==""?ce:l.getValue();if(me===2&&Z){var ue=de(Z);Ae.forEach(function(ye,Re){ye.value=ue[Re],ye.dispatchEvent(new Event("input"))})}}},palette:"modern"}),r.appendChild(Q),j.tagName=="INPUT"?j.parentNode.insertBefore(r,j.nextSibling):j.appendChild(r),r.addEventListener("click",function(P){if(P.target.tagName=="TD"){var J=P.target.getAttribute("data-value");J&&l.setValue(J)}else P.target.classList.contains("jcolor-reset")?(l.setValue(""),l.close()):P.target.classList.contains("jcolor-close")?(B.getActive()>0&&l.setValue(ce),l.close()):P.target.classList.contains("jcolor-backdrop")?l.close():l.open()}),j.addEventListener("mouseup",function(P){l.open()}),window.addEventListener("resize",function(){r.classList.contains("jcolor-focus")&&B.getActive()==1&&Le()}),l.options.opened==!0&&l.open(),j.change=l.setValue,j.val=function(P){if(P===void 0)return l.getValue();l.setValue(P)},j.color=l,r.color=l};return l.toHex=function(w){var P=function(J){return("0"+parseInt(J).toString(16)).slice(-2)};if(w)return/^#[0-9A-F]{6}$/i.test(w)?w:(w=w.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),w&&w.length?"#"+P(w[1])+P(w[2])+P(w[3]):"")},oe(),l}function xe(){var j=function(A,l){var r={type:"contextmenu"};r.options={};var F={items:null,onclick:null};for(var Q in F)l&&l.hasOwnProperty(Q)?r.options[Q]=l[Q]:r.options[Q]=F[Q];A.classList.add("jcontextmenu"),r.open=function(I,B){if(B&&(r.options.items=B,r.create(B)),j.current&&j.current.close(),u(r,!0),A.classList.add("jcontextmenu-focus"),j.current=r,r.options.items&&r.options.items.length>0||A.children.length){if(I.target)if(I.changedTouches&&I.changedTouches[0])K=I.changedTouches[0].clientX,ne=I.changedTouches[0].clientY;else var K=I.clientX,ne=I.clientY;else var K=I.x,ne=I.y;var ge=A.getBoundingClientRect();if(window.innerHeight<ne+ge.height){var de=ne-ge.height;de<0&&(de=0),A.style.top=de+"px"}else A.style.top=ne+"px";window.innerWidth<K+ge.width?K-ge.width>0?A.style.left=K-ge.width+"px":A.style.left="10px":A.style.left=K+"px"}},r.isOpened=function(){return!!A.classList.contains("jcontextmenu-focus")},r.close=function(){A.classList.contains("jcontextmenu-focus")&&A.classList.remove("jcontextmenu-focus"),u(r,!1)},r.create=function(I){A.innerHTML="";var B=ee();A.appendChild(B);for(var K=0;K<I.length;K++){var ne=D(I[K]);A.appendChild(ne)}};function ee(){var I=document.createElement("div");I.classList.add("header"),I.addEventListener("click",function(ne){ne.preventDefault(),ne.stopPropagation()});var B=document.createElement("a");B.classList.add("title"),B.innerHTML=b.translate("Menu"),I.appendChild(B);var K=document.createElement("a");return K.classList.add("close"),K.innerHTML=b.translate("close"),K.addEventListener("click",function(ne){r.close()}),I.appendChild(K),I}function D(I){if(I.type&&(I.type=="line"||I.type=="divisor"))var B=document.createElement("hr");else{var B=document.createElement("div"),K=document.createElement("a");if(K.innerHTML=I.title,I.tooltip&&B.setAttribute("title",I.tooltip),I.icon&&B.setAttribute("data-icon",I.icon),I.id&&(B.id=I.id),I.disabled?B.className="jcontextmenu-disabled":I.onclick&&(B.method=I.onclick,B.addEventListener("mousedown",function(We){We.preventDefault()}),B.addEventListener("mouseup",function(We){this.method(this,We)})),B.appendChild(K),I.submenu){var ne=document.createElement("span");ne.innerHTML="&#9658;",B.appendChild(ne),B.classList.add("jcontexthassubmenu");var ge=document.createElement("div");ge.classList.add("jcontextmenu"),ge.setAttribute("tabindex","900");for(var de=I.submenu,fe=0;fe<de.length;fe++){var le=D(de[fe]);ge.appendChild(le)}B.appendChild(ge)}else if(I.shortcut){var he=document.createElement("span");he.innerHTML=I.shortcut,B.appendChild(he)}}return B}return typeof r.options.onclick=="function"&&A.addEventListener("click",function(I){r.options.onclick(r,I)}),r.options.items&&r.create(r.options.items),window.addEventListener("mousewheel",function(){r.close()}),A.contextmenu=r,r};return j}var Se=xe();function je(){var j=function(A,l){if(A.dropdown)return A.dropdown.setOptions(l,!0);var r={type:"dropdown"};r.options={};var F=function(X,W){X&&X.length&&(r.options.sortResults!==!1&&(typeof r.options.sortResults=="function"?X.sort(r.options.sortResults):X.sort(Q)),r.setData(X)),typeof r.options.onload=="function"&&r.options.onload(A,r,X,W),W&&D(W),W==null&&(r.options.value=""),A.value=r.options.value,r.options.opened==!0&&r.open()},Q=function(X,W){var oe,w;return typeof X=="string"?oe=X:X.text?oe=X.text:X.name&&(oe=X.name),typeof W=="string"?w=W:W.text?w=W.text:W.name&&(w=W.name),typeof oe=="string"||typeof w=="string"?(typeof oe!="string"&&(oe=""+oe),typeof w!="string"&&(w=""+w),oe.localeCompare(w)):oe-w},ee=function(){r.value={};for(var X=0;X<r.items.length;X++)r.items[X].selected==!0&&(r.items[X].element&&r.items[X].element.classList.remove("jdropdown-selected"),r.items[X].selected=null);r.options.value="",A.value=""},D=function(X){if(ee(),X!==null)if(!X)typeof r.value[""]<"u"&&(r.value[""]="");else{Array.isArray(X)||(X=(""+X).split(";"));for(var W=0;W<X.length;W++)r.value[X[W]]=""}for(var W=0;W<r.items.length;W++)typeof r.value[I(W)]<"u"&&(r.items[W].element&&r.items[W].element.classList.add("jdropdown-selected"),r.items[W].selected=!0,r.value[I(W)]=B(W));r.options.value=Object.keys(r.value).join(";"),r.header.value=r.getText()},I=function(X,W){if(r.options.format)var oe="id";else var oe="value";return r.items[X]?r.items[X].data[oe]:""},B=function(X,W){if(r.options.format)var oe="name";else var oe="text";return r.items[X]?r.items[X].data[oe]:""},K=function(){return Object.keys(r.value)},ne=function(){for(var X=[],W=Object.keys(r.value),oe=0;oe<W.length;oe++)X.push(r.value[W[oe]]);return X};r.setOptions=function(X,W){X||(X={});var oe={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,onsearch:null,onbeforesearch:null,sortResults:!1,autofocus:!1};for(var w in oe)X&&X.hasOwnProperty(w)?r.options[w]=X[w]:(typeof r.options[w]>"u"||W===!0)&&(r.options[w]=oe[w]);return(r.options.remoteSearch==!0||r.options.type==="searchbar")&&(r.options.autocomplete=!0),r.options.newOptions==!0?r.header.classList.add("jdropdown-add"):r.header.classList.remove("jdropdown-add"),r.options.autocomplete==!0?r.header.removeAttribute("readonly"):r.header.setAttribute("readonly","readonly"),r.options.placeholder?r.header.setAttribute("placeholder",r.options.placeholder):r.header.removeAttribute("placeholder"),A.classList.remove("jdropdown-searchbar"),A.classList.remove("jdropdown-picker"),A.classList.remove("jdropdown-list"),r.options.type=="searchbar"?A.classList.add("jdropdown-searchbar"):r.options.type=="list"?A.classList.add("jdropdown-list"):r.options.type=="picker"?A.classList.add("jdropdown-picker"):d.getWindowWidth()<800?r.options.autocomplete?(A.classList.add("jdropdown-searchbar"),r.options.type="searchbar"):(A.classList.add("jdropdown-picker"),r.options.type="picker"):(r.options.width?(A.style.width=r.options.width,A.style.minWidth=r.options.width):(A.style.removeProperty("width"),A.style.removeProperty("min-width")),A.classList.add("jdropdown-default"),r.options.type="default"),r.options.type=="searchbar"?ge.appendChild(le):de.insertBefore(le,de.firstChild),r.options.url&&!X.data?S({url:r.options.url,method:"GET",dataType:"json",success:function(P){P&&F(P,r.options.value)}}):F(r.options.data,r.options.value),r};var ge=null,de=null,fe=null,le=null,he=null,Le=null,We=null,Je=function(){if(l||(l={}),A.tagName=="SELECT"){var X=j.extractFromDom(A,l);A=X.el,l=X.options}!l.placeholder&&A.getAttribute("placeholder")&&(l.placeholder=A.getAttribute("placeholder")),r.value={},r.items=[],r.groups=[],r.search="",r.results=null,A.classList.add("jdropdown"),ge=document.createElement("div"),ge.className="jdropdown-container-header",r.header=document.createElement("input"),r.header.className="jdropdown-header jss_object",r.header.type="text",r.header.setAttribute("autocomplete","off"),r.header.onfocus=function(){typeof r.options.onfocus=="function"&&r.options.onfocus(A)},r.header.onblur=function(){typeof r.options.onblur=="function"&&r.options.onblur(A)},r.header.onkeyup=function(W){r.options.autocomplete==!0&&!We?(r.search!=r.header.value.trim()&&(We=setTimeout(function(){r.find(r.header.value.trim()),We=null},400)),A.classList.contains("jdropdown-focus")||r.open()):r.options.autocomplete||r.next(W.key)},j.hasEvents||(j.hasEvents=!0,document.addEventListener("keydown",j.keydown)),de=document.createElement("div"),de.className="jdropdown-container",fe=document.createElement("div"),fe.className="jdropdown-content",le=document.createElement("div"),le.className="jdropdown-close",le.textContent="Done",he=document.createElement("div"),he.className="jdropdown-reset",he.textContent="x",he.onclick=function(){r.reset(),r.close()},Le=document.createElement("div"),Le.className="jdropdown-backdrop",ge.appendChild(r.header),de.appendChild(fe),A.appendChild(ge),A.appendChild(de),A.appendChild(Le),r.setOptions(l),"ontouchsend"in document.documentElement?A.addEventListener("touchsend",j.mouseup):A.addEventListener("mouseup",j.mouseup),r.options.lazyLoading==!0&&m(fe,{loadUp:r.loadUp,loadDown:r.loadDown}),fe.onwheel=function(W){W.stopPropagation()},A.change=r.setValue,A.val=function(W){if(W===void 0)return r.getValue(!!r.options.multiple);r.setValue(W)},A.dropdown=r};r.getUrl=function(){return r.options.url},r.setUrl=function(X,W){r.options.url=X,S({url:r.options.url,method:"GET",dataType:"json",success:function(oe){r.setData(oe),typeof W=="function"&&W(r)}})},r.setId=function(X,W){if(r.options.format)var oe="id";else var oe="value";typeof X=="object"?X[oe]=W:r.items[X].data[oe]=W},r.add=function(X,W){if(!X){var oe=r.options.autocomplete==!0?r.header.value:"",X=prompt(b.translate("Add A New Option"),oe);if(!X)return!1}if(W||(W=d.guid()),r.options.format)var w={id:W,name:X};else var w={value:W,text:X};if(typeof r.options.onbeforeinsert=="function"){var P=r.options.onbeforeinsert(r,w);if(P===!1)return!1;P&&(w=P)}r.options.data.push(w);var J=r.createItem(w);return fe.appendChild(J.element),typeof r.options.oninsert=="function"&&r.options.oninsert(r,w,J),fe.style.display=="none"&&(fe.style.display=""),r.results&&r.results.push(J),w},r.createItem=function(X,W,oe){r.options.format?(!X.id&&X.value!==void 0&&(X.id=X.value),!X.name&&X.text!==void 0&&(X.name=X.text)):(!X.value&&X.id!==void 0&&(X.value=X.id),!X.text&&X.name!==void 0&&(X.text=X.name));var w={};if(w.element=document.createElement("div"),w.element.className="jdropdown-item",w.element.indexValue=r.items.length,w.data=X,W&&(w.group=W),X.id&&w.element.setAttribute("id",X.id),X.disabled==!0&&w.element.setAttribute("data-disabled",!0),X.tooltip&&w.element.setAttribute("title",X.tooltip),X.image){var P=document.createElement("img");P.className="jdropdown-image",P.src=X.image,X.title||P.classList.add("jdropdown-image-small"),w.element.appendChild(P)}else if(X.icon){var J=document.createElement("span");J.className="jdropdown-icon material-icons",J.innerText=X.icon,X.title||J.classList.add("jdropdown-icon-small"),X.color&&(J.style.color=X.color),w.element.appendChild(J)}else if(X.color){var me=document.createElement("div");me.className="jdropdown-color",me.style.backgroundColor=X.color,w.element.appendChild(me)}if(r.options.format)var Z=X.name;else var Z=X.text;var ue=document.createElement("div");if(ue.className="jdropdown-description",ue.textContent=Z||"&nbsp;",X.title){var ye=document.createElement("div");ye.className="jdropdown-title",ye.innerText=X.title,ue.appendChild(ye)}if(r.options.format)var Re=X.id;else var Re=X.value;return r.value[Re]&&(w.element.classList.add("jdropdown-selected"),w.selected=!0),r.items.push(w),w.element.appendChild(ue),w},r.appendData=function(X){if(X.length){for(var W=[],oe=[],w=0;w<X.length;w++)X[w].group?(oe[X[w].group]||(oe[X[w].group]=[]),oe[X[w].group].push(w)):W.push(w);var P=0,J=Object.keys(oe);if(J.length>0)for(var w=0;w<J.length;w++){var me=document.createElement("div");me.className="jdropdown-group";var Z=document.createElement("div");Z.className="jdropdown-group-name",Z.textContent=J[w];var ue=document.createElement("i");ue.className="jdropdown-group-arrow jdropdown-group-arrow-down",Z.appendChild(ue);var ye=document.createElement("div");ye.className="jdropdown-group-items";for(var Re=0;Re<oe[J[w]].length;Re++){var we=r.createItem(X[oe[J[w]][Re]],me,J[w]);(r.options.lazyLoading==!1||P<200)&&(ye.appendChild(we.element),P++)}me.appendChild(Z),me.appendChild(ye),r.groups.push(me),ye.children.length>0&&fe.appendChild(me)}if(W.length)for(var w=0;w<W.length;w++){var we=r.createItem(X[W[w]]);(r.options.lazyLoading==!1||P<200)&&(fe.appendChild(we.element),P++)}}},r.setData=function(X){if(ee(),fe.textContent="",r.header.value="",r.items=[],X&&X.length){for(var W=0;W<X.length;W++)typeof X[W]!="object"&&(r.options.format?X[W]={id:X[W],name:X[W]}:X[W]={value:X[W],text:X[W]});r.appendData(X),r.options.data=X}else r.options.data=[];r.close()},r.getData=function(){return r.options.data},r.getPosition=function(X){for(var W=0;W<r.items.length;W++)if(I(W)==X)return W;return!1},r.getText=function(X){var W=ne();return X?W:W.join("; ")},r.getValue=function(X){var W=K();return X?W:W.join(";")};var ce=function(X){A.value!=r.options.value&&(A.value=r.options.value,typeof A.oninput=="function"&&A.oninput({type:"input",target:A,value:A.value})),typeof r.options.onchange=="function"&&r.options.onchange(A,r,X,r.options.value)};r.setValue=function(X){var W=r.getValue();Array.isArray(X)&&(X=X.join(";")),W!==X&&(D(X),ce(W))},r.resetSelected=function(){r.setValue(null)},r.selectIndex=function(oe,W){var oe=parseInt(oe);if(r.items&&r.items[oe]&&(W===!0||r.items[oe].data.disabled!==!0))if(r.setCursor(oe,!1),!r.options.multiple)r.items[oe].selected?r.setValue(null):r.setValue(I(oe)),r.close();else{var w=r.options.value;r.items[oe].selected?(r.items[oe].element.classList.remove("jdropdown-selected"),r.items[oe].selected=!1,delete r.value[I(oe)]):(r.items[oe].element.classList.add("jdropdown-selected"),r.items[oe].selected=!0,r.value[I(oe)]=B(oe)),r.options.value=Object.keys(r.value).join(";"),r.options.autocomplete==!1&&(r.header.value=ne().join("; ")),ce(w)}},r.selectItem=function(X){r.selectIndex(X.indexValue)};var Ae=function(X,W){for(var oe=0;oe<W.length;oe++)if(r.options.format){if(W[oe].id==X)return!0}else if(W[oe].value==X)return!0;return!1};return r.find=function(X){if(r.search==X.trim())return!1;if(r.search=X,r.setCursor(),r.groups.length)for(var W=0;W<r.groups.length;W++)r.groups[W].lastChild.textContent="";if(fe.textContent="",r.options.remoteSearch==!0){r.results=null;var oe=r.options.url;let ye={url:oe,method:"GET",data:{q:X},dataType:"json",success:function(Re){r.items=[];var we=Object.keys(r.value);if(we.length)for(var Ne=0;Ne<we.length;Ne++)Ae(we[Ne],Re)||(r.options.format?Re.unshift({id:we[Ne],name:r.value[we[Ne]]}):Re.unshift({value:we[Ne],text:r.value[we[Ne]]}));r.appendData(Re),Re.length?fe.style.display="":fe.style.display="none",typeof r.options.onsearch=="function"&&r.options.onsearch(r,Re)}};if(typeof r.options.onbeforesearch=="function"){let Re=r.options.onbeforesearch(r,ye);if(Re===!1)return;typeof Re=="object"&&(ye=Re)}S(ye)}else{X=new RegExp(X,"gi");for(var w=[],W=0;W<r.items.length;W++){var P=B(W),J=r.items[W].data.title||"",me=r.items[W].data.group||"",Z=r.items[W].data.synonym||"";Z&&(Z=Z.join(" ")),(X==null||r.items[W].selected==!0||P.match(X)||J.match(X)||me.match(X)||Z.match(X))&&w.push(r.items[W])}if(!w.length)fe.style.display="none",r.results=null;else{fe.style.display="",r.results=w;var ue=w.length||0;r.options.lazyLoading==!0&&ue>200&&(ue=200);for(var W=0;W<ue;W++)r.results[W].group?(r.results[W].group.parentNode||fe.appendChild(r.results[W].group),r.results[W].group.lastChild.appendChild(r.results[W].element)):fe.appendChild(r.results[W].element)}}r.options.autofocus==!0&&r.first()},r.open=function(){if(!A.classList.contains("jdropdown-focus")){j.current=r,u(r,!0),A.classList.add("jdropdown-focus"),d.getWindowWidth()<800&&(r.options.type==null||r.options.type=="picker")&&H.slideBottom(de,1),r.options.autocomplete==!0&&(r.header.value=r.search,r.header.focus());var X=K();if(X[0]){var W=r.getPosition(X[0]);W!==!1&&r.setCursor(W)}if(!r.options.type||r.options.type=="default"){var oe=A.getBoundingClientRect(),w=de.getBoundingClientRect();r.options.position?(de.style.position="fixed",window.innerHeight<oe.bottom+w.height?(de.style.top="",de.style.bottom=window.innerHeight-oe.top+1+"px"):(de.style.top=oe.bottom+"px",de.style.bottom=""),de.style.left=oe.left+"px"):window.innerHeight<oe.bottom+w.height?(de.style.top="",de.style.bottom=oe.height+1+"px"):(de.style.top="",de.style.bottom=""),de.style.minWidth=oe.width+"px",r.options.maxWidth&&(de.style.maxWidth=r.options.maxWidth),!r.items.length&&r.options.autocomplete==!0?fe.style.display="none":fe.style.display=""}}typeof r.options.onopen=="function"&&r.options.onopen(A)},r.close=function(X){return A.classList.contains("jdropdown-focus")&&(r.header.value=r.getText(),r.setCursor(),!X&&typeof r.options.onclose=="function"&&r.options.onclose(A),r.header.blur&&r.header.blur(),A.classList.remove("jdropdown-focus"),u(r,!1),j.current=null),r.getValue()},r.setCursor=function(X,W){if(r.currentIndex!=null&&r.items&&r.items[r.currentIndex]&&r.items[r.currentIndex].element.classList.remove("jdropdown-cursor"),X==null)r.currentIndex=null;else if(X=parseInt(X),r.items[X].element.parentNode&&(r.items[X].element.classList.add("jdropdown-cursor"),r.currentIndex=X,W!==!1&&r.items[r.currentIndex].element)){fe.scrollTop;var oe=r.items[r.currentIndex].element;fe.scrollTop=oe.offsetTop-oe.scrollTop+oe.clientTop-95}},r.resetCursor=r.setCursor,r.updateCursor=r.setCursor,r.reset=function(){r.setCursor(),r.setValue(null)},r.first=function(){r.options.lazyLoading===!0&&r.loadFirst();var X=fe.querySelectorAll(".jdropdown-item");if(X.length){var W=X[0].indexValue;r.setCursor(W)}},r.last=function(){r.options.lazyLoading===!0&&r.loadLast();var X=fe.querySelectorAll(".jdropdown-item");if(X.length){var W=X[X.length-1].indexValue;r.setCursor(W)}},r.next=function(X){var W=null;if(X){if(X.length==1){var oe=r.currentIndex||-1;X=X.toLowerCase();var w=null,P=null,J=fe.querySelectorAll(".jdropdown-item");if(J.length){for(var me=0;me<J.length;me++)if(J[me].indexValue>oe&&(w=r.items[J[me].indexValue])&&(P=w.element.innerText[0])&&(P=P.toLowerCase(),X==P)){W=J[me].indexValue;break}r.setCursor(W)}}}else if(r.currentIndex==null||r.currentIndex==null)r.first();else{var Z=r.items[r.currentIndex].element,ue=Z.nextElementSibling;ue?(ue.classList.contains("jdropdown-group")&&(ue=ue.lastChild.firstChild),W=ue.indexValue):Z.parentNode.classList.contains("jdropdown-group-items")&&((ue=Z.parentNode.parentNode.nextElementSibling)&&(ue.classList.contains("jdropdown-group")?ue=ue.lastChild.firstChild:ue.classList.contains("jdropdown-item")?W=ue.indexValue:ue=null),ue&&(W=ue.indexValue)),W!==null&&r.setCursor(W)}},r.prev=function(){var X=null;if(r.currentIndex===null)r.first();else{var W=r.items[r.currentIndex].element,oe=W.previousElementSibling;oe?(oe.classList.contains("jdropdown-group")&&(oe=oe.lastChild.lastChild),X=oe.indexValue):W.parentNode.classList.contains("jdropdown-group-items")&&((oe=W.parentNode.parentNode.previousElementSibling)&&(oe.classList.contains("jdropdown-group")?oe=oe.lastChild.lastChild:oe.classList.contains("jdropdown-item")?X=oe.indexValue:oe=null),oe&&(X=oe.indexValue))}X!==null&&r.setCursor(X)},r.loadFirst=function(){if(r.results)var X=r.results;else var X=r.items;var W=X.length||0;r.options.lazyLoading==!0&&W>200&&(W=200),fe.textContent="";for(var oe=0;oe<W;oe++)X[oe].group?(X[oe].group.parentNode||fe.appendChild(X[oe].group),X[oe].group.lastChild.appendChild(X[oe].element)):fe.appendChild(X[oe].element);fe.scrollTop=0},r.loadLast=function(){if(r.results)var X=r.results;else var X=r.items;var W=X.length;if(W>200){W=W-200,fe.textContent="";for(var oe=W;oe<X.length;oe++)X[oe].group?(X[oe].group.parentNode||fe.appendChild(X[oe].group),X[oe].group.lastChild.appendChild(X[oe].element)):fe.appendChild(X[oe].element);fe.scrollTop=fe.scrollHeight}},r.loadUp=function(){var X=!1;if(r.results)var W=r.results;else var W=r.items;var oe=fe.querySelectorAll(".jdropdown-item"),w=oe[0].indexValue;w=r.items[w];var P=W.indexOf(w)-1;if(P>0){for(var J=0;P>0&&W[P]&&J<200;)W[P].group?(W[P].group.parentNode||fe.insertBefore(W[P].group,fe.firstChild),W[P].group.lastChild.insertBefore(W[P].element,W[P].group.lastChild.firstChild)):fe.insertBefore(W[P].element,fe.firstChild),P--,J++;X=!0}return X},r.loadDown=function(){var X=!1;if(r.results)var W=r.results;else var W=r.items;var oe=fe.querySelectorAll(".jdropdown-item"),w=oe[oe.length-1].indexValue;w=r.items[w];var P=W.indexOf(w)+1;if(P<W.length){for(var J=0;P<W.length&&W[P]&&J<200;)W[P].group?(W[P].group.parentNode||fe.appendChild(W[P].group),W[P].group.lastChild.appendChild(W[P].element)):fe.appendChild(W[P].element),P++,J++;X=!0}return X},Je(),r};return j.keydown=function(A){var l=null;if(l=j.current){if(A.which==13||A.which==9)l.header.value&&l.currentIndex==null&&l.options.newOptions?l.add():(l.currentIndex==null&&l.options.autocomplete==!0&&l.header.value!=""&&l.find(l.header.value),l.selectIndex(l.currentIndex));else if(A.which==38)l.currentIndex==null?l.first():l.currentIndex>0&&l.prev(),A.preventDefault();else if(A.which==40)l.currentIndex==null?l.first():l.currentIndex+1<l.items.length&&l.next(),A.preventDefault();else if(A.which==36)l.first(),A.target.classList.contains("jdropdown-header")||A.preventDefault();else if(A.which==35)l.last(),A.target.classList.contains("jdropdown-header")||A.preventDefault();else if(A.which==27)l.close();else if(A.which==33){if(l.currentIndex==null)l.first();else if(l.currentIndex>0)for(var r=0;r<7;r++)l.prev();A.preventDefault()}else if(A.which==34){if(l.currentIndex==null)l.first();else if(l.currentIndex+1<l.items.length)for(var r=0;r<7;r++)l.next();A.preventDefault()}}},j.mouseup=function(A){var l=d.findElement(A.target,"jdropdown");if(l){var r=l.dropdown;if(A.target.classList.contains("jdropdown-header"))if(l.classList.contains("jdropdown-focus")&&l.classList.contains("jdropdown-default")){var F=l.getBoundingClientRect();if(A.changedTouches&&A.changedTouches[0]){var Q=A.changedTouches[0].clientX;A.changedTouches[0].clientY}else{var Q=A.clientX;A.clientY}F.width-(Q-F.left)<30?A.target.classList.contains("jdropdown-add")?r.add():r.close():r.options.autocomplete==!1&&r.close()}else r.open();else if(A.target.classList.contains("jdropdown-group-name")){var ee=A.target.nextSibling.children;if(A.target.nextSibling.style.display!="none")for(var D=0;D<ee.length;D++)ee[D].style.display!="none"&&r.selectItem(ee[D])}else A.target.classList.contains("jdropdown-group-arrow")?A.target.classList.contains("jdropdown-group-arrow-down")?(A.target.classList.remove("jdropdown-group-arrow-down"),A.target.classList.add("jdropdown-group-arrow-up"),A.target.parentNode.nextSibling.style.display="none"):(A.target.classList.remove("jdropdown-group-arrow-up"),A.target.classList.add("jdropdown-group-arrow-down"),A.target.parentNode.nextSibling.style.display=""):A.target.classList.contains("jdropdown-item")?r.selectItem(A.target):A.target.classList.contains("jdropdown-image")||A.target.classList.contains("jdropdown-description")?r.selectItem(A.target.parentNode):A.target.classList.contains("jdropdown-title")?r.selectItem(A.target.parentNode.parentNode):(A.target.classList.contains("jdropdown-close")||A.target.classList.contains("jdropdown-backdrop"))&&r.close()}},j.extractFromDom=function(A,l){var r=A;if(l||(l={}),A.getAttribute("multiple")&&(!l||l.multiple==null)&&(l.multiple=!0),A.getAttribute("placeholder")&&(!l||l.placeholder==null)&&(l.placeholder=A.getAttribute("placeholder")),A.getAttribute("data-autocomplete")&&(!l||l.autocomplete==null)&&(l.autocomplete=!0),(!l||l.width==null)&&(l.width=A.offsetWidth),A.value&&(!l||l.value==null)&&(l.value=A.value),!l||l.data==null){l.data=[];for(var F=0;F<A.children.length;F++)if(A.children[F].tagName=="OPTGROUP")for(var Q=0;Q<A.children[F].children.length;Q++)l.data.push({value:A.children[F].children[Q].value,text:A.children[F].children[Q].textContent,group:A.children[F].getAttribute("label")});else l.data.push({value:A.children[F].value,text:A.children[F].textContent})}(!l||l.onchange==null)&&(l.onchange=function(D,I,B,K){l.multiple==!0?obj.items[I].classList.contains("jdropdown-selected")?r.options[I].setAttribute("selected","selected"):r.options[I].removeAttribute("selected"):r.value=K});var ee=document.createElement("div");return A.parentNode.insertBefore(ee,A),A.style.display="none",A=ee,{el:A,options:l}},j}var ie=je();function Fe(j,A){if(j.picker)return j.picker.setOptions(A,!0);var l={type:"picker"};l.options={};var r=null,F=null,Q=function(I){return I instanceof Element||I instanceof HTMLDocument},ee=function(){F.innerHTML="";for(var I=Object.keys(l.options.data),B=0;B<I.length;B++){var K=document.createElement("div");K.classList.add("jpicker-item"),K.k=I[B],K.v=l.options.data[I[B]];var ne=l.getLabel(I[B],K);Q(ne)?K.appendChild(ne):K.innerHTML=ne,F.appendChild(K)}};l.setOptions=function(I,B){var K={value:0,data:null,render:null,onchange:null,onmouseover:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,bottom:!1,content:!1,columns:null,grid:null,height:null};I&&I.options&&(I.data=I.options);for(var ne in K)I&&I.hasOwnProperty(ne)?l.options[ne]=I[ne]:(typeof l.options[ne]>"u"||B===!0)&&(l.options[ne]=K[ne]);return l.options.header===!1?r.style.display="none":r.style.display="",l.options.width?r.style.width=parseInt(l.options.width)+"px":r.style.width="",l.options.height?(F.style.maxHeight=l.options.height+"px",F.style.overflow="scroll"):F.style.overflow="",l.options.columns>0&&(l.options.grid?(F.classList.add("jpicker-grid"),F.style.gridTemplateColumns="repeat("+l.options.grid+", 1fr)"):(F.classList.add("jpicker-columns"),F.style.width=l.options.width?l.options.width:36*l.options.columns+"px")),isNaN(parseInt(l.options.value))&&(l.options.value=0),ee(),l.setValue(l.options.value),l},l.getValue=function(){return l.options.value},l.setValue=function(I,B){if(l.setLabel(I),l.options.value=String(I),j.value!=l.options.value&&(j.value=l.options.value,typeof j.oninput=="function"&&j.oninput({type:"input",target:j,value:j.value})),F.children[I]&&F.children[I].getAttribute("type")!=="generic"&&l.close(),B&&typeof l.options.onchange=="function"){var K=l.options.data[I];l.options.onchange(j,l,K,K,I,B)}},l.getLabel=function(I,B){var K=l.options.data[I]||null;return typeof l.options.render=="function"&&(K=l.options.render(K,B)),K},l.setLabel=function(I){var B;l.options.content?B='<i class="material-icons">'+l.options.content+"</i>":B=l.getLabel(I,null),Q(B)?(r.innerHTML="",r.appendChild(B)):r.innerHTML=B},l.open=function(){if(!j.classList.contains("jpicker-focus")){u(l,!0),j.classList.add("jpicker-focus"),j.focus();var I=0,B=0;F.style.marginLeft="";var K=r.getBoundingClientRect(),ne=F.getBoundingClientRect();window.innerHeight<K.bottom+ne.height||l.options.bottom?I=-1*(ne.height+4):I=K.height+4,l.options.right===!0&&(B=-1*ne.width+K.width),ne.left+B<0&&(B=B+ne.left+10),ne.left+ne.width>window.innerWidth&&(B=-1*(10+ne.left+ne.width-window.innerWidth)),F.style.marginTop=parseInt(I)+"px",F.style.marginLeft=parseInt(B)+"px",typeof l.options.onopen=="function"&&l.options.onopen(j,l)}},l.close=function(){j.classList.contains("jpicker-focus")&&(j.classList.remove("jpicker-focus"),u(l,!1),typeof l.options.onclose=="function"&&l.options.onclose(j,l))};var D=function(){j.classList.add("jpicker"),j.setAttribute("tabindex","900"),j.onmousedown=function(I){j.classList.contains("jpicker-focus")||l.open()},r=document.createElement("div"),r.classList.add("jpicker-header"),F=document.createElement("div"),F.classList.add("jpicker-content"),F.onclick=function(I){var B=d.findElement(I.target,"jpicker-item");B&&B.parentNode===F&&l.setValue(B.k,I)},j.appendChild(r),j.appendChild(F),j.value=A.value||0,l.setOptions(A),typeof l.options.onload=="function"&&l.options.onload(j,l),j.change=l.setValue,j.val=function(I){if(I===void 0)return l.getValue();l.setValue(I)},j.picker=l};return D(),l}function $e(j,A){var l={type:"toolbar"};l.options={};var r={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var F in r)A&&A.hasOwnProperty(F)?l.options[F]=A[F]:l.options[F]=r[F];!j&&A.app&&A.app.el&&(j=document.createElement("div"),A.app.el.appendChild(j));var Q=document.createElement("div");Q.classList.add("jtoolbar-item"),Q.classList.add("jtoolbar-arrow");var ee=document.createElement("div");ee.classList.add("jtoolbar-floating"),Q.appendChild(ee),l.selectItem=function(I){for(var B=D.children,K=0;K<B.length;K++)I!=B[K]&&B[K].classList.remove("jtoolbar-selected");I.classList.add("jtoolbar-selected")},l.hide=function(){H.slideBottom(j,0,function(){j.style.display="none"})},l.show=function(){j.style.display="",H.slideBottom(j,1)},l.get=function(){return j},l.setBadge=function(I,B){D.children[I].children[1].firstChild.innerHTML=B},l.destroy=function(){toolbar.remove(),j.innerHTML=""},l.update=function(I,B){for(var K=0;K<D.children.length;K++){var ne=D.children[K];typeof ne.updateState=="function"&&ne.updateState(j,l,ne,I,B)}for(var K=0;K<ee.children.length;K++){var ne=ee.children[K];typeof ne.updateState=="function"&&ne.updateState(j,l,ne,I,B)}},l.create=function(I){D.innerHTML="";for(var B=0;B<I.length;B++){var K=document.createElement("div");if(K.classList.add("jtoolbar-item"),I[B].width&&(K.style.width=parseInt(I[B].width)+"px"),I[B].k&&(K.k=I[B].k),I[B].tooltip&&K.setAttribute("title",I[B].tooltip),I[B].id&&K.setAttribute("id",I[B].id),I[B].updateState&&(K.updateState=I[B].updateState),I[B].active&&K.classList.add("jtoolbar-active"),I[B].disabled&&K.classList.add("jtoolbar-disabled"),I[B].type=="select"||I[B].type=="dropdown")Fe(K,I[B]);else if(I[B].type=="divisor")K.classList.add("jtoolbar-divisor");else if(I[B].type=="label")K.classList.add("jtoolbar-label"),K.innerHTML=I[B].content;else{var ne=document.createElement("i");if(typeof I[B].class>"u")ne.classList.add("material-icons");else for(var ge=I[B].class.split(" "),de=0;de<ge.length;de++)ne.classList.add(ge[de]);if(ne.innerHTML=I[B].content?I[B].content:"",K.appendChild(ne),l.options.badge==!0){var fe=document.createElement("div");fe.classList.add("jbadge");var le=document.createElement("div");le.innerHTML=I[B].badge?I[B].badge:"",fe.appendChild(le),K.appendChild(fe)}if(I[B].title)if(l.options.title==!0){var he=document.createElement("span");he.innerHTML=I[B].title,K.appendChild(he)}else K.setAttribute("title",I[B].title);l.options.app&&I[B].route&&(K.route=I[B].route,K.onclick=function(){l.options.app.pages(this.route)},l.options.app.pages(I[B].route,{toolbarItem:K,closed:!0})),typeof I[B].render=="function"&&I[B].render(K,I[B])}I[B].onclick&&(K.onclick=I[B].onclick.bind(I[B],j,l,K)),D.appendChild(K)}setTimeout(function(){l.refresh()},0)},l.open=function(){Q.classList.add("jtoolbar-arrow-selected"),j.getBoundingClientRect();var I=ee.getBoundingClientRect();I.bottom>window.innerHeight||l.options.bottom?ee.style.bottom="0":ee.style.removeProperty("bottom"),ee.style.right="0",Q.children[0].focus(),u(l,!0)},l.close=function(){Q.classList.remove("jtoolbar-arrow-selected"),u(l,!1)},l.refresh=function(){if(l.options.responsive==!0){var I=j.parentNode.getBoundingClientRect();l.options.maxWidth||(l.options.maxWidth=I.width);var B=parseInt(l.options.maxWidth);for(Q.parentNode&&Q.parentNode.removeChild(Q);ee.firstChild;)D.appendChild(ee.firstChild);if(B<D.offsetWidth)for(B-=50;D.lastChild&&B<D.offsetWidth;)ee.insertBefore(D.lastChild,ee.firstChild);ee.children.length>0&&D.appendChild(Q)}},l.setReadonly=function(I){I=I?"add":"remove",j.classList[I]("jtoolbar-disabled")},j.onclick=function(I){var B=d.findElement(I.target,"jtoolbar-item");B&&l.selectItem(B),I.target.classList.contains("jtoolbar-arrow")&&l.open()},window.addEventListener("resize",function(){l.refresh()}),j.classList.add("jtoolbar"),j.innerHTML="",l.options.container==!0&&j.classList.add("jtoolbar-container");var D=document.createElement("div");return j.appendChild(D),l.options.app&&j.classList.add("jtoolbar-mobile"),l.create(l.options.items),j.toolbar=l,l}function Ue(){var j=function(A,l){var r={type:"editor"};r.options={};var F={url:null,value:"",snippet:null,toolbar:!0,toolbarOnTop:!1,remoteParser:null,placeholder:null,filterPaste:!0,dropZone:!0,dropAsSnippet:!1,acceptImages:!0,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,extensions:null,type:null};for(var Q in F)l&&l.hasOwnProperty(Q)?r.options[Q]=l[Q]:r.options[Q]=F[Q];var ee=null,D=null,I=[];r.el=A,typeof r.options.onclick=="function"&&(A.onclick=function(te){r.options.onclick(A,r,te)}),A.classList.add("jeditor-container");var B=document.createElement("div");B.className="jsnippet",B.setAttribute("contenteditable",!1);var K=document.createElement("div");if(K.className="jeditor-toolbar",r.editor=document.createElement("div"),r.editor.setAttribute("contenteditable",!0),r.editor.setAttribute("spellcheck",!1),r.editor.classList.add("jeditor"),r.options.placeholder&&r.editor.setAttribute("data-placeholder",r.options.placeholder),(r.options.maxHeight||r.options.height)&&(r.editor.style.overflowY="auto",r.options.maxHeight&&(r.editor.style.maxHeight=r.options.maxHeight),r.options.height&&(r.editor.style.height=r.options.height)),r.options.url)S({url:r.options.url,dataType:"html",success:function(te){r.editor.innerHTML=te,j.setCursor(r.editor,r.options.focus=="initial")}});else if(r.options.value)r.editor.innerHTML=r.options.value;else for(var ne=0;ne<A.children.length;ne++)r.editor.appendChild(A.children[ne]);A.innerHTML="";var ge=function(te){typeof r.options.onchange=="function"&&r.options.onchange(A,r,te),r.options.value=r.getData(),A.value!=r.options.value&&(A.value=r.options.value,typeof A.oninput=="function"&&A.oninput({type:"input",target:A,value:A.value}))},de=function(te){var ve=document.createElement("div");ve.innerHTML=te;var Ce=ve.querySelectorAll("img");if(Ce.length)for(var Oe=0;Oe<Ce.length;Oe++)r.addImage(Ce[Oe].src)},fe=function(){var te=null;if(te=B.children[0]){te.classList.contains("jslider-grid")||te.classList.add("jslider-grid");var ve=te.children.length;te.setAttribute("data-number",ve>4?4:ve),ve>4?te.setAttribute("data-total",ve-4):te.removeAttribute("data-total")}},le=function(te){B.innerHTML||r.appendSnippet({}),B.children[0].appendChild(te),fe()};r.appendSnippet=function(te){B.innerHTML="";for(var ve=["image","title","description","host","url"],Ce=0;Ce<ve.length;Ce++){var Oe=document.createElement("div");if(Oe.className="jsnippet-"+ve[Ce],Oe.setAttribute("data-k",ve[Ce]),B.appendChild(Oe),te[ve[Ce]])if(ve[Ce]=="image"){Array.isArray(te.image)||(te.image=[te.image]);for(var tt=0;tt<te.image.length;tt++){var Ke=document.createElement("img");Ke.src=te.image[tt],Oe.appendChild(Ke)}}else Oe.innerHTML=te[ve[Ce]]}r.editor.appendChild(document.createElement("br")),r.editor.appendChild(B)},r.setData=function(te){typeof te=="object"?r.editor.innerHTML=te.content:r.editor.innerHTML=te,r.options.focus&&j.setCursor(r.editor,!0),I=[]},r.getFiles=function(){for(var te=r.editor.querySelectorAll(".jfile"),ve=[],Ce=0;Ce<te.length;Ce++)I[te[Ce].src]&&ve.push(I[te[Ce].src]);return ve},r.getText=function(){return r.editor.innerText},r.getData=function(te){if(te){var ve={content:""};if(B.innerHTML){ve.snippet={};for(var Ce=0;Ce<B.children.length;Ce++){var Oe=B.children[Ce].getAttribute("data-k");if(Oe)if(Oe=="image"){ve.snippet.image||(ve.snippet.image=[]);for(var tt=0;tt<B.children[Ce].children.length;tt++)ve.snippet.image.push(B.children[Ce].children[tt].getAttribute("src"))}else ve.snippet[Oe]=B.children[Ce].innerHTML}}var Ke=Object.keys(I);if(Ke.length){ve.files=[];for(var Ce=0;Ce<Ke.length;Ce++)ve.files.push(I[Ke[Ce]])}var rt=document.createElement("div");rt.innerHTML=r.editor.innerHTML;var at=rt.querySelector(".jsnippet");at&&at.remove();var Ve=rt.innerHTML;Ve=Ve.replace(/<br>/g,`
`),Ve=Ve.replace(/<\/div>/g,`</div>
`),Ve=Ve.replace(/<(?:.|\n)*?>/gm,""),ve.content=Ve.trim(),Ne("getData",ve)}else var ve=r.editor.innerHTML;return ve},r.reset=function(){r.editor.innerHTML="",B.innerHTML="",I=[]},r.addPdf=function(te){if(te.result.substr(0,4)!="data")console.error("Invalid source");else{var ve=document.createElement("canvas");ve.width=60,ve.height=60;var Ce=new Image,Oe=ve.getContext("2d");Oe.drawImage(Ce,0,0,ve.width,ve.height),ve.toBlob(function(tt){var Ke=document.createElement("img");Ke.src=window.URL.createObjectURL(tt),Ke.title=te.name,Ke.className="jfile pdf",I[Ke.src]={file:Ke.src,extension:"pdf",content:te.result},document.execCommand("insertHtml",!1,Ke.outerHTML)})}},r.addImage=function(te,ve){if(te||(te=""),te.substr(0,4)!="data"&&!r.options.remoteParser)console.error("remoteParser not defined in your initialization");else{if(te.substr(0,4)=="data"){var Ce=te.split(";");Ce=Ce[0].split("/"),Ce=Ce[1]}else{var Ce=te.substr(te.lastIndexOf(".")+1);te=r.options.remoteParser+te}var Oe=new Image;Oe.onload=function(){var Ke=document.createElement("canvas");Ke.width=Oe.width,Ke.height=Oe.height;var rt=Ke.getContext("2d");rt.drawImage(Oe,0,0,Ke.width,Ke.height),Ke.toBlob(function(at){var Ve=document.createElement("img");Ve.src=window.URL.createObjectURL(at),Ve.classList.add("jfile"),Ve.setAttribute("tabindex","900"),Ve.setAttribute("width",Oe.width),Ve.setAttribute("height",Oe.height),I[Ve.src]={file:Ve.src,extension:Ce,content:Ke.toDataURL()},r.options.dropAsSnippet||ve?(le(Ve),I[Ve.src].snippet=!0):document.execCommand("insertHtml",!1,Ve.outerHTML),ge()})},Oe.src=te}},r.addFile=function(te){for(var ve=[],Ce=0;Ce<te.length;Ce++)if(te[Ce].size>r.options.maxFileSize)alert("The file is too big");else{var Oe=te[Ce].type.split("/");Oe[0]=="image"?Oe=1:Oe[1]=="pdf"?Oe=2:Oe=0,Oe?(ve[Ce]=new FileReader,ve[Ce].index=Ce,ve[Ce].type=Oe,ve[Ce].name=te[Ce].name,ve[Ce].date=te[Ce].lastModified,ve[Ce].size=te[Ce].size,ve[Ce].addEventListener("load",function(tt){tt.target.type==2?r.options.acceptFiles==!0&&r.addPdf(tt.target):r.addImage(tt.target.result)},!1),ve[Ce].readAsDataURL(te[Ce])):alert("The extension is not allowed")}},r.destroy=function(){r.editor.removeEventListener("mouseup",ye),r.editor.removeEventListener("mousedown",Re),r.editor.removeEventListener("mousemove",we),r.editor.removeEventListener("keyup",Z),r.editor.removeEventListener("keydown",ue),r.editor.removeEventListener("dragstart",W),r.editor.removeEventListener("dragenter",oe),r.editor.removeEventListener("dragover",w),r.editor.removeEventListener("drop",P),r.editor.removeEventListener("paste",X),r.editor.removeEventListener("blur",J),r.editor.removeEventListener("focus",me),A.editor=null,A.classList.remove("jeditor-container"),K.remove(),B.remove(),r.editor.remove()},r.upload=function(){d.click(r.file)};var he=[HTMLUnknownElement,HTMLAudioElement,HTMLEmbedElement,HTMLIFrameElement,HTMLTextAreaElement,HTMLInputElement,HTMLScriptElement],Le=["width","height","align","border","src","tabindex"],We=["color","font-weight","font-size","background","background-color","margin"],Je=function(te){if(te.attributes&&te.attributes.length){var ve=null,Ce=te.getAttribute("style");if(Ce){ve=[];for(var Oe=Ce.split(";"),tt=0;tt<Oe.length;tt++){var Ke=Oe[tt].trim().split(":");if(We.indexOf(Ke[0].trim())>=0){var rt=Ke.shift(),Ke=Ke.join(":");ve.push(rt+":"+Ke)}}}te.tagName.toUpperCase()=="IMG"&&(!r.options.acceptImages||!te.src?te.parentNode.removeChild(te):(te.setAttribute("tabindex","900"),r.addImage(te.src)));for(var at=[],Ve=0;Ve<te.attributes.length;Ve++)at.push(te.attributes[Ve].name);at.length&&at.forEach(function(qe){Le.indexOf(qe)==-1?te.removeAttribute(qe):te.attributes[Ve].value.indexOf("<")!==-1&&te.attributes[Ve].value.replace("<","&#60;")}),te.style="",ve&&ve.length&&te.setAttribute("style",ve.join(";"))}if(te.children.length)for(var Ve=0;Ve<te.children.length;Ve++)Je(te.children[Ve]);he.indexOf(te.constructor)>=0&&te.remove()},ce=function(te){var ve=window.getSelection(),Ce=document.createRange();Ce.selectNode(te),ve.addRange(Ce)},Ae=function(te){te&&(te=te.replace(new RegExp("<!--(.*?)-->","gsi"),""));var ve=new DOMParser,Ce=ve.parseFromString(te,"text/html");Je(Ce);var Oe=document.createElement("span");return Oe.innerHTML=Ce.firstChild.innerHTML,Oe},X=function(te){if(r.options.filterPaste==!0){if(te.clipboardData||te.originalEvent.clipboardData)var ve=(te.originalEvent||te).clipboardData.getData("text/html"),Ce=(te.originalEvent||te).clipboardData.getData("text/plain"),Oe=(te.originalEvent||te).clipboardData.files;else if(window.clipboardData)var ve=window.clipboardData.getData("Html"),Ce=window.clipboardData.getData("Text"),Oe=window.clipboardData.files;if(Oe.length)r.addFile(Oe);else if(!ve)ve=Ce.split(`\r
`),te.target.innerText?(ve=ve.map(function(Ke){return"<div>"+Ke+"</div>"}),document.execCommand("insertHtml",!1,ve.join(""))):ve.map(function(Ke){var rt=document.createElement("div");rt.innerText=Ke,r.editor.appendChild(rt)});else{var tt=Ae(ve);document.execCommand("insertHtml",!1,tt.innerHTML)}te.preventDefault()}},W=function(te){D&&D.e&&te.preventDefault()},oe=function(te){D||r.options.dropZone==!1||(A.classList.add("jeditor-dragging"),te.preventDefault())},w=function(te){D||r.options.dropZone==!1||(ee&&clearTimeout(ee),ee=setTimeout(function(){A.classList.remove("jeditor-dragging")},100),te.preventDefault())},P=function(te){if(!(D||r.options.dropZone==!1)){var ve=null;document.caretRangeFromPoint?ve=document.caretRangeFromPoint(te.clientX,te.clientY):te.rangeParent&&(ve=document.createRange(),ve.setStart(te.rangeParent,te.rangeOffset));var Ce=window.getSelection();Ce.removeAllRanges(),Ce.addRange(ve),Ce.anchorNode.parentNode.focus();var Oe=(te.originalEvent||te).dataTransfer.getData("text/html"),tt=(te.originalEvent||te).dataTransfer.getData("text/plain"),Ke=(te.originalEvent||te).dataTransfer.files;Ke.length?r.addFile(Ke):tt&&de(Oe),A.classList.remove("jeditor-dragging"),te.preventDefault()}},J=function(te){Ne("onevent",te),ge(te),typeof r.options.onblur=="function"&&r.options.onblur(A,r,te)},me=function(te){typeof r.options.onfocus=="function"&&r.options.onfocus(A,r,te)},Z=function(te){r.editor.innerHTML||(r.editor.innerHTML="<div><br></div>"),typeof r.options.onkeyup=="function"&&r.options.onkeyup(A,r,te)},ue=function(te){if(Ne("onevent",te),te.key=="Delete"&&te.target.tagName=="IMG"){var ve=te.target.parentNode;ce(te.target),ve.classList.contains("jsnippet-image")&&fe()}typeof r.options.onkeydown=="function"&&r.options.onkeydown(A,r,te)},ye=function(te){if(D&&D.e&&(D.e.classList.remove("resizing"),D.e.changed==!0)){var ve=D.e.cloneNode();ve.width=parseInt(D.e.style.width)||D.e.getAttribute("width"),ve.height=parseInt(D.e.style.height)||D.e.getAttribute("height"),D.e.style.width="",D.e.style.height="",ce(D.e),document.execCommand("insertHtml",!1,ve.outerHTML)}D=!1},Re=function(te){var ve=function(Ke){var rt=Ke.getBoundingClientRect();rt.width-(te.clientX-rt.left)<40&&te.clientY-rt.top<40&&(Ke.innerHTML="",Ke.remove())};if(te.target.tagName=="IMG")if(te.target.style.cursor){var Ce=te.target.getBoundingClientRect();D={e:te.target,x:te.clientX,y:te.clientY,w:Ce.width,h:Ce.height,d:te.target.style.cursor},te.target.getAttribute("width")||te.target.setAttribute("width",Ce.width),te.target.getAttribute("height")||te.target.setAttribute("height",Ce.height);var Oe=window.getSelection();if(Oe.rangeCount)for(var tt=0;tt<Oe.rangeCount;tt++)Oe.removeRange(Oe.getRangeAt(tt));te.target.classList.add("resizing")}else D=!0;else te.target.classList.contains("jsnippet")?ve(te.target):te.target.parentNode.classList.contains("jsnippet")&&ve(te.target.parentNode),D=!0},we=function(te){if(te.target.tagName=="IMG"&&!te.target.parentNode.classList.contains("jsnippet-image")&&r.options.allowImageResize==!0&&te.target.getAttribute("tabindex")){var ve=te.target.getBoundingClientRect();te.clientY-ve.top<5?ve.width-(te.clientX-ve.left)<5?te.target.style.cursor="ne-resize":te.clientX-ve.left<5?te.target.style.cursor="nw-resize":te.target.style.cursor="n-resize":ve.height-(te.clientY-ve.top)<5?ve.width-(te.clientX-ve.left)<5?te.target.style.cursor="se-resize":te.clientX-ve.left<5?te.target.style.cursor="sw-resize":te.target.style.cursor="s-resize":ve.width-(te.clientX-ve.left)<5?te.target.style.cursor="e-resize":te.clientX-ve.left<5?te.target.style.cursor="w-resize":te.target.style.cursor=""}if(te.which==1&&D&&D.d){if(D.d=="e-resize"||D.d=="ne-resize"||D.d=="se-resize")if(D.e.style.width=D.w+(te.clientX-D.x),te.shiftKey){var Ce=(te.clientX-D.x)*(D.h/D.w);D.e.style.height=D.h+Ce}else var Ce=null;Ce||(D.d=="s-resize"||D.d=="se-resize"||D.d=="sw-resize")&&(te.shiftKey||(D.e.style.height=D.h+(te.clientY-D.y))),D.e.changed=!0}},Ne=function(te,ve){if(r.options.extensions){var Ce=Object.keys(r.options.extensions);if(Ce.length)for(var Oe=0;Oe<Ce.length;Oe++)r.options.extensions[Ce[Oe]]&&typeof r.options.extensions[Ce[Oe]][te]=="function"&&r.options.extensions[Ce[Oe]][te].call(r,ve)}},Be=function(){if(r.options.extensions){var te=Object.keys(r.options.extensions);if(te.length)for(var ve=0;ve<te.length;ve++)r.options.extensions[te[ve]]&&typeof r.options.extensions[te[ve]]=="function"&&(r.options.extensions[te[ve]]=r.options.extensions[te[ve]](A,r))}};if(document.addEventListener("mouseup",ye),document.addEventListener("mousemove",we),r.editor.addEventListener("mousedown",Re),r.editor.addEventListener("keyup",Z),r.editor.addEventListener("keydown",ue),r.editor.addEventListener("dragstart",W),r.editor.addEventListener("dragenter",oe),r.editor.addEventListener("dragover",w),r.editor.addEventListener("drop",P),r.editor.addEventListener("paste",X),r.editor.addEventListener("focus",me),r.editor.addEventListener("blur",J),A.appendChild(r.editor),r.options.snippet&&r.appendSnippet(r.options.snippet),r.options.toolbar){if(Array.isArray(r.options.toolbar))var Ze={container:!0,responsive:!0,items:r.options.toolbar};else if(r.options.toolbar===!0)var Ze={container:!0,responsive:!0,items:[]};else var Ze=r.options.toolbar;Ze.items&&Ze.items.length||(Ze.items=j.getDefaultToolbar(r)),r.options.toolbarOnTop?(A.classList.add("toolbar-on-top"),A.insertBefore(K,A.firstChild)):(r.editor.style.padding="15px",A.appendChild(K)),$e(K,Ze),K.addEventListener("click",function(){r.editor.focus()})}return r.file=document.createElement("input"),r.file.style.display="none",r.file.type="file",r.file.setAttribute("accept","image/*"),r.file.onchange=function(){r.addFile(this.files)},A.appendChild(r.file),r.options.focus&&j.setCursor(r.editor,r.options.focus=="initial"),A.change=r.setData,A.val=function(te){if(te===void 0){var ve=A.getAttribute("data-html")!=="true";return r.getData(ve)}else r.setData(te)},Be(),A.editor=r,typeof r.options.onload=="function"&&r.options.onload(A,r,r.editor),r};return j.setCursor=function(A,l){A.focus(),document.execCommand("selectAll");var r=window.getSelection(),F=r.getRangeAt(0);if(l==!0)var Q=F.startContainer,ee=0;else var Q=F.endContainer,ee=Q.length;F.setStart(Q,ee),F.setEnd(Q,ee),r.removeAllRanges(),r.addRange(F)},j.getDefaultToolbar=function(A){var l=function(F,Q,ee){ee.color||(se(ee,{onchange:function(D,I){ee.k==="color"?document.execCommand("foreColor",!1,I):document.execCommand("backColor",!1,I)}}),ee.color.open())},r=[];return r.push({content:"undo",onclick:function(){document.execCommand("undo")}}),r.push({content:"redo",onclick:function(){document.execCommand("redo")}}),r.push({type:"divisor"}),A.options.toolbarOnTop&&(r.push({type:"select",width:"140px",options:["Default","Verdana","Arial","Courier New"],render:function(F){return'<span style="font-family:'+F+'">'+F+"</span>"},onchange:function(F,Q,ee,D,I){document.execCommand("fontName",!1,D)}}),r.push({type:"select",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(F){return'<span style="font-size:'+F+'">'+F+"</span>"},onchange:function(F,Q,ee,D,I){document.execCommand("fontSize",!1,parseInt(I)+1)}}),r.push({type:"select",options:["format_align_left","format_align_center","format_align_right","format_align_justify"],render:function(F){return'<i class="material-icons">'+F+"</i>"},onchange:function(F,Q,ee,D,I){var B=["JustifyLeft","justifyCenter","justifyRight","justifyFull"];document.execCommand(B[I])}}),r.push({type:"divisor"}),r.push({content:"format_color_text",k:"color",onclick:l}),r.push({content:"format_color_fill",k:"background-color",onclick:l})),r.push({content:"format_bold",onclick:function(F,Q,ee){document.execCommand("bold"),document.queryCommandState("bold")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({content:"format_italic",onclick:function(F,Q,ee){document.execCommand("italic"),document.queryCommandState("italic")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({content:"format_underline",onclick:function(F,Q,ee){document.execCommand("underline"),document.queryCommandState("underline")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({type:"divisor"}),r.push({content:"format_list_bulleted",onclick:function(F,Q,ee){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({content:"format_list_numbered",onclick:function(F,Q,ee){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({content:"format_indent_increase",onclick:function(F,Q,ee){document.execCommand("indent",!0,null),document.queryCommandState("indent")?ee.classList.add("selected"):ee.classList.remove("selected")}}),r.push({content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}),A.options.toolbarOnTop&&(r.push({type:"divisor"}),r.push({content:"photo",onclick:function(){A.upload()}}),r.push({type:"select",content:"table_view",columns:8,grid:8,right:!0,options:["0x0","1x0","2x0","3x0","4x0","5x0","6x0","7x0","0x1","1x1","2x1","3x1","4x1","5x1","6x1","7x1","0x2","1x2","2x2","3x2","4x2","5x2","6x2","7x2","0x3","1x3","2x3","3x3","4x3","5x3","6x3","7x3","0x4","1x4","2x4","3x4","4x4","5x4","6x4","7x4","0x5","1x5","2x5","3x5","4x5","5x5","6x5","7x5","0x6","1x6","2x6","3x6","4x6","5x6","6x6","7x6","0x7","1x7","2x7","3x7","4x7","5x7","6x7","7x7"],render:function(F,Q){Q&&(Q.onmouseover=this.onmouseover,F=F.split("x"),Q.setAttribute("data-x",F[0]),Q.setAttribute("data-y",F[1]));var ee=document.createElement("div");return Q.style.margin="1px",Q.style.border="1px solid #ddd",ee},onmouseover:function(F){for(var Q=parseInt(F.target.getAttribute("data-x")),ee=parseInt(F.target.getAttribute("data-y")),D=0;D<F.target.parentNode.children.length;D++){var I=F.target.parentNode.children[D],B=parseInt(I.getAttribute("data-x")),K=parseInt(I.getAttribute("data-y"));B<=Q&&K<=ee?(I.style.backgroundColor="#cae1fc",I.style.borderColor="#2977ff"):(I.style.backgroundColor="",I.style.borderColor="#ddd")}},onchange:function(F,Q,ee){ee=ee.split("x");for(var D=document.createElement("table"),I=document.createElement("tbody"),B=0;B<=ee[1];B++){for(var K=document.createElement("tr"),ne=0;ne<=ee[0];ne++){var ge=document.createElement("td");ge.innerHTML="",K.appendChild(ge)}I.appendChild(K)}D.appendChild(I),D.setAttribute("width","100%"),D.setAttribute("cellpadding","6"),D.setAttribute("cellspacing","0"),document.execCommand("insertHTML",!1,D.outerHTML)}})),r},j}var He=Ue();function lt(){var j=function(A,l){var r={};r.options={};var F={type:"big",title:"Untitled",width:510,height:472};for(var Q in F)l&&l.hasOwnProperty(Q)?r.options[Q]=l[Q]:r.options[Q]=F[Q];var ee=function(){for(var B=document.createElement("div");A.children[0];)B.appendChild(A.children[0]);for(r.content=document.createElement("div"),r.content.className="jfloating_content",r.content.innerHTML=A.innerHTML;B.children[0];)r.content.appendChild(B.children[0]);r.container=document.createElement("div"),r.container.className="jfloating",r.container.appendChild(r.content),r.options.title?r.container.setAttribute("title",r.options.title):r.container.classList.add("no-title"),r.options.width&&(r.container.style.width=parseInt(r.options.width)+"px"),r.options.height&&(r.container.style.height=parseInt(r.options.height)+"px"),A.innerHTML="",A.appendChild(r.container)},D=function(){r.container&&r.container.addEventListener("click",function(B){var K=B.target.getBoundingClientRect();if(B.target.classList.contains("jfloating")){if(B.changedTouches&&B.changedTouches[0])var ne=B.changedTouches[0].clientX,ge=B.changedTouches[0].clientY;else var ne=B.clientX,ge=B.clientY;K.width-(ne-K.left)<50&&ge-K.top<50?setTimeout(function(){r.close()},100):r.setState()}})},I=function(){r.container.classList.add("jfloating-"+r.options.type)};return r.state={isMinized:!1},r.setState=function(){r.state.isMinized?r.container.classList.remove("jfloating-minimized"):r.container.classList.add("jfloating-minimized"),r.state.isMinized=!r.state.isMinized},r.close=function(){Components.elements.splice(j.elements.indexOf(r.container),1),r.updatePosition(),A.remove()},r.updatePosition=function(){for(var B=0;B<j.elements.length;B++){var K=j.elements[B],ne=j.elements[B-1];K.style.right=B*(ne?ne.offsetWidth:K.offsetWidth)*1.01+"px"}},r.init=function(){ee(),D(),I(),j.elements.push(r.container),r.updatePosition(),A.floating=r},r.init(),r};return j.elements=[],j}var U=lt();function Ee(){const j=function(D){return!isNaN(D)&&D!==null&&D!==""},A={between:function(D,I){return D>=I[0]&&D<=I[1]},"not between":function(D,I){return D<I[0]||D>I[1]},"<":function(D,I){return D<I[0]},"<=":function(D,I){return D<=I[0]},">":function(D,I){return D>I[0]},">=":function(D,I){return D>=I[0]},"=":function(D,I){return D==I[0]},"!=":function(D,I){return D!=I[0]}},l={"valid date":function(){return!0},"=":function(D,I){return D===I[0]},"!=":function(D,I){return D!==I[0]},"<":function(D,I){return D<I[0]},"<=":function(D,I){return D<=I[0]},">":function(D,I){return D>I[0]},">=":function(D,I){return D>=I[0]},between:function(D,I){return D>=I[0]&&D<=I[1]},"not between":function(D,I){return D<I[0]||D>I[1]}},r={contains:function(D,I){return D.includes(I[0])},"not contains":function(D,I){return!D.includes(I[0])},"begins with":function(D,I){return D.startsWith(I[0])},"ends with":function(D,I){return D.endsWith(I[0])},"=":function(D,I){return D===I[0]},"!=":function(D,I){return D!==I[0]},"valid email":function(D){var I=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return I.test(D)},"valid url":function(D){var I=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return I.test(D)}},F=function(D,I){return typeof F[I.type]=="function"?I.allowBlank&&D===""?!0:F[I.type](D,I):null};F.url=function(){var D=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return!!D.test(data)},F.email=function(D){var I=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!!(D&&I.test(D))},F.required=function(D){return!!D.trim()},F.exist=function(D,I){return!!D.toString().trim()},F["not exist"]=function(D,I){return!D.toString().trim()},F.empty=function(D){return!D.toString().trim()},F.notEmpty=function(D){return!!D.toString().trim()},F.number=function(D,I){if(!j(D))return!1;if(!I||!I.criteria)return!0;if(!A[I.criteria])return!1;let B=I.value.map(function(K){return parseFloat(K)});return A[I.criteria](D,B)},F.login=function(D){let I=new RegExp(/^[a-zA-Z0-9._-]+$/);return!!(D&&I.test(D))},F.list=function(D,I){let B=typeof D;if(B!=="string"&&B!=="number")return!1;let K;return typeof I.value[0]=="string"?K=I.value[0].split(","):K=I.value[0],Array.isArray(K)?K.findIndex(function(ge){return ge==D})>-1:!1};const Q=function(){let D=new Date;return D.setHours(0,0,0,0),D},ee={"one year ago":function(){let D=Q();return D.setFullYear(D.getFullYear()-1),D},"one month ago":function(){let D=Q();return D.setMonth(D.getMonth()-1),D},"one week ago":function(){let D=Q();return D.setDate(D.getDate()-7),D},yesterday:function(){let D=Q();return D.setDate(D.getDate()-1),D},today:Q,tomorrow:function(){let D=Q();return D.setDate(D.getDate()+1),D}};return F.date=function(D,I){if(j(D)&&D>0&&D<1e6&&(D=h.numToDate(D)),new Date(D)=="Invalid Date")return!1;if(!I||!I.criteria)return!0;if(!l[I.criteria])return!1;let B=I.value.map(function(K){return typeof K=="string"&&ee[K]?ee[K]().getTime():new Date(K).getTime()});return l[I.criteria](new Date(D).getTime(),B)},F.text=function(D,I){return typeof D!="string"?!1:!I||!I.criteria?!0:r[I.criteria]?r[I.criteria](D,I.value):!1},F.textLength=function(D,I){return D=D.toString(),F.number(D.length,I)},F}var Ye=Ee();function ht(){var j=function(A,l){var r={};r.options={};var F={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(I,B){alert(B)}};for(var Q in F)l&&l.hasOwnProperty(Q)?r.options[Q]=l[Q]:r.options[Q]=F[Q];r.options.validations||(r.options.validations={}),r.options.submitButton||(r.options.submitButton=A.querySelector("input[type=submit]")),r.options.submitButton&&r.options.url&&(r.options.submitButton.onclick=function(){r.save()}),r.options.validations.email||(r.options.validations.email=Ye.email),r.options.validations.length||(r.options.validations.length=Ye.length),r.options.validations.required||(r.options.validations.required=Ye.required),r.setUrl=function(I){r.options.url=I},r.load=function(){S({url:r.options.url,method:"GET",dataType:"json",queue:!0,success:function(I){if(typeof r.options.onbeforeload=="function"){var B=r.options.onbeforeload(A,I);B&&(I=B)}j.setElements(A,I),typeof r.options.onload=="function"&&r.options.onload(A,I)}})},r.save=function(){var I=r.validate();if(I)r.options.onerror(A,I);else{var B=j.getElements(A,!0);if(typeof r.options.onbeforesave=="function"){var B=r.options.onbeforesave(A,B);if(B===!1)return}S({url:r.options.url,method:"POST",dataType:"json",data:B,success:function(K){typeof r.options.onsave=="function"&&r.options.onsave(A,B,K)}})}},r.remove=function(){if(typeof r.options.onbeforeremove=="function"){var I=r.options.onbeforeremove(A,r);if(I===!1)return!1}S({url:r.options.url,method:"DELETE",dataType:"json",success:function(B){typeof r.options.onremove=="function"&&r.options.onremove(A,r,B),r.reset()}})};var ee=function(I){I.classList.add("error"),r.options.submitButton&&r.options.submitButton.setAttribute("disabled",!0);var B=I.getAttribute("data-error")||"There is an error in the form";return I.setAttribute("title",B),B},D=function(I){var B=!1;I.classList.remove("error"),I.removeAttribute("title");for(var K=A.querySelectorAll("input, select, textarea, div[name]"),ne=0;ne<K.length;ne++)K[ne].getAttribute("data-validation")&&K[ne].classList.contains("error")&&(B=!0);r.options.submitButton&&(B?r.options.submitButton.setAttribute("disabled",!0):r.options.submitButton.removeAttribute("disabled"))};return r.validateElement=function(I){var B=!1,K=j.getValue(I),ne=I.getAttribute("data-validation");return typeof r.options.validations[ne]=="function"&&!r.options.validations[ne](K,I)?B=ee(I):I.classList.contains("error")&&D(I),B},r.reset=function(){for(var I=A.querySelectorAll("input, select, textarea, div[name]"),B=0;B<I.length;B++)I[B].getAttribute("name")&&(I[B].type=="checkbox"||I[B].type=="radio"?I[B].checked=!1:typeof I[B].val=="function"?I[B].val(""):I[B].value="")},r.validate=function(){for(var I=[],B=A.querySelectorAll("input, select, textarea, div[name]"),K=0;K<B.length;K++)if(B[K].getAttribute("data-validation")){var ne=r.validateElement(B[K]);ne&&I.push(ne)}return I.length>0?I.join("<br>"):!1},r.getError=function(){return!!r.validation()},r.setHash=function(){return r.getHash(j.getElements(A))},r.getHash=function(I){var B=0,K,ne;if(I.length===0)return B;for(K=0;K<I.length;K++)ne=I.charCodeAt(K),B=(B<<5)-B+ne,B|=0;return B},r.isChanged=function(){var I=r.setHash();return r.options.currentHash!=I},r.resetTracker=function(){r.options.currentHash=r.setHash(),r.options.ignore=!1},r.setIgnore=function(I){r.options.ignore=!!I},setTimeout(function(){r.options.currentHash=r.setHash()},1e3),A.addEventListener("keyup",function(I){I.target.getAttribute("data-validation")&&r.validateElement(I.target)}),j.hasEvents||(window.addEventListener("beforeunload",function(I){if(r.isChanged()&&r.options.ignore==!1){var B=r.options.message?r.options.message:"o/";return B?(typeof I>"u"&&(I=window.event),I&&(I.returnValue=B),B):void 0}}),j.hasEvents=!0),A.form=r,r};return j.getValue=function(A){var l=null;if(A.type=="checkbox")A.checked==!0&&(l=A.value||!0);else if(A.type=="radio")A.checked==!0&&(l=A.value);else if(A.type=="file")l=A.files;else if(A.tagName=="select"&&A.multiple==!0){l=[];for(var r=A.querySelectorAll("options[selected]"),F=0;F<r.length;F++)l.push(r[F].value)}else typeof A.val=="function"?l=A.val():l=A.value||"";return l},j.getElements=function(A,l){for(var r={},F=null,Q=A.querySelectorAll("input, select, textarea, div[name]"),ee=0;ee<Q.length;ee++)(F=Q[ee].getAttribute("name"))&&(r[F]=j.getValue(Q[ee])||"");return l==!0?r:JSON.stringify(r)},j.setElements=function(A,l){for(var r=null,F=null,Q=A.querySelectorAll("input, select, textarea, div[name]"),ee=0;ee<Q.length;ee++){var D=Q[ee].getAttribute("type");if(r=Q[ee].getAttribute("name")){if(r=r.replace(new RegExp(/\[(.*?)\]/ig),".$1"),F=null,r.match(/\./)){var I=g.call(l,r)||"";typeof I<"u"&&(F=I)}else typeof l[r]<"u"&&(F=l[r]);F!==null&&(D=="checkbox"||D=="radio"?Q[ee].checked=!!F:D=="file"||(typeof Q[ee].val=="function"?Q[ee].val(F):Q[ee].value=F))}}},j}var Ie=ht();function Me(){var j=function(){var l=null,r=function(D){if(D.which==27)for(var I=document.querySelectorAll(".jmodal"),B=0;B<I.length;B++)I[B].parentNode.modal.close()},F=function(D){let I=D.composedPath();var B=d.findElement(I[0],"jmodal");if(B){var K=B.getBoundingClientRect();if(D.changedTouches&&D.changedTouches[0])var ne=D.changedTouches[0].clientX,ge=D.changedTouches[0].clientY;else var ne=D.clientX,ge=D.clientY;K.width-(ne-K.left)<50&&ge-K.top<50&&B.parentNode.modal.close()}l&&(l.element.style.cursor="auto",l=null)},Q=function(D){let I=D.composedPath();var B=d.findElement(I[0],"jmodal");if(B){var K=B.getBoundingClientRect();if(D.changedTouches&&D.changedTouches[0])var ne=D.changedTouches[0].clientX,ge=D.changedTouches[0].clientY;else var ne=D.clientX,ge=D.clientY;K.width-(ne-K.left)<50&&ge-K.top<50||ge-K.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),l={left:K.left,top:K.top,x:D.clientX,y:D.clientY,width:K.width,height:K.height,element:B})}},ee=function(D){if(l){if(D=D||window.event,D.buttons)var I=D.buttons;else if(D.button)var I=D.button;else var I=D.which;I?(l.element.style.top=l.top+(D.clientY-l.y)+l.height/2+"px",l.element.style.left=l.left+(D.clientX-l.x)+l.width/2+"px",l.element.style.cursor="move"):l.element.style.cursor="auto"}};document.addEventListener("keydown",r),document.addEventListener("mouseup",F),document.addEventListener("mousedown",Q),document.addEventListener("mousemove",ee)},A=function(l,r){var F={};F.options={};var Q={url:null,onopen:null,onclose:null,onload:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0,icon:null};for(var ee in Q)r&&r.hasOwnProperty(ee)?F.options[ee]=r[ee]:F.options[ee]=Q[ee];!F.options.title&&l.getAttribute("title")&&(F.options.title=l.getAttribute("title"));for(var D=document.createElement("div");l.children[0];)D.appendChild(l.children[0]);for(F.title=document.createElement("div"),F.title.className="jmodal_title",F.options.icon&&F.title.setAttribute("data-icon",F.options.icon),F.content=document.createElement("div"),F.content.className="jmodal_content",F.content.innerHTML=l.innerHTML;D.children[0];)F.content.appendChild(D.children[0]);if(F.container=document.createElement("div"),F.container.className="jmodal",F.container.appendChild(F.title),F.container.appendChild(F.content),F.options.padding&&(F.content.style.padding=F.options.padding),F.options.width&&(F.container.style.width=F.options.width),F.options.height&&(F.container.style.height=F.options.height),F.options.title){var I=document.createElement("h4");I.innerText=F.options.title,F.title.appendChild(I)}if(l.innerHTML="",l.style.display="none",l.appendChild(F.container),F.options.backdrop){var B=document.createElement("div");B.className="jmodal_backdrop",B.onclick=function(){F.close()},l.appendChild(B)}return F.open=function(){l.style.display="block";var K=F.container.getBoundingClientRect();d.getWindowWidth()<K.width?(F.container.style.top="",F.container.style.left="",F.container.classList.add("jmodal_fullscreen"),H.slideBottom(F.container,1)):F.options.backdrop&&(B.style.display="block"),typeof F.options.onopen=="function"&&F.options.onopen(l,F)},F.resetPosition=function(){F.container.style.top="",F.container.style.left=""},F.isOpen=function(){return l.style.display!="none"},F.close=function(){F.isOpen()&&(l.style.display="none",F.options.backdrop&&(B.style.display=""),F.container.classList.remove("jmodal_fullscreen"),typeof F.options.onclose=="function"&&F.options.onclose(l,F))},F.options.url?S({url:F.options.url,method:"GET",dataType:"text/html",success:function(K){F.content.innerHTML=K,F.options.closed||F.open(),typeof F.options.onload=="function"&&F.options.onload(F)}}):(F.options.closed||F.open(),typeof F.options.onload=="function"&&F.options.onload(F)),l.modal=F,j(),j=function(){},F};return A}var Te=Me();function ze(){var j=function(A){var l={};l.options={};var r={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var F in r)A&&A.hasOwnProperty(F)?l.options[F]=A[F]:l.options[F]=r[F];var Q=document.createElement("div");Q.className="jnotification",l.options.error&&Q.classList.add("jnotification-error");var ee=document.createElement("div");ee.className="jnotification-container",Q.appendChild(ee);var D=document.createElement("div");D.className="jnotification-header",ee.appendChild(D);var I=document.createElement("div");if(I.className="jnotification-image",D.appendChild(I),l.options.icon){var B=document.createElement("img");B.src=l.options.icon,I.appendChild(B)}var K=document.createElement("div");if(K.className="jnotification-name",K.innerHTML=l.options.name,D.appendChild(K),l.options.closeable==!0){var ne=document.createElement("div");ne.className="jnotification-close",ne.onclick=function(){l.hide()},D.appendChild(ne)}var ge=document.createElement("div");ge.className="jnotification-date",D.appendChild(ge);var de=document.createElement("div");if(de.className="jnotification-content",ee.appendChild(de),l.options.title){var fe=document.createElement("div");fe.className="jnotification-title",fe.innerHTML=l.options.title,de.appendChild(fe)}var le=document.createElement("div");if(le.className="jnotification-message",le.innerHTML=l.options.message,de.appendChild(le),l.show=function(){document.body.appendChild(Q),d.getWindowWidth()>800?H.fadeIn(Q):H.slideTop(Q,1)},l.hide=function(){d.getWindowWidth()>800?H.fadeOut(Q,function(){Q.parentNode&&(Q.parentNode.removeChild(Q),he&&clearTimeout(he))}):H.slideTop(Q,0,function(){Q.parentNode&&(Q.parentNode.removeChild(Q),he&&clearTimeout(he))})},l.show(),l.options.autoHide==!0)var he=setTimeout(function(){l.hide()},l.options.timeout);return d.getWindowWidth()<800&&Q.addEventListener("swipeup",function(Le){l.hide(),Le.preventDefault(),Le.stopPropagation()}),l};return j.isVisible=function(){var A=document.querySelector(".jnotification");return!!(A&&A.parentNode)},j}var Ge=ze();function Qe(j,A){var l={};l.options={};var r={value:0,onchange:null,width:null};for(var F in r)A&&A.hasOwnProperty(F)?l.options[F]=A[F]:l.options[F]=r[F];j.classList.add("jprogressbar"),j.setAttribute("tabindex",1),j.setAttribute("data-value",l.options.value);var Q=document.createElement("div");Q.style.width=l.options.value+"%",Q.style.color="#fff",j.appendChild(Q),l.options.width&&(j.style.width=l.options.width),l.setValue=function(D){D=parseInt(D),l.options.value=D,Q.style.width=D+"%",j.setAttribute("data-value",D+"%"),D<6?j.style.color="#000":j.style.color="#fff",l.options.value=D,typeof l.options.onchange=="function"&&l.options.onchange(j,D),j.value!=l.options.value&&(j.value=l.options.value,typeof j.oninput=="function"&&j.oninput({type:"input",target:j,value:j.value}))},l.getValue=function(){return l.options.value};var ee=function(D){if(D.which){var I=j.getBoundingClientRect();if(D.changedTouches&&D.changedTouches[0]){var B=D.changedTouches[0].clientX;D.changedTouches[0].clientY}else{var B=D.clientX;D.clientY}l.setValue(Math.round((B-I.left)/I.width*100))}};return"touchstart"in document.documentElement?(j.addEventListener("touchstart",ee),j.addEventListener("touchend",ee)):(j.addEventListener("mousedown",ee),j.addEventListener("mousemove",ee)),j.change=l.setValue,j.val=function(D){if(D===void 0)return l.getValue();l.setValue(D)},j.progressbar=l,l}function ct(j,A){if(j.rating)return j.rating.setOptions(A,!0);var l={};l.options={},l.setOptions=function(F,Q){var ee={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var D in ee)F&&F.hasOwnProperty(D)?l.options[D]=F[D]:(typeof l.options[D]>"u"||Q===!0)&&(l.options[D]=ee[D]);j.innerHTML="";for(var I=0;I<l.options.number;I++){var B=document.createElement("div");B.setAttribute("data-index",I+1),B.setAttribute("title",l.options.tooltip[I]),j.appendChild(B)}if(l.options.value)for(var I=0;I<l.options.number;I++)I<l.options.value&&j.children[I].classList.add("jrating-selected");return l},l.setValue=function(F){for(var Q=0;Q<l.options.number;Q++)Q<F?j.children[Q].classList.add("jrating-selected"):(j.children[Q].classList.remove("jrating-over"),j.children[Q].classList.remove("jrating-selected"));l.options.value=F,typeof l.options.onchange=="function"&&l.options.onchange(j,F),j.value!=l.options.value&&(j.value=l.options.value,typeof j.oninput=="function"&&j.oninput({type:"input",target:j,value:j.value}))},l.getValue=function(){return l.options.value};var r=function(){l.setOptions(A),j.classList.add("jrating"),j.addEventListener("click",function(F){var Q=F.target.getAttribute("data-index");Q!=null&&(Q==l.options.value?l.setValue(0):l.setValue(Q))}),j.addEventListener("mouseover",function(F){for(var Q=F.target.getAttribute("data-index"),ee=0;ee<l.options.number;ee++)ee<Q?j.children[ee].classList.add("jrating-over"):j.children[ee].classList.remove("jrating-over")}),j.addEventListener("mouseout",function(F){for(var Q=0;Q<l.options.number;Q++)j.children[Q].classList.remove("jrating-over")}),j.change=l.setValue,j.val=function(F){if(F===void 0)return l.getValue();l.setValue(F)},j.rating=l};return r(),l}function it(j,A){if(j.search)return j.search;var l=null,r=function(B){if(B.target.classList.contains("jsearch_item"))var K=B.target;else var K=B.target.parentNode;D.selectIndex(K),B.preventDefault()},F=function(B){if(typeof D.options.onsearch=="function"){var K=D.options.onsearch(D,B);K&&(B=K)}if(I.innerHTML="",!B.length)j.style.display="";else{j.style.display="block";for(var ne=B.length<11?B.length:10,ge=0;ge<ne;ge++){if(typeof B[ge]=="string")var de=B[ge],fe=B[ge];else{var de=B[ge].text;!de&&B[ge].name&&(de=B[ge].name);var fe=B[ge].value;!fe&&B[ge].id&&(fe=B[ge].id)}var le=document.createElement("div");le.setAttribute("data-value",fe),le.setAttribute("data-text",de),le.className="jsearch_item",B[ge].id&&le.setAttribute("id",B[ge].id),D.options.forceSelect&&ge==0&&le.classList.add("selected");var he=document.createElement("img");B[ge].image?he.src=B[ge].image:he.style.display="none",le.appendChild(he);var Le=document.createElement("div");Le.innerHTML=de,le.appendChild(Le),I.appendChild(le)}}},Q=function(B){if(B!=D.terms)if(D.terms=B,D.options.forceSelect?l=0:l=null,Array.isArray(D.options.data)){var K=function(ge){if(typeof ge=="string"){if((""+ge).toLowerCase().search(B.toLowerCase())>=0)return!0}else for(var de in ge){var fe=ge[de];if((""+fe).toLowerCase().search(B.toLowerCase())>=0)return!0}return!1},ne=D.options.data.filter(function(ge){return K(ge)});F(ne)}else S({url:D.options.data+B,method:"GET",dataType:"json",success:function(ge){F(ge)}})},ee=null,D=function(B){ee&&clearTimeout(ee),ee=setTimeout(function(){Q(B)},500)};A.forceSelect===null&&(A.forceSelect=!0),D.options={data:A.data||null,input:A.input||null,searchByNode:A.searchByNode||null,onselect:A.onselect||null,forceSelect:A.forceSelect,onsearch:A.onsearch||null,onbeforesearch:A.onbeforesearch||null},D.selectIndex=function(B){var K=B.getAttribute("id"),ne=B.getAttribute("data-text"),ge=B.getAttribute("data-value"),de=B.children[0].src||"";typeof D.options.onselect=="function"&&D.options.onselect(D,ne,ge,K,de),D.close()},D.open=function(){j.style.display="block"},D.close=function(){ee&&clearTimeout(ee),D.terms="",I.innerHTML="",j.style.display=""},D.isOpened=function(){return!!j.style.display},D.keydown=function(B){D.isOpened()&&(B.key=="Enter"?l!==null&&I.children[l]?(D.selectIndex(I.children[l]),B.preventDefault()):D.close():B.key==="ArrowUp"?(l!==null&&I.children[0]&&(I.children[l].classList.remove("selected"),!D.options.forceSelect&&l===0?l=null:(l=Math.max(0,l-1),I.children[l].classList.add("selected"))),B.preventDefault()):B.key==="ArrowDown"&&(l==null?l=-1:I.children[l].classList.remove("selected"),l<9&&I.children[l+1]&&l++,I.children[l].classList.add("selected"),B.preventDefault()))},D.keyup=function(B){if(!D.options.searchByNode&&D.options.input)if(D.options.input.tagName==="DIV")var K=D.options.input.innerText;else var K=D.options.input.value;else{var ne=d.getNode();if(ne)var K=ne.innerText}if(typeof D.options.onbeforesearch=="function"){var ge=D.options.onbeforesearch(D,K);if(ge)K=ge;else if(ge===!1)return}D(K)},D.blur=function(B){D.close()},D.options.input&&(D.options.input.addEventListener("keyup",D.keyup),D.options.input.addEventListener("keydown",D.keydown),D.options.input.addEventListener("blur",D.blur));var I=document.createElement("div");return I.classList.add("jsearch_container"),I.onmousedown=r,j.appendChild(I),j.classList.add("jsearch"),j.search=D,D}function dt(j,A){var l={};if(l.options={},l.currentImage=null,A&&(l.options=A),j.setAttribute("tabindex","900"),l.options.items=[],!j.classList.contains("jslider")){if(j.classList.add("jslider"),j.classList.add("unselectable"),l.options.height&&(j.style.minHeight=parseInt(l.options.height)+"px"),l.options.width&&(j.style.width=parseInt(l.options.width)+"px"),l.options.grid){j.classList.add("jslider-grid");var r=j.children.length;r>4&&j.setAttribute("data-total",r-4),j.setAttribute("data-number",r>4?4:r)}var F=document.createElement("div");if(F.classList.add("jslider-counter"),j.children.length>0)for(var Q=0;Q<j.children.length;Q++){l.options.items.push(j.children[Q]);var ee=document.createElement("div");ee.onclick=function(){var ne=Array.prototype.slice.call(F.children).indexOf(this);l.show(l.currentImage=l.options.items[ne])},F.appendChild(ee)}var D=document.createElement("div");D.className="jslider-caption";var I=document.createElement("div"),B=document.createElement("div");B.className="jslider-close",B.innerHTML="",B.onclick=function(){l.close()},I.appendChild(D),I.appendChild(B)}l.updateCounter=function(ne){for(var ge=0;ge<F.children.length;ge++)if(F.children[ge].classList.contains("jslider-counter-focus")){F.children[ge].classList.remove("jslider-counter-focus");break}F.children[ne].classList.add("jslider-counter-focus")},l.show=function(ne){if(!ne)var ne=j.children[0];j.classList.add("jslider-focus"),j.classList.remove("jslider-grid"),j.appendChild(I),j.appendChild(F);var ge=l.options.items.indexOf(ne);l.updateCounter(ge);for(var de=0;de<j.children.length;de++)j.children[de].style.display="";ne.style.display="block",ne.previousElementSibling?j.classList.add("jslider-left"):j.classList.remove("jslider-left"),ne.nextElementSibling&&ne.nextElementSibling.tagName=="IMG"?j.classList.add("jslider-right"):j.classList.remove("jslider-right"),l.currentImage=ne,l.currentImage.offsetHeight>l.currentImage.offsetWidth&&l.currentImage.classList.add("jslider-vertical"),I.children[0].innerText=l.currentImage.getAttribute("title")},l.open=function(){l.show(),typeof l.options.onopen=="function"&&l.options.onopen(j)},l.close=function(){j.classList.remove("jslider-focus"),j.classList.remove("jslider-left"),j.classList.remove("jslider-right"),l.options.grid&&j.classList.add("jslider-grid");for(var ne=0;ne<j.children.length;ne++)j.children[ne].style.display="";F.remove(),I.remove(),l.currentImage=null,typeof l.options.onclose=="function"&&l.options.onclose(j)},l.reset=function(){j.innerHTML=""},l.next=function(){var ne=l.currentImage.nextElementSibling;ne&&ne.tagName==="IMG"&&l.show(l.currentImage.nextElementSibling)},l.prev=function(){l.currentImage.previousElementSibling&&l.show(l.currentImage.previousElementSibling)};var K=function(ne){if(ne.target.tagName=="IMG")l.show(ne.target);else if(!ne.target.classList.contains("jslider-close")&&!(ne.target.parentNode.classList.contains("jslider-counter")||ne.target.classList.contains("jslider-counter"))){var ge=ne.offsetX||ne.changedTouches[0].clientX;ne.target.clientWidth-ge<40?l.next():ge<40&&l.prev()}};return"ontouchend"in document.documentElement?j.addEventListener("touchend",K):j.addEventListener("mouseup",K),j.addEventListener("swipeleft",function(ne){l.next(),ne.preventDefault(),ne.stopPropagation()}),j.addEventListener("swiperight",function(ne){l.prev(),ne.preventDefault(),ne.stopPropagation()}),j.addEventListener("keydown",function(ne){ne.which==27&&l.close()}),j.slider=l,l}function jt(j,A){if(j.tags)return j.tags.setOptions(A,!0);var l={type:"tags"};l.options={};var r=function(){return!!(l.options.limit&&j.children.length>=l.options.limit)},F=null,Q=null;l.setOptions=function(ce,Ae){var X={value:"",limit:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null};for(var W in X)ce&&ce.hasOwnProperty(W)?l.options[W]=ce[W]:(typeof l.options[W]>"u"||Ae===!0)&&(l.options[W]=X[W]);return l.options.placeholder?j.setAttribute("data-placeholder",l.options.placeholder):j.removeAttribute("data-placeholder"),j.placeholder=l.options.placeholder,l.setValue(l.options.value),B(),l.options.search?Q||(Q=document.createElement("div"),j.parentNode.insertBefore(Q,j.nextSibling),F=it(Q,{data:l.options.search,onselect:function(oe,w,P){l.selectIndex(w,P)}})):Q&&(F=null,Q.remove(),Q=null),l},l.add=function(ce,Ae){if(typeof l.options.onbeforechange=="function"){var X=l.options.onbeforechange(j,l,l.options.value,ce);if(X===!1)return!1;X!=null&&(ce=X)}if(F&&F.close(),r())typeof l.options.onlimit=="function"?l.options.onlimit(l,l.options.limit):alert(b.translate("You reach the limit number of entries")+" "+l.options.limit);else{var W=d.getNode();if(W&&W.parentNode&&W.parentNode.classList.contains("jtags")&&W.nextSibling&&!(W.nextSibling.innerText&&W.nextSibling.innerText.trim()))oe=W.nextSibling;else{if(j.lastChild&&(j.lastChild.innerText.trim()||j.removeChild(j.lastChild)),!ce||typeof ce=="string")var oe=D(ce,ce,W);else for(var w=0;w<=ce.length;w++)if(!r()){if(!ce[w]||typeof ce[w]=="string")var P=ce[w]||"",J=null;else var P=ce[w].text,J=ce[w].value;var oe=D(P,J)}I()}Ae&&ee(oe)}},l.setLimit=function(ce){for(l.options.limit=ce,j.children.length-ce;j.children.length>ce;)j.removeChild(j.lastChild)},l.remove=function(ce){ce.parentNode.removeChild(ce),j.children.length?I():l.add("",!0)},l.getData=function(){for(var ce=[],Ae=0;Ae<j.children.length;Ae++){var X=j.children[Ae].innerText.replace(`
`,""),W=j.children[Ae].getAttribute("data-value");W||(W=X),(X||W)&&ce.push({text:X,value:W})}return ce},l.getValue=function(ce){var Ae=null;if(ce!=null)Ae=j.children[ce].getAttribute("data-value"),Ae||(Ae=j.children[ce].innerText.replace(`
`,""));else{for(var X=[],W=0;W<j.children.length;W++)Ae=j.children[W].innerText.replace(`
`,""),Ae&&X.push(l.getValue(W));Ae=X.join(",")}return Ae},l.setValue=function(ce){if(!ce)l.reset();else if(j.value!=ce)if(Array.isArray(ce))l.add(ce);else{var Ae=(""+ce).trim(),X=ne(Ae);j.innerHTML="",l.add(X)}},l.reset=function(){j.classList.add("jtags-empty"),j.innerHTML="<div></div>",I()},l.isValid=function(){for(var ce=0,Ae=0;Ae<j.children.length;Ae++)j.children[Ae].classList.contains("jtags_error")&&ce++;return ce==0},l.selectIndex=function(ce,Ae){var X=d.getNode();X&&(X.innerText=ce,Ae&&X.setAttribute("data-value",Ae),X.classList.remove("jtags_error"),r()||l.add("",!0))},l.search=function(ce){ce.innerText},l.destroy=function(){j.removeEventListener("mouseup",he),j.removeEventListener("keydown",de),j.removeEventListener("keyup",fe),j.removeEventListener("paste",le),j.removeEventListener("focus",Le),j.removeEventListener("blur",We),j.parentNode.removeChild(j)};var ee=function(ce){if(j.children.length){var Ae=document.createRange(),X=window.getSelection();if(!ce)var ce=j.childNodes[j.childNodes.length-1];Ae.setStart(ce,ce.length),Ae.collapse(!0),X.removeAllRanges(),X.addRange(Ae),j.scrollLeft=j.scrollWidth}},D=function(ce,Ae,X){var W=document.createElement("div");return W.innerHTML=ce||"",Ae&&W.setAttribute("data-value",Ae),X&&X.parentNode.classList.contains("jtags")?j.insertBefore(W,X.nextSibling):j.appendChild(W),W},I=function(){var ce=l.getValue();ce!=l.options.value&&(l.options.value=ce,typeof l.options.onchange=="function"&&l.options.onchange(j,l,l.options.value),j.value!=l.options.value&&(j.value=l.options.value,typeof j.oninput=="function"&&j.oninput({type:"input",target:j,value:j.value}))),B()},B=function(){for(var ce=0;ce<j.children.length;ce++)j.children[ce].tagName==="DIV"&&(l.getValue(ce)?(j.children[ce].classList.add("jtags_label"),typeof l.options.validation=="function"&&l.getValue(ce)?l.options.validation(j.children[ce],j.children[ce].innerText,j.children[ce].getAttribute("data-value"))?j.children[ce].classList.remove("jtags_error"):j.children[ce].classList.add("jtags_error"):j.children[ce].classList.remove("jtags_error")):j.children[ce].classList.remove("jtags_label"));K()},K=function(){j.innerText.trim()?j.classList.remove("jtags-empty"):(!j.children.length||j.children[0].tagName==="BR")&&(j.innerHTML="",ee(D()))},ne=function(ce){var Ae=[],X="";if(ce=ce.trim(),ce){for(var W=0;W<ce.length;W++)ce[W]==","||ce[W]==";"||ce[W]==`
`?X&&(Ae.push(X.trim()),X=""):X+=ce[W];X&&Ae.push(X)}return Ae},ge=0,de=function(ce){if(ge=window.getSelection().anchorOffset,K(),ce.key==="Tab"||ce.key===";"||ce.key===","){var Ae=window.getSelection().anchorOffset;Ae>1&&(r()?typeof l.options.onlimit=="function"&&l.options.onlimit(l,l.options.limit):l.add("",!0)),ce.preventDefault()}else if(ce.key=="Enter"){if(!F||!F.isOpened()){var Ae=window.getSelection().anchorOffset;Ae>1&&(r()||l.add("",!0)),ce.preventDefault()}}else ce.key=="Backspace"&&j.children.length==1&&window.getSelection().anchorOffset<1&&ce.preventDefault();F&&F.keydown(ce),K()},fe=function(ce){if(ce.which==39){var Ae=window.getSelection().anchorOffset;Ae>1&&Ae==ge&&l.add("",!0)}else ce.which==13||ce.which==38||ce.which==40?ce.preventDefault():F&&F.keyup(ce);B()},le=function(ce){if(ce.clipboardData||ce.originalEvent.clipboardData)var Ae=(ce.originalEvent||ce).clipboardData.getData("text/plain");else if(window.clipboardData)var Ae=window.clipboardData.getData("Text");var X=ne(Ae);if(typeof l.options.onbeforepaste=="function"){var W=l.options.onbeforepaste(j,l,X);if(W===!1)return ce.preventDefault(),!1;W&&(X=W)}X.length>1?(l.add(X,!0),ce.preventDefault()):X[0]&&(document.execCommand("insertText",!1,X[0]),ce.preventDefault())},he=function(ce){if(ce.target.parentNode&&ce.target.parentNode.classList.contains("jtags")&&(ce.target.classList.contains("jtags_label")||ce.target.classList.contains("jtags_error"))){var Ae=ce.target.getBoundingClientRect();Ae.width-(ce.clientX-Ae.left)<16&&l.remove(ce.target)}ce.target==j&&ee()},Le=function(){j.classList.contains("jtags-focus")||((!j.children.length||l.getValue(j.children.length-1))&&(r()||D("")),typeof l.options.onfocus=="function"&&l.options.onfocus(j,l,l.getValue()),j.classList.add("jtags-focus"))},We=function(){if(j.classList.contains("jtags-focus")){F&&F.close();for(var ce=0;ce<j.children.length-1;ce++)l.getValue(ce)||j.removeChild(j.children[ce]);I(),j.classList.remove("jtags-focus"),typeof l.options.onblur=="function"&&l.options.onblur(j,l,l.getValue())}},Je=function(){"touchend"in document.documentElement?j.addEventListener("touchend",he):j.addEventListener("mouseup",he),j.addEventListener("keydown",de),j.addEventListener("keyup",fe),j.addEventListener("paste",le),j.addEventListener("focus",Le),j.addEventListener("blur",We),j.setAttribute("contenteditable",!0),j.classList.add("jtags"),l.setOptions(A),typeof l.options.onload=="function"&&l.options.onload(j,l),j.change=l.setValue,j.val=function(ce){if(ce===void 0)return l.getValue();l.setValue(ce)},j.tags=l};return Je(),l}function mt(j,A){var l={};l.options={};var r={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null};for(var F in r)A&&A.hasOwnProperty(F)?l.options[F]=A[F]:l.options[F]=r[F];l.options.multiple==!0&&j.setAttribute("data-multiple",!0),j.content=[],j.classList.add("jupload"),l.options.input==!0&&j.classList.add("input"),l.add=function(I){if(l.options.multiple==!1&&(j.content=[],j.innerText=""),l.options.type=="image"){var B=document.createElement("img");B.setAttribute("src",I.file),B.setAttribute("tabindex",-1),j.getAttribute("name")||(B.className="jfile",B.content=I),j.appendChild(B)}else{if(I.name)var K=I.name;else var K=I.file;var ne=document.createElement("div");ne.innerText=K||l.options.type,ne.classList.add("jupload-item"),ne.setAttribute("tabindex",-1),j.appendChild(ne)}I.content&&(I.file=d.guid()),j.content.push(I),typeof l.options.onchange=="function"&&l.options.onchange(j,I)},l.addFromFile=function(I){var B=I.type.split("/");if(B[0]==l.options.type){var K=new FileReader;K.addEventListener("load",function(ne){var ge={file:ne.srcElement.result,extension:I.name.substr(I.name.lastIndexOf(".")+1),name:I.name,size:I.size,lastmodified:I.lastModified,content:ne.srcElement.result};l.add(ge)}),K.readAsDataURL(I)}else alert(b.translate("This extension is not allowed"))},l.addFromUrl=function(I){if(I.substr(0,4)!="data"&&!l.options.remoteParser)console.error("remoteParser not defined in your initialization");else if(I.substr(0,4)=="data"){var B=I.split(";");B=B[0].split("/");var K=B[0].replace("data:","");if(K==l.options.type){var ne={file:I,name:"",extension:B[1],content:I};l.add(ne)}else alert(l.options.text.extensionNotAllowed)}else{var B=I.substr(I.lastIndexOf(".")+1);I=l.options.remoteParser+I,S({url:I,type:"GET",dataType:"blob",success:function(de){}})}};var Q=l.options.type+"/"+l.options.extension,ee=document.createElement("input");ee.type="file",ee.setAttribute("accept",Q),ee.onchange=function(){for(var I=0;I<this.files.length;I++)l.addFromFile(this.files[I])},l.options.multiple==!0&&ee.setAttribute("multiple",!0);var D=null;return j.addEventListener("click",function(I){D=null,!j.children.length||I.target===j?d.click(ee):I.target.parentNode==j&&(D=I.target)}),j.addEventListener("dblclick",function(I){d.click(ee)}),j.addEventListener("dragenter",function(I){j.style.border="1px dashed #000"}),j.addEventListener("dragleave",function(I){j.style.border="1px solid #eee"}),j.addEventListener("dragstop",function(I){j.style.border="1px solid #eee"}),j.addEventListener("dragover",function(I){I.preventDefault()}),j.addEventListener("keydown",function(I){if(D&&I.which==46){var B=Array.prototype.indexOf.call(j.children,D);B>=0&&(j.content.splice(B,1),D.remove(),D=null)}}),j.addEventListener("drop",function(I){I.preventDefault(),I.stopPropagation();var B=(I.originalEvent||I).dataTransfer.getData("text/html"),K=(I.originalEvent||I).dataTransfer.files;if(K.length)for(var ne=0;ne<I.dataTransfer.files.length;ne++)l.addFromFile(I.dataTransfer.files[ne]);else if(B){l.options.multiple==!1&&(j.innerText="");var ge=document.createElement("div");ge.innerHTML=B;var de=ge.querySelectorAll("img");if(de.length)for(var ne=0;ne<de.length;ne++)l.addFromUrl(de[ne].src)}return j.style.border="1px solid #eee",!1}),j.val=function(I){if(I===void 0)return j.content&&j.content.length?j.content:null;if(j.innerText="",j.content=[],I)if(Array.isArray(I))for(var B=0;B<I.length;B++)typeof I[B]=="string"?l.add({file:I[B]}):l.add(I[B]);else typeof I=="string"&&l.add({file:I})},j.upload=j.image=l,l}var Rt=k(195),Dt=k.n(Rt),ft={...b,...d,version:"5.0.24",setExtensions:function(j){if(typeof j=="object")for(var A=Object.keys(j),l=0;l<A.length;l++)ft[A[l]]=j[A[l]]},tracking:u,path:g,sorting:v,lazyLoading:m,ajax:S,animation:H,calendar:G,color:se,contextmenu:Se,dropdown:ie,editor:He,floating:U,form:Ie,mask:M,modal:Te,notification:Ge,palette:ae,picker:Fe,progressbar:Qe,rating:ct,search:it,slider:dt,tabs:be,tags:jt,toolbar:$e,upload:mt,validations:Ye};ft.image=mt,ft.image.create=function(j){var A=document.createElement("img");return A.setAttribute("src",j.file),A.className="jfile",A.setAttribute("tabindex",-1),A.content=j,A},ft.tracker=Ie,ft.loading=H.loading,ft.sha512=Dt();const Nt=function(){document.jsuitesComponents=[];const j=function(le,he){return le[he.type]&&le[he.type]==he||le.component&&le.component==he?!0:le.parentNode?j(le.parentNode,he):!1},A=function(le){if(document.jsuitesComponents&&document.jsuitesComponents.length>0)for(var he=0;he<document.jsuitesComponents.length;he++)document.jsuitesComponents[he]&&!j(le,document.jsuitesComponents[he])&&document.jsuitesComponents[he].close()};let l=15,r=null,F=!1,Q={x:null,y:null},ee=document.createElement("div");ee.classList.add("jtooltip");const D=function(le){var he=ft.findElement(le.target,"jpanel");if(he&&!he.classList.contains("readonly")){he.focus();var Le=le.target.getBoundingClientRect();F={e:he,x:le.clientX,y:le.clientY,w:Le.width,h:Le.height,d:he.style.cursor,resizing:!!he.style.cursor,actioned:!1},he.style.width||(he.style.width=Le.width+"px"),he.style.height||(he.style.height=Le.height+"px");var We=window.getSelection();if(We.rangeCount)for(var Je=0;Je<We.rangeCount;Je++)We.removeRange(We.getRangeAt(Je));le.preventDefault(),le.stopPropagation()}else F=!1;if(le.changedTouches&&le.changedTouches[0])var ce=le.changedTouches[0].clientX,Ae=le.changedTouches[0].clientY;else var ce=le.clientX,Ae=le.clientY;var X=le.path||le.composedPath&&le.composedPath();if(X)r=X[0];else{if(le.target&&le.target.shadowRoot)var W=le.target.shadowRoot;else var W=document;r=W.elementFromPoint(ce,Ae)}A(r)},I=function(le){F&&F.e&&(typeof F.e.refresh=="function"&&Q.actioned&&F.e.refresh(),F.e.style.cursor=""),Q={x:null,y:null},F=!1},B=function(le){if(F){var he=le.clientX||le.pageX,Le=le.clientY||le.pageY;if(F.resizing){var X=null,W=null;if(F.d=="e-resize"||F.d=="ne-resize"||F.d=="se-resize")if(X=F.w+(he-F.x),F.e.style.width=X+"px",le.shiftKey){var oe=(he-F.x)*(F.h/F.w);W=F.h+oe,F.e.style.height=W+"px"}else var oe=!1;oe||(F.d=="s-resize"||F.d=="se-resize"||F.d=="sw-resize")&&(W=F.h+(Le-F.y),F.e.style.height=W+"px"),typeof F.e.refresh=="function"&&(Q.actioned=!0,F.e.refresh("dimensions",X,W))}else{Q.x==null&&Q.y==null&&(Q.x=he,Q.y=Le);var We=he-Q.x,Je=Le-Q.y,ce=F.e.offsetTop+Je,Ae=F.e.offsetLeft+We;F.e.style.top=ce+"px",F.e.style.left=Ae+"px",F.e.style.cursor="move",Q.x=he,Q.y=Le,typeof F.e.refresh=="function"&&(Q.actioned=!0,F.e.refresh("position",ce,Ae))}}else{var w=ft.findElement(le.target,"jpanel");if(w&&w.getAttribute("tabindex")){var P=w.getBoundingClientRect();le.clientY-P.top<l?P.width-(le.clientX-P.left)<l?w.style.cursor="ne-resize":le.clientX-P.left<l?w.style.cursor="nw-resize":w.style.cursor="n-resize":P.height-(le.clientY-P.top)<l?P.width-(le.clientX-P.left)<l?w.style.cursor="se-resize":le.clientX-P.left<l?w.style.cursor="sw-resize":w.style.cursor="s-resize":P.width-(le.clientX-P.left)<l?w.style.cursor="e-resize":le.clientX-P.left<l?w.style.cursor="w-resize":w.style.cursor=""}}},K=function(le){var he=le.target.getAttribute("data-tooltip");if(he){if(ee.innerText=he,le.changedTouches&&le.changedTouches[0])var Le=le.changedTouches[0].clientX,We=le.changedTouches[0].clientY;else var Le=le.clientX,We=le.clientY;ee.style.top=We+"px",ee.style.left=Le+"px",document.body.appendChild(ee)}else ee.innerText&&(ee.innerText="",document.body.removeChild(ee))},ne=function(le){var he=ft.findElement(le.target,"jpanel");he&&typeof he.dblclick=="function"&&he.dblclick(le)},ge=function(le){var he=document.activeElement;if(he&&typeof he.contextmenu=="function")he.contextmenu(le),le.preventDefault(),le.stopImmediatePropagation();else if(he=ft.findElement(le.target,function(We){return We.tagName&&We.getAttribute("aria-contextmenu-id")}),he){var Le=document.querySelector("#"+he);Le?(Le.contextmenu.open(le),le.preventDefault(),le.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+he)}},de=function(le){let he=document.activeElement;he&&le.key==="Delete"&&typeof he.delete=="function"&&(he.delete(),le.preventDefault(),le.stopImmediatePropagation()),document.jsuitesComponents&&document.jsuitesComponents.length&&(he=document.jsuitesComponents[document.jsuitesComponents.length-1],he&&le.key==="Escape"&&typeof he.isOpened=="function"&&typeof he.close=="function"&&he.isOpened()&&(he.close(),le.preventDefault(),le.stopImmediatePropagation()))},fe=function(le){(le.target.getAttribute("data-mask")||le.target.mask)&&ft.mask(le)};document.addEventListener("mouseup",I),document.addEventListener("mousedown",D),document.addEventListener("mousemove",B),document.addEventListener("mouseover",K),document.addEventListener("dblclick",ne),document.addEventListener("keydown",de),document.addEventListener("contextmenu",ge),document.addEventListener("input",fe)};typeof document<"u"&&!document.jsuitesComponents&&Nt();var St=ft}(),R=R.default,R}()})}(jsuites$1)),jsuites$1.exports}var hasRequiredDist;function requireDist(){return hasRequiredDist||(hasRequiredDist=1,function(module,exports){if(!jSuites&&typeof commonjsRequire=="function")var jSuites=requireJsuites();(function(n,a){module.exports=a()})(self,function(){return function(){var __webpack_modules__={243:function(n){var a;n.exports=(function(){var c={765:function(q,d){var o;o=function(h){h.version="1.0.2";var _=Math;function V(je,ie){for(var Fe=0,$e=0;Fe<je.length;++Fe)$e=ie*$e+je[Fe];return $e}function b(je,ie,Fe,$e,Ue){if(ie===0)return Fe;if(ie===1)return $e;for(var He=2/je,lt=$e,U=1;U<ie;++U)lt=$e*U*He+Ue*Fe,Fe=$e,$e=lt;return lt}function u(je,ie,Fe,$e,Ue){return function(He,lt){if($e){if(He===0)return $e==1?-1/0:1/0;if(He<0)return NaN}return lt===0?je(He):lt===1?ie(He):lt<0?NaN:b(He,lt|=0,je(He),ie(He),Ue)}}var g,v,m,C,S,L,H,N,M,T,G,Y,ae,be=function(){var je=.636619772,ie=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),Fe=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),$e=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),Ue=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function He(Ie){var Me=0,Te=0,ze=0,Ge=Ie*Ie;if(Ie<8)Me=(Te=V(ie,Ge))/(ze=V(Fe,Ge));else{var Qe=Ie-.785398164;Te=V($e,Ge=64/Ge),ze=V(Ue,Ge),Me=_.sqrt(je/Ie)*(_.cos(Qe)*Te-_.sin(Qe)*ze*8/Ie)}return Me}var lt=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),U=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),Ee=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),Ye=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function ht(Ie){var Me=0,Te=0,ze=0,Ge=Ie*Ie,Qe=_.abs(Ie)-2.356194491;return Math.abs(Ie)<8?Me=(Te=Ie*V(lt,Ge))/(ze=V(U,Ge)):(Te=V(Ee,Ge=64/Ge),ze=V(Ye,Ge),Me=_.sqrt(je/_.abs(Ie))*(_.cos(Qe)*Te-_.sin(Qe)*ze*8/_.abs(Ie)),Ie<0&&(Me=-Me)),Me}return function Ie(Me,Te){if(Te=Math.round(Te),!isFinite(Me))return isNaN(Me)?Me:0;if(Te<0)return(Te%2?-1:1)*Ie(Me,-Te);if(Me<0)return(Te%2?-1:1)*Ie(-Me,Te);if(Te===0)return He(Me);if(Te===1)return ht(Me);if(Me===0)return 0;var ze=0;if(Me>Te)ze=b(Me,Te,He(Me),ht(Me),-1);else{for(var Ge=!1,Qe=0,ct=0,it=1,dt=0,jt=2/Me,mt=2*_.floor((Te+_.floor(_.sqrt(40*Te)))/2);mt>0;mt--)dt=mt*jt*it-Qe,Qe=it,it=dt,_.abs(it)>1e10&&(it*=1e-10,Qe*=1e-10,ze*=1e-10,ct*=1e-10),Ge&&(ct+=it),Ge=!Ge,mt==Te&&(ze=Qe);ze/=ct=2*ct-it}return ze}}(),se=(g=.636619772,v=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),m=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),C=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),S=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse(),L=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),H=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),N=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),M=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse(),u(function(je){var ie=0,Fe=0,$e=0,Ue=je*je,He=je-.785398164;return je<8?ie=(Fe=V(v,Ue))/($e=V(m,Ue))+g*be(je,0)*_.log(je):(Fe=V(C,Ue=64/Ue),$e=V(S,Ue),ie=_.sqrt(g/je)*(_.sin(He)*Fe+_.cos(He)*$e*8/je)),ie},function(je){var ie=0,Fe=0,$e=0,Ue=je*je,He=je-2.356194491;return je<8?ie=(Fe=je*V(L,Ue))/($e=V(H,Ue))+g*(be(je,1)*_.log(je)-1/je):(Fe=V(N,Ue=64/Ue),$e=V(M,Ue),ie=_.sqrt(g/je)*(_.sin(He)*Fe+_.cos(He)*$e*8/je)),ie},0,1,-1)),xe=(T=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),G=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),Y=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),ae=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function je(ie,Fe){if((Fe=Math.round(Fe))===0)return function(Ye){return Ye<=3.75?V(T,Ye*Ye/14.0625):_.exp(_.abs(Ye))/_.sqrt(_.abs(Ye))*V(G,3.75/_.abs(Ye))}(ie);if(Fe===1)return function(Ye){return Ye<3.75?Ye*V(Y,Ye*Ye/14.0625):(Ye<0?-1:1)*_.exp(_.abs(Ye))/_.sqrt(_.abs(Ye))*V(ae,3.75/_.abs(Ye))}(ie);if(Fe<0)return NaN;if(_.abs(ie)===0)return 0;if(ie==1/0)return 1/0;var $e,Ue=0,He=2/_.abs(ie),lt=0,U=1,Ee=0;for($e=2*_.round((Fe+_.round(_.sqrt(40*Fe)))/2);$e>0;$e--)Ee=$e*He*U+lt,lt=U,U=Ee,_.abs(U)>1e10&&(U*=1e-10,lt*=1e-10,Ue*=1e-10),$e==Fe&&(Ue=lt);return Ue*=je(ie,0)/U,ie<0&&Fe%2?-Ue:Ue}),Se=function(){var je=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),ie=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),Fe=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),$e=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return u(function(Ue){return Ue<=2?-_.log(Ue/2)*xe(Ue,0)+V(je,Ue*Ue/4):_.exp(-Ue)/_.sqrt(Ue)*V(ie,2/Ue)},function(Ue){return Ue<=2?_.log(Ue/2)*xe(Ue,1)+1/Ue*V(Fe,Ue*Ue/4):_.exp(-Ue)/_.sqrt(Ue)*V($e,2/Ue)},0,2,1)}();h.besselj=be,h.bessely=se,h.besseli=xe,h.besselk=Se},o(typeof DO_NOT_EXPORT_BESSEL>"u"?d:{})},162:function(q){var d;q.exports=(d=function(o,h){var _=Array.prototype.concat,V=Array.prototype.slice,b=Object.prototype.toString;function u(M,T){var G=M>T?M:T;return o.pow(10,17-~~(o.log(G>0?G:-G)*o.LOG10E))}var g=Array.isArray||function(M){return b.call(M)==="[object Array]"};function v(M){return b.call(M)==="[object Function]"}function m(M){return typeof M=="number"&&M-M==0}function C(){return new C._init(arguments)}function S(){return 0}function L(){return 1}function H(M,T){return M===T?1:0}C.fn=C.prototype,C._init=function(M){if(g(M[0]))if(g(M[0][0])){v(M[1])&&(M[0]=C.map(M[0],M[1]));for(var T=0;T<M[0].length;T++)this[T]=M[0][T];this.length=M[0].length}else this[0]=v(M[1])?C.map(M[0],M[1]):M[0],this.length=1;else if(m(M[0]))this[0]=C.seq.apply(null,M),this.length=1;else{if(M[0]instanceof C)return C(M[0].toArray());this[0]=[],this.length=1}return this},C._init.prototype=C.prototype,C._init.constructor=C,C.utils={calcRdx:u,isArray:g,isFunction:v,isNumber:m,toVector:function(M){return _.apply([],M)}},C._random_fn=o.random,C.setRandom=function(M){if(typeof M!="function")throw new TypeError("fn is not a function");C._random_fn=M},C.extend=function(M){var T,G;if(arguments.length===1){for(G in M)C[G]=M[G];return this}for(T=1;T<arguments.length;T++)for(G in arguments[T])M[G]=arguments[T][G];return M},C.rows=function(M){return M.length||1},C.cols=function(M){return M[0].length||1},C.dimensions=function(M){return{rows:C.rows(M),cols:C.cols(M)}},C.row=function(M,T){return g(T)?T.map(function(G){return C.row(M,G)}):M[T]},C.rowa=function(M,T){return C.row(M,T)},C.col=function(M,T){if(g(T)){var G=C.arange(M.length).map(function(){return new Array(T.length)});return T.forEach(function(be,se){C.arange(M.length).forEach(function(xe){G[xe][se]=M[xe][be]})}),G}for(var Y=new Array(M.length),ae=0;ae<M.length;ae++)Y[ae]=[M[ae][T]];return Y},C.cola=function(M,T){return C.col(M,T).map(function(G){return G[0]})},C.diag=function(M){for(var T=C.rows(M),G=new Array(T),Y=0;Y<T;Y++)G[Y]=[M[Y][Y]];return G},C.antidiag=function(M){for(var T=C.rows(M)-1,G=new Array(T),Y=0;T>=0;T--,Y++)G[Y]=[M[Y][T]];return G},C.transpose=function(M){var T,G,Y,ae,be,se=[];for(g(M[0])||(M=[M]),G=M.length,Y=M[0].length,be=0;be<Y;be++){for(T=new Array(G),ae=0;ae<G;ae++)T[ae]=M[ae][be];se.push(T)}return se.length===1?se[0]:se},C.map=function(M,T,G){var Y,ae,be,se,xe;for(g(M[0])||(M=[M]),ae=M.length,be=M[0].length,se=G?M:new Array(ae),Y=0;Y<ae;Y++)for(se[Y]||(se[Y]=new Array(be)),xe=0;xe<be;xe++)se[Y][xe]=T(M[Y][xe],Y,xe);return se.length===1?se[0]:se},C.cumreduce=function(M,T,G){var Y,ae,be,se,xe;for(g(M[0])||(M=[M]),ae=M.length,be=M[0].length,se=G?M:new Array(ae),Y=0;Y<ae;Y++)for(se[Y]||(se[Y]=new Array(be)),be>0&&(se[Y][0]=M[Y][0]),xe=1;xe<be;xe++)se[Y][xe]=T(se[Y][xe-1],M[Y][xe]);return se.length===1?se[0]:se},C.alter=function(M,T){return C.map(M,T,!0)},C.create=function(M,T,G){var Y,ae,be=new Array(M);for(v(T)&&(G=T,T=M),Y=0;Y<M;Y++)for(be[Y]=new Array(T),ae=0;ae<T;ae++)be[Y][ae]=G(Y,ae);return be},C.zeros=function(M,T){return m(T)||(T=M),C.create(M,T,S)},C.ones=function(M,T){return m(T)||(T=M),C.create(M,T,L)},C.rand=function(M,T){return m(T)||(T=M),C.create(M,T,C._random_fn)},C.identity=function(M,T){return m(T)||(T=M),C.create(M,T,H)},C.symmetric=function(M){var T,G,Y=M.length;if(M.length!==M[0].length)return!1;for(T=0;T<Y;T++)for(G=0;G<Y;G++)if(M[G][T]!==M[T][G])return!1;return!0},C.clear=function(M){return C.alter(M,S)},C.seq=function(M,T,G,Y){v(Y)||(Y=!1);var ae,be=[],se=u(M,T),xe=(T*se-M*se)/((G-1)*se),Se=M;for(ae=0;Se<=T&&ae<G;Se=(M*se+xe*se*++ae)/se)be.push(Y?Y(Se,ae):Se);return be},C.arange=function(M,T,G){var Y,ae=[];if(G=G||1,T===h&&(T=M,M=0),M===T||G===0)return[];if(M<T&&G<0)return[];if(M>T&&G>0)return[];if(G>0)for(Y=M;Y<T;Y+=G)ae.push(Y);else for(Y=M;Y>T;Y+=G)ae.push(Y);return ae},C.slice=function(){function M(T,G,Y,ae){var be,se=[],xe=T.length;if(G===h&&Y===h&&ae===h)return C.copy(T);if(ae=ae||1,(G=(G=G||0)>=0?G:xe+G)===(Y=(Y=Y||T.length)>=0?Y:xe+Y)||ae===0)return[];if(G<Y&&ae<0)return[];if(G>Y&&ae>0)return[];if(ae>0)for(be=G;be<Y;be+=ae)se.push(T[be]);else for(be=G;be>Y;be+=ae)se.push(T[be]);return se}return function(T,G){var Y,ae;return m((G=G||{}).row)?m(G.col)?T[G.row][G.col]:M(C.rowa(T,G.row),(Y=G.col||{}).start,Y.end,Y.step):m(G.col)?M(C.cola(T,G.col),(ae=G.row||{}).start,ae.end,ae.step):(ae=G.row||{},Y=G.col||{},M(T,ae.start,ae.end,ae.step).map(function(be){return M(be,Y.start,Y.end,Y.step)}))}}(),C.sliceAssign=function(M,T,G){var Y,ae;if(m(T.row)){if(m(T.col))return M[T.row][T.col]=G;T.col=T.col||{},T.col.start=T.col.start||0,T.col.end=T.col.end||M[0].length,T.col.step=T.col.step||1,Y=C.arange(T.col.start,o.min(M.length,T.col.end),T.col.step);var be=T.row;return Y.forEach(function(xe,Se){M[be][xe]=G[Se]}),M}if(m(T.col)){T.row=T.row||{},T.row.start=T.row.start||0,T.row.end=T.row.end||M.length,T.row.step=T.row.step||1,ae=C.arange(T.row.start,o.min(M[0].length,T.row.end),T.row.step);var se=T.col;return ae.forEach(function(xe,Se){M[xe][se]=G[Se]}),M}return G[0].length===h&&(G=[G]),T.row.start=T.row.start||0,T.row.end=T.row.end||M.length,T.row.step=T.row.step||1,T.col.start=T.col.start||0,T.col.end=T.col.end||M[0].length,T.col.step=T.col.step||1,ae=C.arange(T.row.start,o.min(M.length,T.row.end),T.row.step),Y=C.arange(T.col.start,o.min(M[0].length,T.col.end),T.col.step),ae.forEach(function(xe,Se){Y.forEach(function(je,ie){M[xe][je]=G[Se][ie]})}),M},C.diagonal=function(M){var T=C.zeros(M.length,M.length);return M.forEach(function(G,Y){T[Y][Y]=G}),T},C.copy=function(M){return M.map(function(T){return m(T)?T:T.map(function(G){return G})})};var N=C.prototype;return N.length=0,N.push=Array.prototype.push,N.sort=Array.prototype.sort,N.splice=Array.prototype.splice,N.slice=Array.prototype.slice,N.toArray=function(){return this.length>1?V.call(this):V.call(this)[0]},N.map=function(M,T){return C(C.map(this,M,T))},N.cumreduce=function(M,T){return C(C.cumreduce(this,M,T))},N.alter=function(M){return C.alter(this,M),this},function(M){for(var T=0;T<M.length;T++)(function(G){N[G]=function(Y){var ae,be=this;return Y?(setTimeout(function(){Y.call(be,N[G].call(be))}),this):(ae=C[G](this),g(ae)?C(ae):ae)}})(M[T])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(M){for(var T=0;T<M.length;T++)(function(G){N[G]=function(Y,ae){var be=this;return ae?(setTimeout(function(){ae.call(be,N[G].call(be,Y))}),this):C(C[G](this,Y))}})(M[T])}("row col".split(" ")),function(M){for(var T=0;T<M.length;T++)(function(G){N[G]=function(){return C(C[G].apply(null,arguments))}})(M[T])}("create zeros ones rand identity".split(" ")),C}(Math),function(o,h){var _=o.utils.isFunction;function V(g,v){return g-v}function b(g,v,m){return h.max(v,h.min(g,m))}o.sum=function(g){for(var v=0,m=g.length;--m>=0;)v+=g[m];return v},o.sumsqrd=function(g){for(var v=0,m=g.length;--m>=0;)v+=g[m]*g[m];return v},o.sumsqerr=function(g){for(var v,m=o.mean(g),C=0,S=g.length;--S>=0;)C+=(v=g[S]-m)*v;return C},o.sumrow=function(g){for(var v=0,m=g.length;--m>=0;)v+=g[m];return v},o.product=function(g){for(var v=1,m=g.length;--m>=0;)v*=g[m];return v},o.min=function(g){for(var v=g[0],m=0;++m<g.length;)g[m]<v&&(v=g[m]);return v},o.max=function(g){for(var v=g[0],m=0;++m<g.length;)g[m]>v&&(v=g[m]);return v},o.unique=function(g){for(var v={},m=[],C=0;C<g.length;C++)v[g[C]]||(v[g[C]]=!0,m.push(g[C]));return m},o.mean=function(g){return o.sum(g)/g.length},o.meansqerr=function(g){return o.sumsqerr(g)/g.length},o.geomean=function(g){var v=g.map(h.log),m=o.mean(v);return h.exp(m)},o.median=function(g){var v=g.length,m=g.slice().sort(V);return 1&v?m[v/2|0]:(m[v/2-1]+m[v/2])/2},o.cumsum=function(g){return o.cumreduce(g,function(v,m){return v+m})},o.cumprod=function(g){return o.cumreduce(g,function(v,m){return v*m})},o.diff=function(g){var v,m=[],C=g.length;for(v=1;v<C;v++)m.push(g[v]-g[v-1]);return m},o.rank=function(g){var v,m=[],C={};for(v=0;v<g.length;v++)C[N=g[v]]?C[N]++:(C[N]=1,m.push(N));var S=m.sort(V),L={},H=1;for(v=0;v<S.length;v++){var N,M=C[N=S[v]],T=(H+(H+M-1))/2;L[N]=T,H+=M}return g.map(function(G){return L[G]})},o.mode=function(g){var v,m=g.length,C=g.slice().sort(V),S=1,L=0,H=0,N=[];for(v=0;v<m;v++)C[v]===C[v+1]?S++:(S>L?(N=[C[v]],L=S,H=0):S===L&&(N.push(C[v]),H++),S=1);return H===0?N[0]:N},o.range=function(g){return o.max(g)-o.min(g)},o.variance=function(g,v){return o.sumsqerr(g)/(g.length-(v?1:0))},o.pooledvariance=function(g){return g.reduce(function(v,m){return v+o.sumsqerr(m)},0)/(g.reduce(function(v,m){return v+m.length},0)-g.length)},o.deviation=function(g){for(var v=o.mean(g),m=g.length,C=new Array(m),S=0;S<m;S++)C[S]=g[S]-v;return C},o.stdev=function(g,v){return h.sqrt(o.variance(g,v))},o.pooledstdev=function(g){return h.sqrt(o.pooledvariance(g))},o.meandev=function(g){for(var v=o.mean(g),m=[],C=g.length-1;C>=0;C--)m.push(h.abs(g[C]-v));return o.mean(m)},o.meddev=function(g){for(var v=o.median(g),m=[],C=g.length-1;C>=0;C--)m.push(h.abs(g[C]-v));return o.median(m)},o.coeffvar=function(g){return o.stdev(g)/o.mean(g)},o.quartiles=function(g){var v=g.length,m=g.slice().sort(V);return[m[h.round(v/4)-1],m[h.round(v/2)-1],m[h.round(3*v/4)-1]]},o.quantiles=function(g,v,m,C){var S,L,H,N,M,T=g.slice().sort(V),G=[v.length],Y=g.length;for(m===void 0&&(m=.375),C===void 0&&(C=.375),S=0;S<v.length;S++)H=Y*(L=v[S])+(m+L*(1-m-C)),N=h.floor(b(H,1,Y-1)),M=b(H-N,0,1),G[S]=(1-M)*T[N-1]+M*T[N];return G},o.percentile=function(g,v,m){var C=g.slice().sort(V),S=v*(C.length+(m?1:-1))+(m?0:1),L=parseInt(S),H=S-L;return L+1<C.length?C[L-1]+H*(C[L]-C[L-1]):C[L-1]},o.percentileOfScore=function(g,v,m){var C,S,L=0,H=g.length,N=!1;for(m==="strict"&&(N=!0),S=0;S<H;S++)C=g[S],(N&&C<v||!N&&C<=v)&&L++;return L/H},o.histogram=function(g,v){v=v||4;var m,C=o.min(g),S=(o.max(g)-C)/v,L=g.length,H=[];for(m=0;m<v;m++)H[m]=0;for(m=0;m<L;m++)H[h.min(h.floor((g[m]-C)/S),v-1)]+=1;return H},o.covariance=function(g,v){var m,C=o.mean(g),S=o.mean(v),L=g.length,H=new Array(L);for(m=0;m<L;m++)H[m]=(g[m]-C)*(v[m]-S);return o.sum(H)/(L-1)},o.corrcoeff=function(g,v){return o.covariance(g,v)/o.stdev(g,1)/o.stdev(v,1)},o.spearmancoeff=function(g,v){return g=o.rank(g),v=o.rank(v),o.corrcoeff(g,v)},o.stanMoment=function(g,v){for(var m=o.mean(g),C=o.stdev(g),S=g.length,L=0,H=0;H<S;H++)L+=h.pow((g[H]-m)/C,v);return L/g.length},o.skewness=function(g){return o.stanMoment(g,3)},o.kurtosis=function(g){return o.stanMoment(g,4)-3};var u=o.prototype;(function(g){for(var v=0;v<g.length;v++)(function(m){u[m]=function(C,S){var L=[],H=0,N=this;if(_(C)&&(S=C,C=!1),S)return setTimeout(function(){S.call(N,u[m].call(N,C))}),this;if(this.length>1){for(N=C===!0?this:this.transpose();H<N.length;H++)L[H]=o[m](N[H]);return L}return o[m](this[0],C)}})(g[v])})("cumsum cumprod".split(" ")),function(g){for(var v=0;v<g.length;v++)(function(m){u[m]=function(C,S){var L=[],H=0,N=this;if(_(C)&&(S=C,C=!1),S)return setTimeout(function(){S.call(N,u[m].call(N,C))}),this;if(this.length>1){for(m!=="sumrow"&&(N=C===!0?this:this.transpose());H<N.length;H++)L[H]=o[m](N[H]);return C===!0?o[m](o.utils.toVector(L)):L}return o[m](this[0],C)}})(g[v])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(g){for(var v=0;v<g.length;v++)(function(m){u[m]=function(){var C,S=[],L=0,H=this,N=Array.prototype.slice.call(arguments);if(_(N[N.length-1])){C=N[N.length-1];var M=N.slice(0,N.length-1);return setTimeout(function(){C.call(H,u[m].apply(H,M))}),this}C=void 0;var T=function(G){return o[m].apply(H,[G].concat(N))};if(this.length>1){for(H=H.transpose();L<H.length;L++)S[L]=T(H[L]);return S}return T(this[0])}})(g[v])}("quantiles percentileOfScore".split(" "))}(d,Math),function(o,h){o.gammaln=function(_){var V,b,u,g=0,v=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],m=1.000000000190015;for(u=(b=V=_)+5.5,u-=(V+.5)*h.log(u);g<6;g++)m+=v[g]/++b;return h.log(2.5066282746310007*m/V)-u},o.loggam=function(_){var V,b,u,g,v,m,C,S=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(V=_,C=0,_==1||_==2)return 0;for(_<=7&&(V=_+(C=h.floor(7-_))),b=1/(V*V),u=2*h.PI,v=S[9],m=8;m>=0;m--)v*=b,v+=S[m];if(g=v/V+.5*h.log(u)+(V-.5)*h.log(V)-V,_<=7)for(m=1;m<=C;m++)g-=h.log(V-1),V-=1;return g},o.gammafn=function(_){var V,b,u,g,v=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],m=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],C=!1,S=0,L=0,H=0,N=_;if(_>171.6243769536076)return 1/0;if(N<=0){if(!(g=N%1+36e-17))return 1/0;C=(1&N?-1:1)*h.PI/h.sin(h.PI*g),N=1-N}for(u=N,b=N<1?N++:(N-=S=(0|N)-1)-1,V=0;V<8;++V)H=(H+v[V])*b,L=L*b+m[V];if(g=H/L+1,u<N)g/=u;else if(u>N)for(V=0;V<S;++V)g*=N,N++;return C&&(g=C/g),g},o.gammap=function(_,V){return o.lowRegGamma(_,V)*o.gammafn(_)},o.lowRegGamma=function(_,V){var b,u=o.gammaln(_),g=_,v=1/_,m=v,C=V+1-_,S=1/1e-30,L=1/C,H=L,N=1,M=-~(8.5*h.log(_>=1?_:1/_)+.4*_+17);if(V<0||_<=0)return NaN;if(V<_+1){for(;N<=M;N++)v+=m*=V/++g;return v*h.exp(-V+_*h.log(V)-u)}for(;N<=M;N++)H*=(L=1/(L=(b=-N*(N-_))*L+(C+=2)))*(S=C+b/S);return 1-H*h.exp(-V+_*h.log(V)-u)},o.factorialln=function(_){return _<0?NaN:o.gammaln(_+1)},o.factorial=function(_){return _<0?NaN:o.gammafn(_+1)},o.combination=function(_,V){return _>170||V>170?h.exp(o.combinationln(_,V)):o.factorial(_)/o.factorial(V)/o.factorial(_-V)},o.combinationln=function(_,V){return o.factorialln(_)-o.factorialln(V)-o.factorialln(_-V)},o.permutation=function(_,V){return o.factorial(_)/o.factorial(_-V)},o.betafn=function(_,V){if(!(_<=0||V<=0))return _+V>170?h.exp(o.betaln(_,V)):o.gammafn(_)*o.gammafn(V)/o.gammafn(_+V)},o.betaln=function(_,V){return o.gammaln(_)+o.gammaln(V)-o.gammaln(_+V)},o.betacf=function(_,V,b){var u,g,v,m,C=1e-30,S=1,L=V+b,H=V+1,N=V-1,M=1,T=1-L*_/H;for(h.abs(T)<C&&(T=C),m=T=1/T;S<=100&&(T=1+(g=S*(b-S)*_/((N+(u=2*S))*(V+u)))*T,h.abs(T)<C&&(T=C),M=1+g/M,h.abs(M)<C&&(M=C),m*=(T=1/T)*M,T=1+(g=-(V+S)*(L+S)*_/((V+u)*(H+u)))*T,h.abs(T)<C&&(T=C),M=1+g/M,h.abs(M)<C&&(M=C),m*=v=(T=1/T)*M,!(h.abs(v-1)<3e-7));S++);return m},o.gammapinv=function(_,V){var b,u,g,v,m,C,S=0,L=V-1,H=o.gammaln(V);if(_>=1)return h.max(100,V+100*h.sqrt(V));if(_<=0)return 0;for(V>1?(m=h.log(L),C=h.exp(L*(m-1)-H),v=_<.5?_:1-_,b=(2.30753+.27061*(u=h.sqrt(-2*h.log(v))))/(1+u*(.99229+.04481*u))-u,_<.5&&(b=-b),b=h.max(.001,V*h.pow(1-1/(9*V)-b/(3*h.sqrt(V)),3))):b=_<(u=1-V*(.253+.12*V))?h.pow(_/u,1/V):1-h.log(1-(_-u)/(1-u));S<12;S++){if(b<=0)return 0;if((b-=u=(g=(o.lowRegGamma(V,b)-_)/(u=V>1?C*h.exp(-(b-L)+L*(h.log(b)-m)):h.exp(-b+L*h.log(b)-H)))/(1-.5*h.min(1,g*((V-1)/b-1))))<=0&&(b=.5*(b+u)),h.abs(u)<1e-8*b)break}return b},o.erf=function(_){var V,b,u,g,v=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],m=v.length-1,C=!1,S=0,L=0;for(_<0&&(_=-_,C=!0),b=4*(V=2/(2+_))-2;m>0;m--)u=S,S=b*S-L+v[m],L=u;return g=V*h.exp(-_*_+.5*(v[0]+b*S)-L),C?g-1:1-g},o.erfc=function(_){return 1-o.erf(_)},o.erfcinv=function(_){var V,b,u,g,v=0;if(_>=2)return-100;if(_<=0)return 100;for(g=_<1?_:2-_,V=-.70711*((2.30753+.27061*(u=h.sqrt(-2*h.log(g/2))))/(1+u*(.99229+.04481*u))-u);v<2;v++)V+=(b=o.erfc(V)-g)/(1.1283791670955126*h.exp(-V*V)-V*b);return _<1?V:-V},o.ibetainv=function(_,V,b){var u,g,v,m,C,S,L,H,N,M,T=V-1,G=b-1,Y=0;if(_<=0)return 0;if(_>=1)return 1;for(V>=1&&b>=1?(v=_<.5?_:1-_,S=(2.30753+.27061*(m=h.sqrt(-2*h.log(v))))/(1+m*(.99229+.04481*m))-m,_<.5&&(S=-S),L=(S*S-3)/6,H=2/(1/(2*V-1)+1/(2*b-1)),N=S*h.sqrt(L+H)/H-(1/(2*b-1)-1/(2*V-1))*(L+.8333333333333334-2/(3*H)),S=V/(V+b*h.exp(2*N))):(u=h.log(V/(V+b)),g=h.log(b/(V+b)),S=_<(m=h.exp(V*u)/V)/(N=m+(C=h.exp(b*g)/b))?h.pow(V*N*_,1/V):1-h.pow(b*N*(1-_),1/b)),M=-o.gammaln(V)-o.gammaln(b)+o.gammaln(V+b);Y<10;Y++){if(S===0||S===1)return S;if((S-=m=(C=(o.ibeta(S,V,b)-_)/(m=h.exp(T*h.log(S)+G*h.log(1-S)+M)))/(1-.5*h.min(1,C*(T/S-G/(1-S)))))<=0&&(S=.5*(S+m)),S>=1&&(S=.5*(S+m+1)),h.abs(m)<1e-8*S&&Y>0)break}return S},o.ibeta=function(_,V,b){var u=_===0||_===1?0:h.exp(o.gammaln(V+b)-o.gammaln(V)-o.gammaln(b)+V*h.log(_)+b*h.log(1-_));return!(_<0||_>1)&&(_<(V+1)/(V+b+2)?u*o.betacf(_,V,b)/V:1-u*o.betacf(1-_,b,V)/b)},o.randn=function(_,V){var b,u,g,v,m;if(V||(V=_),_)return o.create(_,V,function(){return o.randn()});do b=o._random_fn(),u=1.7156*(o._random_fn()-.5),m=(g=b-.449871)*g+(v=h.abs(u)+.386595)*(.196*v-.25472*g);while(m>.27597&&(m>.27846||u*u>-4*h.log(b)*b*b));return u/b},o.randg=function(_,V,b){var u,g,v,m,C,S,L=_;if(b||(b=V),_||(_=1),V)return(S=o.zeros(V,b)).alter(function(){return o.randg(_)}),S;_<1&&(_+=1),u=_-.3333333333333333,g=1/h.sqrt(9*u);do{do m=1+g*(C=o.randn());while(m<=0);m*=m*m,v=o._random_fn()}while(v>1-.331*h.pow(C,4)&&h.log(v)>.5*C*C+u*(1-m+h.log(m)));if(_==L)return u*m;do v=o._random_fn();while(v===0);return h.pow(v,1/L)*u*m},function(_){for(var V=0;V<_.length;V++)(function(b){o.fn[b]=function(){return o(o.map(this,function(u){return o[b](u)}))}})(_[V])}("gammaln gammafn factorial factorialln".split(" ")),function(_){for(var V=0;V<_.length;V++)(function(b){o.fn[b]=function(){return o(o[b].apply(null,arguments))}})(_[V])}("randn".split(" "))}(d,Math),function(o,h){function _(b,u,g,v){for(var m,C=0,S=1,L=1,H=1,N=0,M=0;h.abs((L-M)/L)>v;)M=L,S=H+(m=-(u+N)*(u+g+N)*b/(u+2*N)/(u+2*N+1))*S,L=(C=L+m*C)+(m=(N+=1)*(g-N)*b/(u+2*N-1)/(u+2*N))*L,C/=H=S+m*H,S/=H,L/=H,H=1;return L/u}function V(b,u,g){var v=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],m=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],C=.5*b;if(C>=8)return 1;var S,L=2*o.normal.cdf(C,0,1,1,0)-1;L=L>=h.exp(-50/g)?h.pow(L,g):0;for(var H=C,N=(8-C)/(S=b>3?2:3),M=H+N,T=0,G=g-1,Y=1;Y<=S;Y++){for(var ae=0,be=.5*(M+H),se=.5*(M-H),xe=1;xe<=12;xe++){var Se,je=be+se*(6<xe?v[(Se=12-xe+1)-1]:-v[(Se=xe)-1]),ie=je*je;if(ie>60)break;var Fe=2*o.normal.cdf(je,0,1,1,0)*.5-2*o.normal.cdf(je,b,1,1,0)*.5;Fe>=h.exp(-30/G)&&(ae+=Fe=m[Se-1]*h.exp(-.5*ie)*h.pow(Fe,G))}T+=ae*=2*se*g/h.sqrt(2*h.PI),H=M,M+=N}return(L+=T)<=h.exp(-30/u)?0:(L=h.pow(L,u))>=1?1:L}(function(b){for(var u=0;u<b.length;u++)(function(g){o[g]=function v(m,C,S){return this instanceof v?(this._a=m,this._b=C,this._c=S,this):new v(m,C,S)},o.fn[g]=function(v,m,C){var S=o[g](v,m,C);return S.data=this,S},o[g].prototype.sample=function(v){var m=this._a,C=this._b,S=this._c;return v?o.alter(v,function(){return o[g].sample(m,C,S)}):o[g].sample(m,C,S)},function(v){for(var m=0;m<v.length;m++)(function(C){o[g].prototype[C]=function(S){var L=this._a,H=this._b,N=this._c;return S||S===0||(S=this.data),typeof S!="number"?o.fn.map.call(S,function(M){return o[g][C](M,L,H,N)}):o[g][C](S,L,H,N)}})(v[m])}("pdf cdf inv".split(" ")),function(v){for(var m=0;m<v.length;m++)(function(C){o[g].prototype[C]=function(){return o[g][C](this._a,this._b,this._c)}})(v[m])}("mean median mode variance".split(" "))})(b[u])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),o.extend(o.beta,{pdf:function(b,u,g){return b>1||b<0?0:u==1&&g==1?1:u<512&&g<512?h.pow(b,u-1)*h.pow(1-b,g-1)/o.betafn(u,g):h.exp((u-1)*h.log(b)+(g-1)*h.log(1-b)-o.betaln(u,g))},cdf:function(b,u,g){return b>1||b<0?1*(b>1):o.ibeta(b,u,g)},inv:function(b,u,g){return o.ibetainv(b,u,g)},mean:function(b,u){return b/(b+u)},median:function(b,u){return o.ibetainv(.5,b,u)},mode:function(b,u){return(b-1)/(b+u-2)},sample:function(b,u){var g=o.randg(b);return g/(g+o.randg(u))},variance:function(b,u){return b*u/(h.pow(b+u,2)*(b+u+1))}}),o.extend(o.centralF,{pdf:function(b,u,g){var v;return b<0?0:u<=2?b===0&&u<2?1/0:b===0&&u===2?1:1/o.betafn(u/2,g/2)*h.pow(u/g,u/2)*h.pow(b,u/2-1)*h.pow(1+u/g*b,-(u+g)/2):(v=u*b/(g+b*u),u*(g/(g+b*u))/2*o.binomial.pdf((u-2)/2,(u+g-2)/2,v))},cdf:function(b,u,g){return b<0?0:o.ibeta(u*b/(u*b+g),u/2,g/2)},inv:function(b,u,g){return g/(u*(1/o.ibetainv(b,u/2,g/2)-1))},mean:function(b,u){return u>2?u/(u-2):void 0},mode:function(b,u){return b>2?u*(b-2)/(b*(u+2)):void 0},sample:function(b,u){return 2*o.randg(b/2)/b/(2*o.randg(u/2)/u)},variance:function(b,u){if(!(u<=4))return 2*u*u*(b+u-2)/(b*(u-2)*(u-2)*(u-4))}}),o.extend(o.cauchy,{pdf:function(b,u,g){return g<0?0:g/(h.pow(b-u,2)+h.pow(g,2))/h.PI},cdf:function(b,u,g){return h.atan((b-u)/g)/h.PI+.5},inv:function(b,u,g){return u+g*h.tan(h.PI*(b-.5))},median:function(b){return b},mode:function(b){return b},sample:function(b,u){return o.randn()*h.sqrt(1/(2*o.randg(.5)))*u+b}}),o.extend(o.chisquare,{pdf:function(b,u){return b<0?0:b===0&&u===2?.5:h.exp((u/2-1)*h.log(b)-b/2-u/2*h.log(2)-o.gammaln(u/2))},cdf:function(b,u){return b<0?0:o.lowRegGamma(u/2,b/2)},inv:function(b,u){return 2*o.gammapinv(b,.5*u)},mean:function(b){return b},median:function(b){return b*h.pow(1-2/(9*b),3)},mode:function(b){return b-2>0?b-2:0},sample:function(b){return 2*o.randg(b/2)},variance:function(b){return 2*b}}),o.extend(o.exponential,{pdf:function(b,u){return b<0?0:u*h.exp(-u*b)},cdf:function(b,u){return b<0?0:1-h.exp(-u*b)},inv:function(b,u){return-h.log(1-b)/u},mean:function(b){return 1/b},median:function(b){return 1/b*h.log(2)},mode:function(){return 0},sample:function(b){return-1/b*h.log(o._random_fn())},variance:function(b){return h.pow(b,-2)}}),o.extend(o.gamma,{pdf:function(b,u,g){return b<0?0:b===0&&u===1?1/g:h.exp((u-1)*h.log(b)-b/g-o.gammaln(u)-u*h.log(g))},cdf:function(b,u,g){return b<0?0:o.lowRegGamma(u,b/g)},inv:function(b,u,g){return o.gammapinv(b,u)*g},mean:function(b,u){return b*u},mode:function(b,u){if(b>1)return(b-1)*u},sample:function(b,u){return o.randg(b)*u},variance:function(b,u){return b*u*u}}),o.extend(o.invgamma,{pdf:function(b,u,g){return b<=0?0:h.exp(-(u+1)*h.log(b)-g/b-o.gammaln(u)+u*h.log(g))},cdf:function(b,u,g){return b<=0?0:1-o.lowRegGamma(u,g/b)},inv:function(b,u,g){return g/o.gammapinv(1-b,u)},mean:function(b,u){return b>1?u/(b-1):void 0},mode:function(b,u){return u/(b+1)},sample:function(b,u){return u/o.randg(b)},variance:function(b,u){if(!(b<=2))return u*u/((b-1)*(b-1)*(b-2))}}),o.extend(o.kumaraswamy,{pdf:function(b,u,g){return b===0&&u===1?g:b===1&&g===1?u:h.exp(h.log(u)+h.log(g)+(u-1)*h.log(b)+(g-1)*h.log(1-h.pow(b,u)))},cdf:function(b,u,g){return b<0?0:b>1?1:1-h.pow(1-h.pow(b,u),g)},inv:function(b,u,g){return h.pow(1-h.pow(1-b,1/g),1/u)},mean:function(b,u){return u*o.gammafn(1+1/b)*o.gammafn(u)/o.gammafn(1+1/b+u)},median:function(b,u){return h.pow(1-h.pow(2,-1/u),1/b)},mode:function(b,u){if(b>=1&&u>=1&&b!==1&&u!==1)return h.pow((b-1)/(b*u-1),1/b)},variance:function(){throw new Error("variance not yet implemented")}}),o.extend(o.lognormal,{pdf:function(b,u,g){return b<=0?0:h.exp(-h.log(b)-.5*h.log(2*h.PI)-h.log(g)-h.pow(h.log(b)-u,2)/(2*g*g))},cdf:function(b,u,g){return b<0?0:.5+.5*o.erf((h.log(b)-u)/h.sqrt(2*g*g))},inv:function(b,u,g){return h.exp(-1.4142135623730951*g*o.erfcinv(2*b)+u)},mean:function(b,u){return h.exp(b+u*u/2)},median:function(b){return h.exp(b)},mode:function(b,u){return h.exp(b-u*u)},sample:function(b,u){return h.exp(o.randn()*u+b)},variance:function(b,u){return(h.exp(u*u)-1)*h.exp(2*b+u*u)}}),o.extend(o.noncentralt,{pdf:function(b,u,g){return h.abs(g)<1e-14?o.studentt.pdf(b,u):h.abs(b)<1e-14?h.exp(o.gammaln((u+1)/2)-g*g/2-.5*h.log(h.PI*u)-o.gammaln(u/2)):u/b*(o.noncentralt.cdf(b*h.sqrt(1+2/u),u+2,g)-o.noncentralt.cdf(b,u,g))},cdf:function(b,u,g){var v=1e-14;if(h.abs(g)<v)return o.studentt.cdf(b,u);var m=!1;b<0&&(m=!0,g=-g);for(var C=o.normal.cdf(-g,0,1),S=v+1,L=S,H=b*b/(b*b+u),N=0,M=h.exp(-g*g/2),T=h.exp(-g*g/2-.5*h.log(2)-o.gammaln(1.5))*g;N<200||L>v||S>v;)L=S,N>0&&(M*=g*g/(2*N),T*=g*g/(2*(N+.5))),C+=.5*(S=M*o.beta.cdf(H,N+.5,u/2)+T*o.beta.cdf(H,N+1,u/2)),N++;return m?1-C:C}}),o.extend(o.normal,{pdf:function(b,u,g){return h.exp(-.5*h.log(2*h.PI)-h.log(g)-h.pow(b-u,2)/(2*g*g))},cdf:function(b,u,g){return .5*(1+o.erf((b-u)/h.sqrt(2*g*g)))},inv:function(b,u,g){return-1.4142135623730951*g*o.erfcinv(2*b)+u},mean:function(b){return b},median:function(b){return b},mode:function(b){return b},sample:function(b,u){return o.randn()*u+b},variance:function(b,u){return u*u}}),o.extend(o.pareto,{pdf:function(b,u,g){return b<u?0:g*h.pow(u,g)/h.pow(b,g+1)},cdf:function(b,u,g){return b<u?0:1-h.pow(u/b,g)},inv:function(b,u,g){return u/h.pow(1-b,1/g)},mean:function(b,u){if(!(u<=1))return u*h.pow(b,u)/(u-1)},median:function(b,u){return b*(u*h.SQRT2)},mode:function(b){return b},variance:function(b,u){if(!(u<=2))return b*b*u/(h.pow(u-1,2)*(u-2))}}),o.extend(o.studentt,{pdf:function(b,u){return u=u>1e100?1e100:u,1/(h.sqrt(u)*o.betafn(.5,u/2))*h.pow(1+b*b/u,-(u+1)/2)},cdf:function(b,u){var g=u/2;return o.ibeta((b+h.sqrt(b*b+u))/(2*h.sqrt(b*b+u)),g,g)},inv:function(b,u){var g=o.ibetainv(2*h.min(b,1-b),.5*u,.5);return g=h.sqrt(u*(1-g)/g),b>.5?g:-g},mean:function(b){return b>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(b){return o.randn()*h.sqrt(b/(2*o.randg(b/2)))},variance:function(b){return b>2?b/(b-2):b>1?1/0:void 0}}),o.extend(o.weibull,{pdf:function(b,u,g){return b<0||u<0||g<0?0:g/u*h.pow(b/u,g-1)*h.exp(-h.pow(b/u,g))},cdf:function(b,u,g){return b<0?0:1-h.exp(-h.pow(b/u,g))},inv:function(b,u,g){return u*h.pow(-h.log(1-b),1/g)},mean:function(b,u){return b*o.gammafn(1+1/u)},median:function(b,u){return b*h.pow(h.log(2),1/u)},mode:function(b,u){return u<=1?0:b*h.pow((u-1)/u,1/u)},sample:function(b,u){return b*h.pow(-h.log(o._random_fn()),1/u)},variance:function(b,u){return b*b*o.gammafn(1+2/u)-h.pow(o.weibull.mean(b,u),2)}}),o.extend(o.uniform,{pdf:function(b,u,g){return b<u||b>g?0:1/(g-u)},cdf:function(b,u,g){return b<u?0:b<g?(b-u)/(g-u):1},inv:function(b,u,g){return u+b*(g-u)},mean:function(b,u){return .5*(b+u)},median:function(b,u){return o.mean(b,u)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(b,u){return b/2+u/2+(u/2-b/2)*(2*o._random_fn()-1)},variance:function(b,u){return h.pow(u-b,2)/12}}),o.extend(o.binomial,{pdf:function(b,u,g){return g===0||g===1?u*g===b?1:0:o.combination(u,b)*h.pow(g,b)*h.pow(1-g,u-b)},cdf:function(b,u,g){var v,m=1e-10;if(b<0)return 0;if(b>=u)return 1;if(g<0||g>1||u<=0)return NaN;var C=g,S=(b=h.floor(b))+1,L=u-b,H=S+L,N=h.exp(o.gammaln(H)-o.gammaln(L)-o.gammaln(S)+S*h.log(C)+L*h.log(1-C));return v=C<(S+1)/(H+2)?N*_(C,S,L,m):1-N*_(1-C,L,S,m),h.round(1/m*(1-v))/(1/m)}}),o.extend(o.negbin,{pdf:function(b,u,g){return b===b>>>0&&(b<0?0:o.combination(b+u-1,u-1)*h.pow(1-g,b)*h.pow(g,u))},cdf:function(b,u,g){var v=0,m=0;if(b<0)return 0;for(;m<=b;m++)v+=o.negbin.pdf(m,u,g);return v}}),o.extend(o.hypgeom,{pdf:function(b,u,g,v){if(b!=b|0)return!1;if(b<0||b<g-(u-v)||b>v||b>g)return 0;if(2*g>u)return 2*v>u?o.hypgeom.pdf(u-g-v+b,u,u-g,u-v):o.hypgeom.pdf(v-b,u,u-g,v);if(2*v>u)return o.hypgeom.pdf(g-b,u,g,u-v);if(g<v)return o.hypgeom.pdf(b,u,v,g);for(var m=1,C=0,S=0;S<b;S++){for(;m>1&&C<v;)m*=1-g/(u-C),C++;m*=(v-S)*(g-S)/((S+1)*(u-g-v+S+1))}for(;C<v;C++)m*=1-g/(u-C);return h.min(1,h.max(0,m))},cdf:function(b,u,g,v){if(b<0||b<g-(u-v))return 0;if(b>=v||b>=g)return 1;if(2*g>u)return 2*v>u?o.hypgeom.cdf(u-g-v+b,u,u-g,u-v):1-o.hypgeom.cdf(v-b-1,u,u-g,v);if(2*v>u)return 1-o.hypgeom.cdf(g-b-1,u,g,u-v);if(g<v)return o.hypgeom.cdf(b,u,v,g);for(var m=1,C=1,S=0,L=0;L<b;L++){for(;m>1&&S<v;){var H=1-g/(u-S);C*=H,m*=H,S++}m+=C*=(v-L)*(g-L)/((L+1)*(u-g-v+L+1))}for(;S<v;S++)m*=1-g/(u-S);return h.min(1,h.max(0,m))}}),o.extend(o.poisson,{pdf:function(b,u){return u<0||b%1!=0||b<0?0:h.pow(u,b)*h.exp(-u)/o.factorial(b)},cdf:function(b,u){var g=[],v=0;if(b<0)return 0;for(;v<=b;v++)g.push(o.poisson.pdf(v,u));return o.sum(g)},mean:function(b){return b},variance:function(b){return b},sampleSmall:function(b){var u=1,g=0,v=h.exp(-b);do g++,u*=o._random_fn();while(u>v);return g-1},sampleLarge:function(b){var u,g,v,m,C,S,L,H,N,M,T=b;for(m=h.sqrt(T),C=h.log(T),S=.02483*(L=.931+2.53*m)-.059,H=1.1239+1.1328/(L-3.4),N=.9277-3.6224/(L-2);;)if(g=h.random()-.5,v=h.random(),M=.5-h.abs(g),u=h.floor((2*S/M+L)*g+T+.43),M>=.07&&v<=N||!(u<0||M<.013&&v>M)&&h.log(v)+h.log(H)-h.log(S/(M*M)+L)<=u*C-T-o.loggam(u+1))return u},sample:function(b){return b<10?this.sampleSmall(b):this.sampleLarge(b)}}),o.extend(o.triangular,{pdf:function(b,u,g,v){return g<=u||v<u||v>g?NaN:b<u||b>g?0:b<v?2*(b-u)/((g-u)*(v-u)):b===v?2/(g-u):2*(g-b)/((g-u)*(g-v))},cdf:function(b,u,g,v){return g<=u||v<u||v>g?NaN:b<=u?0:b>=g?1:b<=v?h.pow(b-u,2)/((g-u)*(v-u)):1-h.pow(g-b,2)/((g-u)*(g-v))},inv:function(b,u,g,v){return g<=u||v<u||v>g?NaN:b<=(v-u)/(g-u)?u+(g-u)*h.sqrt(b*((v-u)/(g-u))):u+(g-u)*(1-h.sqrt((1-b)*(1-(v-u)/(g-u))))},mean:function(b,u,g){return(b+u+g)/3},median:function(b,u,g){return g<=(b+u)/2?u-h.sqrt((u-b)*(u-g))/h.sqrt(2):g>(b+u)/2?b+h.sqrt((u-b)*(g-b))/h.sqrt(2):void 0},mode:function(b,u,g){return g},sample:function(b,u,g){var v=o._random_fn();return v<(g-b)/(u-b)?b+h.sqrt(v*(u-b)*(g-b)):u-h.sqrt((1-v)*(u-b)*(u-g))},variance:function(b,u,g){return(b*b+u*u+g*g-b*u-b*g-u*g)/18}}),o.extend(o.arcsine,{pdf:function(b,u,g){return g<=u?NaN:b<=u||b>=g?0:2/h.PI*h.pow(h.pow(g-u,2)-h.pow(2*b-u-g,2),-.5)},cdf:function(b,u,g){return b<u?0:b<g?2/h.PI*h.asin(h.sqrt((b-u)/(g-u))):1},inv:function(b,u,g){return u+(.5-.5*h.cos(h.PI*b))*(g-u)},mean:function(b,u){return u<=b?NaN:(b+u)/2},median:function(b,u){return u<=b?NaN:(b+u)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(b,u){return(b+u)/2+(u-b)/2*h.sin(2*h.PI*o.uniform.sample(0,1))},variance:function(b,u){return u<=b?NaN:h.pow(u-b,2)/8}}),o.extend(o.laplace,{pdf:function(b,u,g){return g<=0?0:h.exp(-h.abs(b-u)/g)/(2*g)},cdf:function(b,u,g){return g<=0?0:b<u?.5*h.exp((b-u)/g):1-.5*h.exp(-(b-u)/g)},mean:function(b){return b},median:function(b){return b},mode:function(b){return b},variance:function(b,u){return 2*u*u},sample:function(b,u){var g,v=o._random_fn()-.5;return b-u*((g=v)/h.abs(g))*h.log(1-2*h.abs(v))}}),o.extend(o.tukey,{cdf:function(b,u,g){var v=u,m=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],C=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(b<=0)return 0;if(g<2||v<2)return NaN;if(!Number.isFinite(b))return 1;if(g>25e3)return V(b,1,v);var S,L=.5*g,H=L*h.log(g)-g*h.log(2)-o.gammaln(L),N=L-1,M=.25*g;S=g<=100?1:g<=800?.5:g<=5e3?.25:.125,H+=h.log(S);for(var T=0,G=1;G<=50;G++){for(var Y=0,ae=(2*G-1)*S,be=1;be<=16;be++){var se,xe;8<be?(se=be-8-1,xe=H+N*h.log(ae+m[se]*S)-(m[se]*S+ae)*M):(se=be-1,xe=H+N*h.log(ae-m[se]*S)+(m[se]*S-ae)*M),xe>=-30&&(Y+=V(8<be?b*h.sqrt(.5*(m[se]*S+ae)):b*h.sqrt(.5*(-m[se]*S+ae)),1,v)*C[se]*h.exp(xe))}if(G*S>=1&&Y<=1e-14)break;T+=Y}if(Y>1e-14)throw new Error("tukey.cdf failed to converge");return T>1&&(T=1),T},inv:function(b,u,g){if(g<2||u<2)return NaN;if(b<0||b>1)return NaN;if(b===0)return 0;if(b===1)return 1/0;var v,m=function(N,M,T){var G=.5-.5*N,Y=h.sqrt(h.log(1/(G*G))),ae=Y+((((-453642210148e-16*Y-.204231210125)*Y-.342242088547)*Y-1)*Y+.322232421088)/((((.0038560700634*Y+.10353775285)*Y+.531103462366)*Y+.588581570495)*Y+.099348462606);T<120&&(ae+=(ae*ae*ae+ae)/T/4);var be=.8832-.2368*ae;return T<120&&(be+=-1.214/T+1.208*ae/T),ae*(be*h.log(M-1)+1.4142)}(b,u,g),C=o.tukey.cdf(m,u,g)-b;v=C>0?h.max(0,m-1):m+1;for(var S,L=o.tukey.cdf(v,u,g)-b,H=1;H<50;H++)if(S=v-L*(v-m)/(L-C),C=L,m=v,S<0&&(S=0,L=-b),L=o.tukey.cdf(S,u,g)-b,v=S,h.abs(v-m)<1e-4)return S;throw new Error("tukey.inv failed to converge")}})}(d,Math),function(o,h){var _,V,b=Array.prototype.push,u=o.utils.isArray;function g(v){return u(v)||v instanceof o}o.extend({add:function(v,m){return g(m)?(g(m[0])||(m=[m]),o.map(v,function(C,S,L){return C+m[S][L]})):o.map(v,function(C){return C+m})},subtract:function(v,m){return g(m)?(g(m[0])||(m=[m]),o.map(v,function(C,S,L){return C-m[S][L]||0})):o.map(v,function(C){return C-m})},divide:function(v,m){return g(m)?(g(m[0])||(m=[m]),o.multiply(v,o.inv(m))):o.map(v,function(C){return C/m})},multiply:function(v,m){var C,S,L,H,N,M,T,G;if(v.length===void 0&&m.length===void 0)return v*m;if(N=v.length,M=v[0].length,T=o.zeros(N,L=g(m)?m[0].length:M),G=0,g(m)){for(;G<L;G++)for(C=0;C<N;C++){for(H=0,S=0;S<M;S++)H+=v[C][S]*m[S][G];T[C][G]=H}return N===1&&G===1?T[0][0]:T}return o.map(v,function(Y){return Y*m})},outer:function(v,m){return o.multiply(v.map(function(C){return[C]}),[m])},dot:function(v,m){g(v[0])||(v=[v]),g(m[0])||(m=[m]);for(var C,S,L=v[0].length===1&&v.length!==1?o.transpose(v):v,H=m[0].length===1&&m.length!==1?o.transpose(m):m,N=[],M=0,T=L.length,G=L[0].length;M<T;M++){for(N[M]=[],C=0,S=0;S<G;S++)C+=L[M][S]*H[M][S];N[M]=C}return N.length===1?N[0]:N},pow:function(v,m){return o.map(v,function(C){return h.pow(C,m)})},exp:function(v){return o.map(v,function(m){return h.exp(m)})},log:function(v){return o.map(v,function(m){return h.log(m)})},abs:function(v){return o.map(v,function(m){return h.abs(m)})},norm:function(v,m){var C=0,S=0;for(isNaN(m)&&(m=2),g(v[0])&&(v=v[0]);S<v.length;S++)C+=h.pow(h.abs(v[S]),m);return h.pow(C,1/m)},angle:function(v,m){return h.acos(o.dot(v,m)/(o.norm(v)*o.norm(m)))},aug:function(v,m){var C,S=[];for(C=0;C<v.length;C++)S.push(v[C].slice());for(C=0;C<S.length;C++)b.apply(S[C],m[C]);return S},inv:function(v){for(var m,C=v.length,S=v[0].length,L=o.identity(C,S),H=o.gauss_jordan(v,L),N=[],M=0;M<C;M++)for(N[M]=[],m=S;m<H[0].length;m++)N[M][m-S]=H[M][m];return N},det:function v(m){if(m.length===2)return m[0][0]*m[1][1]-m[0][1]*m[1][0];for(var C=0,S=0;S<m.length;S++){for(var L=[],H=1;H<m.length;H++){L[H-1]=[];for(var N=0;N<m.length;N++)N<S?L[H-1][N]=m[H][N]:N>S&&(L[H-1][N-1]=m[H][N])}var M=S%2?-1:1;C+=v(L)*m[0][S]*M}return C},gauss_elimination:function(v,m){var C,S,L,H,N=0,M=0,T=v.length,G=v[0].length,Y=1,ae=0,be=[];for(C=(v=o.aug(v,m))[0].length,N=0;N<T;N++){for(S=v[N][N],M=N,H=N+1;H<G;H++)S<h.abs(v[H][N])&&(S=v[H][N],M=H);if(M!=N)for(H=0;H<C;H++)L=v[N][H],v[N][H]=v[M][H],v[M][H]=L;for(M=N+1;M<T;M++)for(Y=v[M][N]/v[N][N],H=N;H<C;H++)v[M][H]=v[M][H]-Y*v[N][H]}for(N=T-1;N>=0;N--){for(ae=0,M=N+1;M<=T-1;M++)ae+=be[M]*v[N][M];be[N]=(v[N][C-1]-ae)/v[N][N]}return be},gauss_jordan:function(v,m){var C,S,L,H=o.aug(v,m),N=H.length,M=H[0].length,T=0;for(S=0;S<N;S++){var G=S;for(L=S+1;L<N;L++)h.abs(H[L][S])>h.abs(H[G][S])&&(G=L);var Y=H[S];for(H[S]=H[G],H[G]=Y,L=S+1;L<N;L++)for(T=H[L][S]/H[S][S],C=S;C<M;C++)H[L][C]-=H[S][C]*T}for(S=N-1;S>=0;S--){for(T=H[S][S],L=0;L<S;L++)for(C=M-1;C>S-1;C--)H[L][C]-=H[S][C]*H[L][S]/T;for(H[S][S]/=T,C=N;C<M;C++)H[S][C]/=T}return H},triaUpSolve:function(v,m){var C,S=v[0].length,L=o.zeros(1,S)[0],H=!1;return m[0].length!=null&&(m=m.map(function(N){return N[0]}),H=!0),o.arange(S-1,-1,-1).forEach(function(N){C=o.arange(N+1,S).map(function(M){return L[M]*v[N][M]}),L[N]=(m[N]-o.sum(C))/v[N][N]}),H?L.map(function(N){return[N]}):L},triaLowSolve:function(v,m){var C,S=v[0].length,L=o.zeros(1,S)[0],H=!1;return m[0].length!=null&&(m=m.map(function(N){return N[0]}),H=!0),o.arange(S).forEach(function(N){C=o.arange(N).map(function(M){return v[N][M]*L[M]}),L[N]=(m[N]-o.sum(C))/v[N][N]}),H?L.map(function(N){return[N]}):L},lu:function(v){var m,C=v.length,S=o.identity(C),L=o.zeros(v.length,v[0].length);return o.arange(C).forEach(function(H){L[0][H]=v[0][H]}),o.arange(1,C).forEach(function(H){o.arange(H).forEach(function(N){m=o.arange(N).map(function(M){return S[H][M]*L[M][N]}),S[H][N]=(v[H][N]-o.sum(m))/L[N][N]}),o.arange(H,C).forEach(function(N){m=o.arange(H).map(function(M){return S[H][M]*L[M][N]}),L[H][N]=v[m.length][N]-o.sum(m)})}),[S,L]},cholesky:function(v){var m,C=v.length,S=o.zeros(v.length,v[0].length);return o.arange(C).forEach(function(L){m=o.arange(L).map(function(H){return h.pow(S[L][H],2)}),S[L][L]=h.sqrt(v[L][L]-o.sum(m)),o.arange(L+1,C).forEach(function(H){m=o.arange(L).map(function(N){return S[L][N]*S[H][N]}),S[H][L]=(v[L][H]-o.sum(m))/S[L][L]})}),S},gauss_jacobi:function(v,m,C,S){for(var L,H,N,M,T=0,G=0,Y=v.length,ae=[],be=[],se=[];T<Y;T++)for(ae[T]=[],be[T]=[],se[T]=[],G=0;G<Y;G++)T>G?(ae[T][G]=v[T][G],be[T][G]=se[T][G]=0):T<G?(be[T][G]=v[T][G],ae[T][G]=se[T][G]=0):(se[T][G]=v[T][G],ae[T][G]=be[T][G]=0);for(N=o.multiply(o.multiply(o.inv(se),o.add(ae,be)),-1),H=o.multiply(o.inv(se),m),L=C,M=o.add(o.multiply(N,C),H),T=2;h.abs(o.norm(o.subtract(M,L)))>S;)L=M,M=o.add(o.multiply(N,L),H),T++;return M},gauss_seidel:function(v,m,C,S){for(var L,H,N,M,T,G=0,Y=v.length,ae=[],be=[],se=[];G<Y;G++)for(ae[G]=[],be[G]=[],se[G]=[],L=0;L<Y;L++)G>L?(ae[G][L]=v[G][L],be[G][L]=se[G][L]=0):G<L?(be[G][L]=v[G][L],ae[G][L]=se[G][L]=0):(se[G][L]=v[G][L],ae[G][L]=be[G][L]=0);for(M=o.multiply(o.multiply(o.inv(o.add(se,ae)),be),-1),N=o.multiply(o.inv(o.add(se,ae)),m),H=C,T=o.add(o.multiply(M,C),N),G=2;h.abs(o.norm(o.subtract(T,H)))>S;)H=T,T=o.add(o.multiply(M,H),N),G+=1;return T},SOR:function(v,m,C,S,L){for(var H,N,M,T,G,Y=0,ae=v.length,be=[],se=[],xe=[];Y<ae;Y++)for(be[Y]=[],se[Y]=[],xe[Y]=[],H=0;H<ae;H++)Y>H?(be[Y][H]=v[Y][H],se[Y][H]=xe[Y][H]=0):Y<H?(se[Y][H]=v[Y][H],be[Y][H]=xe[Y][H]=0):(xe[Y][H]=v[Y][H],be[Y][H]=se[Y][H]=0);for(T=o.multiply(o.inv(o.add(xe,o.multiply(be,L))),o.subtract(o.multiply(xe,1-L),o.multiply(se,L))),M=o.multiply(o.multiply(o.inv(o.add(xe,o.multiply(be,L))),m),L),N=C,G=o.add(o.multiply(T,C),M),Y=2;h.abs(o.norm(o.subtract(G,N)))>S;)N=G,G=o.add(o.multiply(T,N),M),Y++;return G},householder:function(v){for(var m,C,S,L,H=v.length,N=v[0].length,M=0,T=[],G=[];M<H-1;M++){for(m=0,L=M+1;L<N;L++)m+=v[L][M]*v[L][M];for(m=(v[M+1][M]>0?-1:1)*h.sqrt(m),C=h.sqrt((m*m-v[M+1][M]*m)/2),(T=o.zeros(H,1))[M+1][0]=(v[M+1][M]-m)/(2*C),S=M+2;S<H;S++)T[S][0]=v[S][M]/(2*C);G=o.subtract(o.identity(H,N),o.multiply(o.multiply(T,o.transpose(T)),2)),v=o.multiply(G,o.multiply(v,G))}return v},QR:(_=o.sum,V=o.arange,function(v){var m,C,S,L=v.length,H=v[0].length,N=o.zeros(H,H);for(v=o.copy(v),C=0;C<H;C++){for(N[C][C]=h.sqrt(_(V(L).map(function(M){return v[M][C]*v[M][C]}))),m=0;m<L;m++)v[m][C]=v[m][C]/N[C][C];for(S=C+1;S<H;S++)for(N[C][S]=_(V(L).map(function(M){return v[M][C]*v[M][S]})),m=0;m<L;m++)v[m][S]=v[m][S]-v[m][C]*N[C][S]}return[v,N]}),lstsq:function(v,m){var C=!1;m[0].length===void 0&&(m=m.map(function(ae){return[ae]}),C=!0);var S=o.QR(v),L=S[0],H=S[1],N=v[0].length,M=o.slice(L,{col:{end:N}}),T=function(ae){var be=(ae=o.copy(ae)).length,se=o.identity(be);return o.arange(be-1,-1,-1).forEach(function(xe){o.sliceAssign(se,{row:xe},o.divide(o.slice(se,{row:xe}),ae[xe][xe])),o.sliceAssign(ae,{row:xe},o.divide(o.slice(ae,{row:xe}),ae[xe][xe])),o.arange(xe).forEach(function(Se){var je=o.multiply(ae[Se][xe],-1),ie=o.slice(ae,{row:Se}),Fe=o.multiply(o.slice(ae,{row:xe}),je);o.sliceAssign(ae,{row:Se},o.add(ie,Fe));var $e=o.slice(se,{row:Se}),Ue=o.multiply(o.slice(se,{row:xe}),je);o.sliceAssign(se,{row:Se},o.add($e,Ue))})}),se}(o.slice(H,{row:{end:N}})),G=o.transpose(M);G[0].length===void 0&&(G=[G]);var Y=o.multiply(o.multiply(T,G),m);return Y.length===void 0&&(Y=[[Y]]),C?Y.map(function(ae){return ae[0]}):Y},jacobi:function(v){for(var m,C,S,L,H,N,M,T=1,G=v.length,Y=o.identity(G,G),ae=[];T===1;){for(H=v[0][1],S=0,L=1,m=0;m<G;m++)for(C=0;C<G;C++)m!=C&&H<h.abs(v[m][C])&&(H=h.abs(v[m][C]),S=m,L=C);for(N=v[S][S]===v[L][L]?v[S][L]>0?h.PI/4:-h.PI/4:h.atan(2*v[S][L]/(v[S][S]-v[L][L]))/2,(M=o.identity(G,G))[S][S]=h.cos(N),M[S][L]=-h.sin(N),M[L][S]=h.sin(N),M[L][L]=h.cos(N),Y=o.multiply(Y,M),v=o.multiply(o.multiply(o.inv(M),v),M),T=0,m=1;m<G;m++)for(C=1;C<G;C++)m!=C&&h.abs(v[m][C])>.001&&(T=1)}for(m=0;m<G;m++)ae.push(v[m][m]);return[Y,ae]},rungekutta:function(v,m,C,S,L,H){var N,M,T;if(H===2)for(;S<=C;)L+=((N=m*v(S,L))+(M=m*v(S+m,L+N)))/2,S+=m;if(H===4)for(;S<=C;)L+=((N=m*v(S,L))+2*(M=m*v(S+m/2,L+N/2))+2*(T=m*v(S+m/2,L+M/2))+m*v(S+m,L+T))/6,S+=m;return L},romberg:function(v,m,C,S){for(var L,H,N,M,T,G=0,Y=(C-m)/2,ae=[],be=[],se=[];G<S/2;){for(T=v(m),N=m,M=0;N<=C;N+=Y,M++)ae[M]=N;for(L=ae.length,N=1;N<L-1;N++)T+=(N%2!=0?4:2)*v(ae[N]);T=Y/3*(T+v(C)),se[G]=T,Y/=2,G++}for(H=se.length,L=1;H!==1;){for(N=0;N<H-1;N++)be[N]=(h.pow(4,L)*se[N+1]-se[N])/(h.pow(4,L)-1);H=be.length,se=be,be=[],L++}return se},richardson:function(v,m,C,S){function L(xe,Se){for(var je,ie=0,Fe=xe.length;ie<Fe;ie++)xe[ie]===Se&&(je=ie);return je}for(var H,N,M,T,G,Y=h.abs(C-v[L(v,C)+1]),ae=0,be=[],se=[];S>=Y;)H=L(v,C+S),N=L(v,C),be[ae]=(m[H]-2*m[N]+m[2*N-H])/(S*S),S/=2,ae++;for(T=be.length,M=1;T!=1;){for(G=0;G<T-1;G++)se[G]=(h.pow(4,M)*be[G+1]-be[G])/(h.pow(4,M)-1);T=se.length,be=se,se=[],M++}return be},simpson:function(v,m,C,S){for(var L,H=(C-m)/S,N=v(m),M=[],T=m,G=0,Y=1;T<=C;T+=H,G++)M[G]=T;for(L=M.length;Y<L-1;Y++)N+=(Y%2!=0?4:2)*v(M[Y]);return H/3*(N+v(C))},hermite:function(v,m,C,S){for(var L,H=v.length,N=0,M=0,T=[],G=[],Y=[],ae=[];M<H;M++){for(T[M]=1,L=0;L<H;L++)M!=L&&(T[M]*=(S-v[L])/(v[M]-v[L]));for(G[M]=0,L=0;L<H;L++)M!=L&&(G[M]+=1/(v[M]-v[L]));Y[M]=(1-2*(S-v[M])*G[M])*(T[M]*T[M]),ae[M]=(S-v[M])*(T[M]*T[M]),N+=Y[M]*m[M]+ae[M]*C[M]}return N},lagrange:function(v,m,C){for(var S,L,H=0,N=0,M=v.length;N<M;N++){for(L=m[N],S=0;S<M;S++)N!=S&&(L*=(C-v[S])/(v[N]-v[S]));H+=L}return H},cubic_spline:function(v,m,C){for(var S,L,H=v.length,N=0,M=[],T=[],G=[],Y=[],ae=[],be=[];N<H-1;N++)Y[N]=v[N+1]-v[N];for(G[0]=0,N=1;N<H-1;N++)G[N]=3/Y[N]*(m[N+1]-m[N])-3/Y[N-1]*(m[N]-m[N-1]);for(N=1;N<H-1;N++)M[N]=[],T[N]=[],M[N][N-1]=Y[N-1],M[N][N]=2*(Y[N-1]+Y[N]),M[N][N+1]=Y[N],T[N][0]=G[N];for(L=o.multiply(o.inv(M),T),S=0;S<H-1;S++)ae[S]=(m[S+1]-m[S])/Y[S]-Y[S]*(L[S+1][0]+2*L[S][0])/3,be[S]=(L[S+1][0]-L[S][0])/(3*Y[S]);for(S=0;S<H&&!(v[S]>C);S++);return m[S-=1]+(C-v[S])*ae[S]+o.sq(C-v[S])*L[S]+(C-v[S])*o.sq(C-v[S])*be[S]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(v){var m,C,S,L,H,N=v.length,M=v[0].length,T=0,G=[],Y=[],ae=[],be=[],se=[],xe=[],Se=[];for(T=0;T<N;T++)G[T]=o.sum(v[T])/M;for(T=0;T<M;T++)for(se[T]=[],m=0;m<N;m++)se[T][m]=v[m][T]-G[m];for(se=o.transpose(se),T=0;T<N;T++)for(xe[T]=[],m=0;m<N;m++)xe[T][m]=o.dot([se[T]],[se[m]])/(M-1);for(H=(S=o.jacobi(xe))[0],Y=S[1],Se=o.transpose(H),T=0;T<Y.length;T++)for(m=T;m<Y.length;m++)Y[T]<Y[m]&&(C=Y[T],Y[T]=Y[m],Y[m]=C,ae=Se[T],Se[T]=Se[m],Se[m]=ae);for(L=o.transpose(se),T=0;T<N;T++)for(be[T]=[],m=0;m<L.length;m++)be[T][m]=o.dot([Se[T]],[L[m]]);return[v,Y,Se,be]}}),function(v){for(var m=0;m<v.length;m++)(function(C){o.fn[C]=function(S,L){var H=this;return L?(setTimeout(function(){L.call(H,o.fn[C].call(H,S))},15),this):typeof o[C](this,S)=="number"?o[C](this,S):o(o[C](this,S))}})(v[m])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(d,Math),function(o,h){var _=[].slice,V=o.utils.isNumber,b=o.utils.isArray;function u(g,v,m,C){if(g>1||m>1||g<=0||m<=0)throw new Error("Proportions should be greater than 0 and less than 1");var S=(g*v+m*C)/(v+C);return(g-m)/h.sqrt(S*(1-S)*(1/v+1/C))}o.extend({zscore:function(){var g=_.call(arguments);return V(g[1])?(g[0]-g[1])/g[2]:(g[0]-o.mean(g[1]))/o.stdev(g[1],g[2])},ztest:function(){var g,v=_.call(arguments);return b(v[1])?(g=o.zscore(v[0],v[1],v[3]),v[2]===1?o.normal.cdf(-h.abs(g),0,1):2*o.normal.cdf(-h.abs(g),0,1)):v.length>2?(g=o.zscore(v[0],v[1],v[2]),v[3]===1?o.normal.cdf(-h.abs(g),0,1):2*o.normal.cdf(-h.abs(g),0,1)):(g=v[0],v[1]===1?o.normal.cdf(-h.abs(g),0,1):2*o.normal.cdf(-h.abs(g),0,1))}}),o.extend(o.fn,{zscore:function(g,v){return(g-this.mean())/this.stdev(v)},ztest:function(g,v,m){var C=h.abs(this.zscore(g,m));return v===1?o.normal.cdf(-C,0,1):2*o.normal.cdf(-C,0,1)}}),o.extend({tscore:function(){var g=_.call(arguments);return g.length===4?(g[0]-g[1])/(g[2]/h.sqrt(g[3])):(g[0]-o.mean(g[1]))/(o.stdev(g[1],!0)/h.sqrt(g[1].length))},ttest:function(){var g,v=_.call(arguments);return v.length===5?(g=h.abs(o.tscore(v[0],v[1],v[2],v[3])),v[4]===1?o.studentt.cdf(-g,v[3]-1):2*o.studentt.cdf(-g,v[3]-1)):V(v[1])?(g=h.abs(v[0]),v[2]==1?o.studentt.cdf(-g,v[1]-1):2*o.studentt.cdf(-g,v[1]-1)):(g=h.abs(o.tscore(v[0],v[1])),v[2]==1?o.studentt.cdf(-g,v[1].length-1):2*o.studentt.cdf(-g,v[1].length-1))}}),o.extend(o.fn,{tscore:function(g){return(g-this.mean())/(this.stdev(!0)/h.sqrt(this.cols()))},ttest:function(g,v){return v===1?1-o.studentt.cdf(h.abs(this.tscore(g)),this.cols()-1):2*o.studentt.cdf(-h.abs(this.tscore(g)),this.cols()-1)}}),o.extend({anovafscore:function(){var g,v,m,C,S,L,H,N,M=_.call(arguments);if(M.length===1){for(S=new Array(M[0].length),H=0;H<M[0].length;H++)S[H]=M[0][H];M=S}for(v=new Array,H=0;H<M.length;H++)v=v.concat(M[H]);for(m=o.mean(v),g=0,H=0;H<M.length;H++)g+=M[H].length*h.pow(o.mean(M[H])-m,2);for(g/=M.length-1,L=0,H=0;H<M.length;H++)for(C=o.mean(M[H]),N=0;N<M[H].length;N++)L+=h.pow(M[H][N]-C,2);return g/(L/(v.length-M.length))},anovaftest:function(){var g,v,m,C,S=_.call(arguments);if(V(S[0]))return 1-o.centralF.cdf(S[0],S[1],S[2]);var L=o.anovafscore(S);for(g=S.length-1,m=0,C=0;C<S.length;C++)m+=S[C].length;return v=m-g-1,1-o.centralF.cdf(L,g,v)},ftest:function(g,v,m){return 1-o.centralF.cdf(g,v,m)}}),o.extend(o.fn,{anovafscore:function(){return o.anovafscore(this.toArray())},anovaftes:function(){var g,v=0;for(g=0;g<this.length;g++)v+=this[g].length;return o.ftest(this.anovafscore(),this.length-1,v-this.length)}}),o.extend({qscore:function(){var g,v,m,C,S,L=_.call(arguments);return V(L[0])?(g=L[0],v=L[1],m=L[2],C=L[3],S=L[4]):(g=o.mean(L[0]),v=o.mean(L[1]),m=L[0].length,C=L[1].length,S=L[2]),h.abs(g-v)/(S*h.sqrt((1/m+1/C)/2))},qtest:function(){var g,v=_.call(arguments);v.length===3?(g=v[0],v=v.slice(1)):v.length===7?(g=o.qscore(v[0],v[1],v[2],v[3],v[4]),v=v.slice(5)):(g=o.qscore(v[0],v[1],v[2]),v=v.slice(3));var m=v[0],C=v[1];return 1-o.tukey.cdf(g,C,m-C)},tukeyhsd:function(g){for(var v=o.pooledstdev(g),m=g.map(function(M){return o.mean(M)}),C=g.reduce(function(M,T){return M+T.length},0),S=[],L=0;L<g.length;++L)for(var H=L+1;H<g.length;++H){var N=o.qtest(m[L],m[H],g[L].length,g[H].length,v,C,g.length);S.push([[L,H],N])}return S}}),o.extend({normalci:function(){var g,v=_.call(arguments),m=new Array(2);return g=v.length===4?h.abs(o.normal.inv(v[1]/2,0,1)*v[2]/h.sqrt(v[3])):h.abs(o.normal.inv(v[1]/2,0,1)*o.stdev(v[2])/h.sqrt(v[2].length)),m[0]=v[0]-g,m[1]=v[0]+g,m},tci:function(){var g,v=_.call(arguments),m=new Array(2);return g=v.length===4?h.abs(o.studentt.inv(v[1]/2,v[3]-1)*v[2]/h.sqrt(v[3])):h.abs(o.studentt.inv(v[1]/2,v[2].length-1)*o.stdev(v[2],!0)/h.sqrt(v[2].length)),m[0]=v[0]-g,m[1]=v[0]+g,m},significant:function(g,v){return g<v}}),o.extend(o.fn,{normalci:function(g,v){return o.normalci(g,v,this.toArray())},tci:function(g,v){return o.tci(g,v,this.toArray())}}),o.extend(o.fn,{oneSidedDifferenceOfProportions:function(g,v,m,C){var S=u(g,v,m,C);return o.ztest(S,1)},twoSidedDifferenceOfProportions:function(g,v,m,C){var S=u(g,v,m,C);return o.ztest(S,2)}})}(d,Math),d.models=function(){function o(h,_){var V=h.length,b=_[0].length-1,u=V-b-1,g=d.lstsq(_,h),v=d.multiply(_,g.map(function(N){return[N]})).map(function(N){return N[0]}),m=d.subtract(h,v),C=d.mean(h),S=d.sum(v.map(function(N){return Math.pow(N-C,2)})),L=d.sum(h.map(function(N,M){return Math.pow(N-v[M],2)})),H=S+L;return{exog:_,endog:h,nobs:V,df_model:b,df_resid:u,coef:g,predict:v,resid:m,ybar:C,SST:H,SSE:S,SSR:L,R2:S/H}}return{ols:function(h,_){var V=o(h,_),b=function(v){var m,C,S=(m=v.exog,C=m[0].length,d.arange(C).map(function(Y){var ae=d.arange(C).filter(function(be){return be!==Y});return o(d.col(m,Y).map(function(be){return be[0]}),d.col(m,ae))})),L=Math.sqrt(v.SSR/v.df_resid),H=S.map(function(Y){var ae=Y.SST,be=Y.R2;return L/Math.sqrt(ae*(1-be))}),N=v.coef.map(function(Y,ae){return(Y-0)/H[ae]}),M=N.map(function(Y){var ae=d.studentt.cdf(Y,v.df_resid);return 2*(ae>.5?1-ae:ae)}),T=d.studentt.inv(.975,v.df_resid),G=v.coef.map(function(Y,ae){var be=T*H[ae];return[Y-be,Y+be]});return{se:H,t:N,p:M,sigmaHat:L,interval95:G}}(V),u=function(v){var m,C,S,L=v.R2/v.df_model/((1-v.R2)/v.df_resid);return{F_statistic:L,pvalue:1-(m=L,C=v.df_model,S=v.df_resid,d.beta.cdf(m/(S/C+m),C/2,S/2))}}(V),g=1-(1-V.R2)*((V.nobs-1)/V.df_resid);return V.t=b,V.f=u,V.adjust_R2=g,V}}}(),d.extend({buildxmatrix:function(){for(var o=new Array(arguments.length),h=0;h<arguments.length;h++)o[h]=[1].concat(arguments[h]);return d(o)},builddxmatrix:function(){for(var o=new Array(arguments[0].length),h=0;h<arguments[0].length;h++)o[h]=[1].concat(arguments[0][h]);return d(o)},buildjxmatrix:function(o){for(var h=new Array(o.length),_=0;_<o.length;_++)h[_]=o[_];return d.builddxmatrix(h)},buildymatrix:function(o){return d(o).transpose()},buildjymatrix:function(o){return o.transpose()},matrixmult:function(o,h){var _,V,b,u,g;if(o.cols()==h.rows()){if(h.rows()>1){for(u=[],_=0;_<o.rows();_++)for(u[_]=[],V=0;V<h.cols();V++){for(g=0,b=0;b<o.cols();b++)g+=o.toArray()[_][b]*h.toArray()[b][V];u[_][V]=g}return d(u)}for(u=[],_=0;_<o.rows();_++)for(u[_]=[],V=0;V<h.cols();V++){for(g=0,b=0;b<o.cols();b++)g+=o.toArray()[_][b]*h.toArray()[V];u[_][V]=g}return d(u)}},regress:function(o,h){var _=d.xtranspxinv(o),V=o.transpose(),b=d.matrixmult(d(_),V);return d.matrixmult(b,h)},regresst:function(o,h,_){var V=d.regress(o,h),b={anova:{}},u=d.jMatYBar(o,V);b.yBar=u;var g=h.mean();b.anova.residuals=d.residuals(h,u),b.anova.ssr=d.ssr(u,g),b.anova.msr=b.anova.ssr/(o[0].length-1),b.anova.sse=d.sse(h,u),b.anova.mse=b.anova.sse/(h.length-(o[0].length-1)-1),b.anova.sst=d.sst(h,g),b.anova.mst=b.anova.sst/(h.length-1),b.anova.r2=1-b.anova.sse/b.anova.sst,b.anova.r2<0&&(b.anova.r2=0),b.anova.fratio=b.anova.msr/b.anova.mse,b.anova.pvalue=d.anovaftest(b.anova.fratio,o[0].length-1,h.length-(o[0].length-1)-1),b.anova.rmse=Math.sqrt(b.anova.mse),b.anova.r2adj=1-b.anova.mse/b.anova.mst,b.anova.r2adj<0&&(b.anova.r2adj=0),b.stats=new Array(o[0].length);for(var v,m,C,S=d.xtranspxinv(o),L=0;L<V.length;L++)v=Math.sqrt(b.anova.mse*Math.abs(S[L][L])),m=Math.abs(V[L]/v),C=d.ttest(m,h.length-o[0].length-1,_),b.stats[L]=[V[L],v,m,C];return b.regress=V,b},xtranspx:function(o){return d.matrixmult(o.transpose(),o)},xtranspxinv:function(o){var h=d.matrixmult(o.transpose(),o);return d.inv(h)},jMatYBar:function(o,h){var _=d.matrixmult(o,h);return new d(_)},residuals:function(o,h){return d.matrixsubtract(o,h)},ssr:function(o,h){for(var _=0,V=0;V<o.length;V++)_+=Math.pow(o[V]-h,2);return _},sse:function(o,h){for(var _=0,V=0;V<o.length;V++)_+=Math.pow(o[V]-h[V],2);return _},sst:function(o,h){for(var _=0,V=0;V<o.length;V++)_+=Math.pow(o[V]-h,2);return _},matrixsubtract:function(o,h){for(var _=new Array(o.length),V=0;V<o.length;V++){_[V]=new Array(o[V].length);for(var b=0;b<o[V].length;b++)_[V][b]=o[V][b]-h[V][b]}return d(_)}}),d.jStat=d,d)},960:function(q,d,o){const h=o(592);q.exports=function(_){function V(L,H){const N=H.split(".");let M=L;for(const T of N){if(M==null)return;M=M[T]}return M}for(let L=0;L<Object.keys(h).length;L++){let H,N=Object.keys(h)[L],M=[];if(typeof h[N]=="object"){M=Object.keys(h[N]),H=Object.values(h[N]);for(let T=0;T<H.length;T++)if(typeof H[T]=="object"){let G=M[T];h[N][G]&&(M=[...M,...Object.keys(h[N][G]).map(Y=>G+"."+Y)],M.splice(M.indexOf(G),1))}}if(M.length<1)_[N]=h[N];else for(let T=0;T<M.length;T++)typeof V(h[N],M[T])=="function"&&(_[N]=V(h[N],M[T]))}let b=function(L){return typeof L=="number"&&(L=parseInt(L)),L},u=null,g=null,v=null;_.TABLE=function(){return v},_.COLUMN=_.COL=function(){return v.tracking&&v.tracking.push(S.getColumnNameFromCoords(b(u),b(g))),b(u)+1},_.ROW=function(){return v.tracking&&v.tracking.push(S.getColumnNameFromCoords(b(u),b(g))),b(g)+1},_.CELL=function(){return S.getColumnNameFromCoords(u,g)},_.VALUE=function(L,H,N){return v.getValueFromCoords(b(L)-1,b(H)-1,N)},_.THISROWCELL=function(L){return v.getValueFromCoords(b(L)-1,b(g))};const m=function(L,H){for(let N=0;N<L.length;N++){let M=S.getTokensFromRange(L[N]);H=H.replace(L[N],"["+M.join(",")+"]")}return H},C=function(L){return typeof L=="string"&&(L=L.trim()),!isNaN(L)&&L!==null&&L!==""},S=function(L,H,N,M,T){v=T,u=N,g=M;let G="",Y={};if(H)if(H.size){let se,xe=null;H.forEach(function(Se,je){se=je.replace(/!/g,"."),se.indexOf(".")!==-1&&(se=se.split("."),Y[se[0]]=!0)}),se=Object.keys(Y);for(let Se=0;Se<se.length;Se++)G+="var "+se[Se]+" = {};";H.forEach(function(Se,je){se=je.replace(/!/g,"."),Se===null||C(Se)||(xe=Se.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g),xe&&xe.length&&(Se=updateRanges(xe,Se))),se.indexOf(".")>0?G+=se+" = "+H.get(je)+`;
`:G+="var "+se+" = "+Se+`;
`})}else{let se=Object.keys(H);if(se.length){let xe,Se={};for(let je=0;je<se.length;je++)if(xe=se[je].replace(/\!/g,"."),xe.indexOf(".")>0){let ie=ie.split(".");Se[ie[0]]={}}xe=Object.keys(Se);for(let je=0;je<xe.length;je++)G+="var "+xe[je]+" = {};";for(let je=0;je<se.length;je++){if(xe=se[je].replace(/!/g,"."),H[se[je]]!==null&&!C(H[se[je]])){let ie=H[se[je]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);ie&&ie.length&&(H[se[je]]=m(ie,H[se[je]]))}xe.indexOf(".")>0?G+=xe+" = "+H[se[je]]+`;
`:G+="var "+xe+" = "+H[se[je]]+`;
`}}}let ae=(L=function(se,xe){let Se="",je=0,ie=["=","!",">","<"];for(let Fe=0;Fe<se.length;Fe++)se[Fe]==='"'&&(je=je===0?1:0),je===1?Se+=se[Fe]:(Se+=se[Fe].toUpperCase(),Fe>0&&se[Fe]==="="&&ie.indexOf(se[Fe-1])===-1&&ie.indexOf(se[Fe+1])===-1&&(Se+="="));return Se=Se.replace(/\^/g,"**"),Se=Se.replace(/<>/g,"!="),Se=Se.replace(/&/g,"+"),Se=Se.replace(/\$/g,""),Se}(L=(L=L.replace(/\$/g,"")).replace(/!/g,"."))).match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);ae&&ae.length&&(L=m(ae,L));let be=new Function(G+"; return "+L)();return be===null&&(be=0),be};return S.getColumnNameFromCoords=function(L,H){return M="",(N=parseInt(L))>701?(M+=String.fromCharCode(64+parseInt(N/676)),M+=String.fromCharCode(64+parseInt(N%676/26))):N>25&&(M+=String.fromCharCode(64+parseInt(N/26))),M+String.fromCharCode(65+N%26)+(parseInt(H)+1);var N,M},S.getCoordsFromColumnName=function(L){var H=/^[a-zA-Z]+/.exec(L);if(H){for(var N=0,M=0;M<H[0].length;M++)N+=parseInt(H[0].charCodeAt(M)-64)*Math.pow(26,H[0].length-1-M);--N<0&&(N=0);var T=parseInt(/[0-9]+$/.exec(L))||null;return T>0&&T--,[N,T]}},S.getRangeFromTokens=function(L){L=L.filter(function(T){return T!="#REF!"});for(var H="",N="",M=0;M<L.length;M++)L[M].indexOf(".")>=0?H=".":L[M].indexOf("!")>=0&&(H="!"),H&&(N=L[M].split(H),L[M]=N[1],N=N[0]+H);return L.sort(function(T,G){var Y=Helpers.getCoordsFromColumnName(T),ae=Helpers.getCoordsFromColumnName(G);return Y[1]>ae[1]?1:Y[1]<ae[1]?-1:Y[0]>ae[0]?1:Y[0]<ae[0]?-1:0}),L.length?N+(L[0]+":")+L[L.length-1]:"#REF!"},S.getTokensFromRange=function(L){if(L.indexOf(".")>0){var H=L.split(".");L=H[1],H=H[0]+"."}else L.indexOf("!")>0?(H=L.split("!"),L=H[1],H=H[0]+"!"):H="";L=L.split(":");var N=S.getCoordsFromColumnName(L[0]),M=S.getCoordsFromColumnName(L[1]);if(N[0]<=M[0])var T=N[0],G=M[0];else T=M[0],G=N[0];if(N[1]===null&&M[1]==null)for(var Y=null,ae=null,be=Object.keys(vars),se=0;se<be.length;se++){var xe=S.getCoordsFromColumnName(be[se]);xe[0]===N[0]&&(Y===null||xe[1]<Y)&&(Y=xe[1]),xe[0]===M[0]&&(ae===null||xe[1]>ae)&&(ae=xe[1])}else N[1]<=M[1]?(Y=N[1],ae=M[1]):(Y=M[1],ae=N[1]);for(var Se=[],je=Y;je<=ae;je++){var ie=[];for(se=T;se<=G;se++)ie.push(H+S.getColumnNameFromCoords(se,je));Se.push(ie)}return Se},S.setFormula=function(L){let H=Object.keys(L);for(let N=0;N<H.length;N++)typeof L[H[N]]=="function"&&(_[H[N]]=L[H[N]])},S.basic=!0,S}(typeof window>"u"?o.g:window)},592:function(q,d,o){var h=o(162),_=o(765);const V=new Error("#NULL!"),b=new Error("#DIV/0!"),u=new Error("#VALUE!"),g=new Error("#REF!"),v=new Error("#NAME?"),m=new Error("#NUM!"),C=new Error("#N/A"),S=new Error("#ERROR!"),L=new Error("#GETTING_DATA");var H=Object.freeze({__proto__:null,data:L,div0:b,error:S,na:C,name:v,nil:V,num:m,ref:g,value:u});function N(e){const t=[];return M(e,s=>{t.push(s)}),t}function M(e,t){let s=-1;const p=e.length;for(;++s<p&&t(e[s],s,e)!==!1;);return e}function T(e){let t,s=e.length;for(;s--;)if(t=e[s],typeof t!="number")if(t!==!0)if(t!==!1){if(typeof t=="string"){const p=U(t);e[s]=p instanceof Error?0:p}}else e[s]=0;else e[s]=1;return e}function G(e,t){if(!e)return u;e.every(E=>Array.isArray(E))&&e.length!==0||(e=[[...e]]),e.map((E,O)=>{E.map((z,re)=>{z||(e[O][re]=0)})});const s=e.reduce((E,O,z)=>O.length>e[E].length?z:E,0),p=e[s].length;return e.map(E=>[...E,...Array(p-E.length).fill(0)])}function Y(){let e;if(arguments.length===1){const s=arguments[0];e=(t=s)!=null&&typeof t.length=="number"&&typeof t!="string"?N.apply(null,arguments):[s]}else e=Array.from(arguments);for(var t;!be(e);)e=ae(e);return e}function ae(e){return e&&e.reduce?e.reduce((t,s)=>{const p=Array.isArray(t),E=Array.isArray(s);return p&&E?t.concat(s):p?(t.push(s),t):E?[t].concat(s):[t,s]}):[e]}function be(e){if(!e)return!1;for(let t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0}function se(e,t){return t=t||1,e&&typeof e.slice=="function"?e.slice(t):e}function xe(e){return e?e[0].map((t,s)=>e.map(p=>p[s])):u}function Se(e,t){let s=null;return M(e,(p,E)=>{if(p[0]===t)return s=E,!1}),s??u}function je(){for(let e=0;e<arguments.length;e++)if(arguments[e]instanceof Error)return arguments[e]}function ie(){let e=arguments.length;for(;e--;)if(arguments[e]instanceof Error)return!0;return!1}function Fe(e){return Math.round(e*1e14)/1e14}function $e(){return Y.apply(null,arguments).filter(e=>typeof e=="number")}function Ue(e){if(typeof e=="boolean"||e instanceof Error)return e;if(typeof e=="number")return e!==0;if(typeof e=="string"){const t=e.toUpperCase();if(t==="TRUE")return!0;if(t==="FALSE")return!1}return e instanceof Date&&!isNaN(e)||u}function He(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);const t=parseFloat(e);return t<0||t>=2958466?m:function(s){s<60&&(s+=1);const p=Math.floor(s-25569),E=new Date(86400*p*1e3),O=s-Math.floor(s)+1e-7;let z=Math.floor(86400*O);const re=z%60;z-=re;const pe=Math.floor(z/3600),ke=Math.floor(z/60)%60;let De=E.getUTCDate(),Pe=E.getUTCMonth();return s>=60&&s<61&&(De=29,Pe=1),new Date(E.getUTCFullYear(),Pe,De,pe,ke,re)}(t)}return typeof e!="string"||(e=/(\d{4})-(\d\d?)-(\d\d?)$/.test(e)?new Date(e+"T00:00:00.000"):new Date(e),isNaN(e))?u:e}function lt(e){let t,s=e.length;for(;s--;){if(t=He(e[s]),t===u)return t;e[s]=t}return e}function U(e){return e instanceof Error?e:e==null?0:(typeof e=="boolean"&&(e=+e),isNaN(e)||e===""?u:parseFloat(e))}function Ee(e){let t,s;if(!e||(t=e.length)===0)return u;for(;t--;){if(e[t]instanceof Error)return e[t];if(s=U(e[t]),s instanceof Error)return s;e[t]=s}return e}function Ye(e){return e instanceof Error?e:e==null?"":e.toString()}function ht(){let e=arguments.length;for(;e--;)if(typeof arguments[e]=="string")return!0;return!1}function Ie(e){return e!=null}const Me="=",Te=[">",">=","<","<=","=","<>"],ze="operator",Ge="literal",Qe=[ze,Ge],ct=ze,it=Ge;function dt(e,t){if(Qe.indexOf(t)===-1)throw new Error("Unsupported token type: "+t);return{value:e,type:t}}function jt(e){return function(t){let s="";const p=[];for(let E=0;E<t.length;E++){const O=t[E];E===0&&Te.indexOf(O)>=0?p.push(dt(O,ct)):s+=O}return s.length>0&&p.push(dt(function(E){return typeof E!="string"||/^\d+(\.\d+)?$/.test(E)&&(E=E.indexOf(".")===-1?parseInt(E,10):parseFloat(E)),E}(s),it)),p.length>0&&p[0].type!==ct&&p.unshift(dt(Me,ct)),p}(function(t){const s=t.length,p=[];let E=0,O="",z="";for(;E<s;){const re=t.charAt(E);switch(re){case">":case"<":case"=":z+=re,O.length>0&&(p.push(O),O="");break;default:z.length>0&&(p.push(z),z=""),O+=re}E++}return O.length>0&&p.push(O),z.length>0&&p.push(z),p}(e))}const mt=function(e){const t=[];let s;for(let p=0;p<e.length;p++){const E=e[p];switch(E.type){case ct:s=E.value;break;case it:t.push(E.value)}}return function(p,E){let O=!1;switch(E){case">":O=p[0]>p[1];break;case">=":O=p[0]>=p[1];break;case"<":O=p[0]<p[1];break;case"<=":O=p[0]<=p[1];break;case"=":O=p[0]==p[1];break;case"<>":O=p[0]!=p[1]}return O}(t,s)},Rt={};function Dt(e){return[u,g,b,m,v,V].indexOf(e)>=0||typeof e=="number"&&(isNaN(e)||!isFinite(e))}function ft(e){return Dt(e)||e===C}function Nt(e){return e===!0||e===!1}function St(e){return typeof e=="number"&&!isNaN(e)&&isFinite(e)}function j(e){return typeof e=="string"}function A(){const e=[];for(let t=0;t<arguments.length;++t){let s=!1;const p=arguments[t];for(let E=0;E<e.length&&(s=e[E]===p,!s);++E);s||e.push(p)}return e}function l(e,t,s,p){if(!t||!s)return C;p=!(p===0||p===!1);let E=C;const O=typeof e=="number";let z=!1;for(let re=0;re<t.length;re++){const pe=t[re];if(pe[0]===e){E=s<pe.length+1?pe[s-1]:g;break}!z&&(O&&p&&pe[0]<=e||p&&typeof pe[0]=="string"&&pe[0].localeCompare(e)<0)&&(E=s<pe.length+1?pe[s-1]:g),O&&pe[0]>e&&(z=!0)}return E}function r(){const e=Y(arguments).filter(Ie);if(e.length===0)return b;const t=je.apply(void 0,e);if(t)return t;const s=$e(e),p=s.length;let E,O=0,z=0;for(let re=0;re<p;re++)O+=s[re],z+=1;return E=O/z,isNaN(E)&&(E=m),E}function F(){const e=Y(arguments).filter(Ie);if(e.length===0)return b;const t=je.apply(void 0,e);if(t)return t;const s=e,p=s.length;let E,O=0,z=0;for(let re=0;re<p;re++){const pe=s[re];typeof pe=="number"&&(O+=pe),pe===!0&&O++,pe!==null&&z++}return E=O/z,isNaN(E)&&(E=m),E}Rt.TYPE=e=>{switch(e){case V:return 1;case b:return 2;case u:return 3;case g:return 4;case v:return 5;case m:return 6;case C:return 7;case L:return 8}return C};const Q={DIST:function(e,t,s,p,E,O){return arguments.length<4?u:(E=E===void 0?0:E,O=O===void 0?1:O,ie(e=U(e),t=U(t),s=U(s),E=U(E),O=U(O))?u:(e=(e-E)/(O-E),p?h.beta.cdf(e,t,s):h.beta.pdf(e,t,s)))},INV:(e,t,s,p,E)=>(p=p===void 0?0:p,E=E===void 0?1:E,ie(e=U(e),t=U(t),s=U(s),p=U(p),E=U(E))?u:h.beta.inv(e,t,s)*(E-p)+p)},ee={DIST:(e,t,s,p)=>ie(e=U(e),t=U(t),s=U(s),p=U(p))?u:p?h.binomial.cdf(e,t,s):h.binomial.pdf(e,t,s)};ee.DIST.RANGE=(e,t,s,p)=>{if(p=p===void 0?s:p,ie(e=U(e),t=U(t),s=U(s),p=U(p)))return u;let E=0;for(let O=s;O<=p;O++)E+=at(e,O)*Math.pow(t,O)*Math.pow(1-t,e-O);return E},ee.INV=(e,t,s)=>{if(ie(e=U(e),t=U(t),s=U(s)))return u;let p=0;for(;p<=e;){if(h.binomial.cdf(p,e,t)>=s)return p;p++}};const D={DIST:(e,t,s)=>ie(e=U(e),t=U(t))?u:s?h.chisquare.cdf(e,t):h.chisquare.pdf(e,t)};D.DIST.RT=(e,t)=>!e|!t?C:e<1||t>Math.pow(10,10)?m:typeof e!="number"||typeof t!="number"?u:1-h.chisquare.cdf(e,t),D.INV=(e,t)=>ie(e=U(e),t=U(t))?u:h.chisquare.inv(e,t),D.INV.RT=(e,t)=>!e|!t?C:e<0||e>1||t<1||t>Math.pow(10,10)?m:typeof e!="number"||typeof t!="number"?u:h.chisquare.inv(1-e,t),D.TEST=function(e,t){if(arguments.length!==2)return C;if(!(e instanceof Array&&t instanceof Array)||e.length!==t.length||e[0]&&t[0]&&e[0].length!==t[0].length)return u;const s=e.length;let p,E,O;for(E=0;E<s;E++)e[E]instanceof Array||(p=e[E],e[E]=[],e[E].push(p)),t[E]instanceof Array||(p=t[E],t[E]=[],t[E].push(p));const z=e[0].length,re=z===1?s-1:(s-1)*(z-1);let pe=0;const ke=Math.PI;for(E=0;E<s;E++)for(O=0;O<z;O++)pe+=Math.pow(e[E][O]-t[E][O],2)/t[E][O];return Math.round(1e6*function(De,Pe){let _e=Math.exp(-.5*De);Pe%2==1&&(_e*=Math.sqrt(2*De/ke));let Xe=Pe;for(;Xe>=2;)_e=_e*De/Xe,Xe-=2;let et=_e,nt=Pe;for(;et>1e-10*_e;)nt+=2,et=et*De/nt,_e+=et;return 1-_e}(pe,re))/1e6};const I={};function B(){return $e(Y(arguments)).length}function K(){const e=Y(arguments);return e.length-ne(e)}function ne(){const e=Y(arguments);let t,s=0;for(let p=0;p<e.length;p++)t=e[p],t!=null&&t!==""||s++;return s}I.NORM=(e,t,s)=>ie(e=U(e),t=U(t),s=U(s))?u:h.normalci(1,e,t,s)[1]-1,I.T=(e,t,s)=>ie(e=U(e),t=U(t),s=U(s))?u:h.tci(1,e,t,s)[1]-1;const ge={P:(e,t)=>{if(ie(e=Ee(Y(e)),t=Ee(Y(t))))return u;const s=h.mean(e),p=h.mean(t);let E=0;const O=e.length;for(let z=0;z<O;z++)E+=(e[z]-s)*(t[z]-p);return E/O},S:(e,t)=>ie(e=Ee(Y(e)),t=Ee(Y(t)))?u:h.covariance(e,t)},de={DIST:(e,t,s)=>ie(e=U(e),t=U(t))?u:s?h.exponential.cdf(e,t):h.exponential.pdf(e,t)},fe={};function le(e,t,s){if(ie(e=U(e),t=Ee(Y(t)),s=Ee(Y(s))))return u;const p=h.mean(s),E=h.mean(t),O=s.length;let z=0,re=0;for(let ke=0;ke<O;ke++)z+=(s[ke]-p)*(t[ke]-E),re+=Math.pow(s[ke]-p,2);const pe=z/re;return E-pe*p+pe*e}function he(e){return(e=U(e))instanceof Error?e:e===0||parseInt(e,10)===e&&e<0?m:h.gammafn(e)}function Le(e){return(e=U(e))instanceof Error?e:h.gammaln(e)}fe.DIST=(e,t,s,p)=>ie(e=U(e),t=U(t),s=U(s))?u:p?h.centralF.cdf(e,t,s):h.centralF.pdf(e,t,s),fe.DIST.RT=function(e,t,s){return arguments.length!==3?C:e<0||t<1||s<1?m:typeof e!="number"||typeof t!="number"||typeof s!="number"?u:1-h.centralF.cdf(e,t,s)},fe.INV=(e,t,s)=>ie(e=U(e),t=U(t),s=U(s))?u:e<=0||e>1?m:h.centralF.inv(e,t,s),fe.INV.RT=function(e,t,s){return arguments.length!==3?C:e<0||e>1||t<1||t>Math.pow(10,10)||s<1||s>Math.pow(10,10)?m:typeof e!="number"||typeof t!="number"||typeof s!="number"?u:h.centralF.inv(1-e,t,s)},fe.TEST=(e,t)=>{if(!e||!t||!(e instanceof Array&&t instanceof Array))return C;if(e.length<2||t.length<2)return b;const s=(O,z)=>{let re=0;for(let pe=0;pe<O.length;pe++)re+=Math.pow(O[pe]-z,2);return re},p=kt(e)/e.length,E=kt(t)/t.length;return s(e,p)/(e.length-1)/(s(t,E)/(t.length-1))},he.DIST=function(e,t,s,p){return arguments.length!==4?C:e<0||t<=0||s<=0||typeof e!="number"||typeof t!="number"||typeof s!="number"?u:p?h.gamma.cdf(e,t,s,!0):h.gamma.pdf(e,t,s,!1)},he.INV=function(e,t,s){return arguments.length!==3?C:e<0||e>1||t<=0||s<=0?m:typeof e!="number"||typeof t!="number"||typeof s!="number"?u:h.gamma.inv(e,t,s)},Le.PRECISE=function(e){return arguments.length!==1?C:e<=0?m:typeof e!="number"?u:h.gammaln(e)};const We={};function Je(e,t){return ie(e=Ee(Y(e)),t=U(t))?e:t<0||e.length<t?u:e.sort((s,p)=>p-s)[t-1]}function ce(e,t){if(ie(e=Ee(Y(e)),t=Ee(Y(t))))return u;const s=h.mean(e),p=h.mean(t),E=t.length;let O=0,z=0;for(let pe=0;pe<E;pe++)O+=(t[pe]-p)*(e[pe]-s),z+=Math.pow(t[pe]-p,2);const re=O/z;return[re,s-re*p]}We.DIST=(e,t,s,p,E)=>{if(ie(e=U(e),t=U(t),s=U(s),p=U(p)))return u;function O(z,re,pe,ke){return at(pe,z)*at(ke-pe,re-z)/at(ke,re)}return E?function(z,re,pe,ke){let De=0;for(let Pe=0;Pe<=z;Pe++)De+=O(Pe,re,pe,ke);return De}(e,t,s,p):O(e,t,s,p)};const Ae={};function X(){const e=Y(arguments),t=je.apply(void 0,e);if(t)return t;const s=$e(e);return s.length===0?0:Math.max.apply(Math,s)}function W(){const e=Y(arguments),t=je.apply(void 0,e);if(t)return t;const s=T(e);let p=h.median(s);return isNaN(p)&&(p=m),p}function oe(){const e=Y(arguments),t=je.apply(void 0,e);if(t)return t;const s=$e(e);return s.length===0?0:Math.min.apply(Math,s)}Ae.DIST=(e,t,s,p)=>ie(e=U(e),t=U(t),s=U(s))?u:p?h.lognormal.cdf(e,t,s):h.lognormal.pdf(e,t,s),Ae.INV=(e,t,s)=>ie(e=U(e),t=U(t),s=U(s))?u:h.lognormal.inv(e,t,s);const w={MULT:function(){const e=Ee(Y(arguments));if(e instanceof Error)return e;const t=e.length,s={};let p,E=[],O=0;for(let z=0;z<t;z++)p=e[z],s[p]=s[p]?s[p]+1:1,s[p]>O&&(O=s[p],E=[]),s[p]===O&&(E[E.length]=p);return E},SNGL:function(){const e=Ee(Y(arguments));return e instanceof Error?e:w.MULT(e).sort((t,s)=>t-s)[0]}},P={DIST:(e,t,s,p)=>ie(e=U(e),t=U(t),s=U(s))?u:p?h.negbin.cdf(e,t,s):h.negbin.pdf(e,t,s)},J={};function me(e,t){if(ie(t=Ee(Y(t)),e=Ee(Y(e))))return u;const s=h.mean(e),p=h.mean(t),E=e.length;let O=0,z=0,re=0;for(let pe=0;pe<E;pe++)O+=(e[pe]-s)*(t[pe]-p),z+=Math.pow(e[pe]-s,2),re+=Math.pow(t[pe]-p,2);return O/Math.sqrt(z*re)}J.DIST=(e,t,s,p)=>ie(e=U(e),t=U(t),s=U(s))?u:s<=0?m:p?h.normal.cdf(e,t,s):h.normal.pdf(e,t,s),J.INV=(e,t,s)=>ie(e=U(e),t=U(t),s=U(s))?u:h.normal.inv(e,t,s),J.S={},J.S.DIST=(e,t)=>(e=U(e))instanceof Error?u:t?h.normal.cdf(e,0,1):h.normal.pdf(e,0,1),J.S.INV=e=>(e=U(e))instanceof Error?u:h.normal.inv(e,0,1);const Z={EXC:(e,t)=>{if(ie(e=Ee(Y(e)),t=U(t)))return u;const s=(e=e.sort((O,z)=>O-z)).length;if(t<1/(s+1)||t>1-1/(s+1))return m;const p=t*(s+1)-1,E=Math.floor(p);return Fe(p===E?e[p]:e[E]+(p-E)*(e[E+1]-e[E]))},INC:(e,t)=>{if(ie(e=Ee(Y(e)),t=U(t)))return u;const s=t*((e=e.sort((E,O)=>E-O)).length-1),p=Math.floor(s);return Fe(s===p?e[s]:e[p]+(s-p)*(e[p+1]-e[p]))}},ue={EXC:(e,t,s)=>{if(s=s===void 0?3:s,ie(e=Ee(Y(e)),t=U(t),s=U(s)))return u;e=e.sort((De,Pe)=>De-Pe);const p=A.apply(null,e),E=e.length,O=p.length,z=Math.pow(10,s);let re=0,pe=!1,ke=0;for(;!pe&&ke<O;)t===p[ke]?(re=(e.indexOf(p[ke])+1)/(E+1),pe=!0):t>=p[ke]&&(t<p[ke+1]||ke===O-1)&&(re=(e.indexOf(p[ke])+1+(t-p[ke])/(p[ke+1]-p[ke]))/(E+1),pe=!0),ke++;return Math.floor(re*z)/z},INC:(e,t,s)=>{if(s=s===void 0?3:s,ie(e=Ee(Y(e)),t=U(t),s=U(s)))return u;e=e.sort((De,Pe)=>De-Pe);const p=A.apply(null,e),E=e.length,O=p.length,z=Math.pow(10,s);let re=0,pe=!1,ke=0;for(;!pe&&ke<O;)t===p[ke]?(re=e.indexOf(p[ke])/(E-1),pe=!0):t>=p[ke]&&(t<p[ke+1]||ke===O-1)&&(re=(e.indexOf(p[ke])+(t-p[ke])/(p[ke+1]-p[ke]))/(E-1),pe=!0),ke++;return Math.floor(re*z)/z}},ye={DIST:(e,t,s)=>ie(e=U(e),t=U(t))?u:s?h.poisson.cdf(e,t):h.poisson.pdf(e,t)},Re={EXC:(e,t)=>{if(ie(e=Ee(Y(e)),t=U(t)))return u;switch(t){case 1:return Z.EXC(e,.25);case 2:return Z.EXC(e,.5);case 3:return Z.EXC(e,.75);default:return m}},INC:(e,t)=>{if(ie(e=Ee(Y(e)),t=U(t)))return u;switch(t){case 1:return Z.INC(e,.25);case 2:return Z.INC(e,.5);case 3:return Z.INC(e,.75);default:return m}}},we={};function Ne(){const e=Ee(Y(arguments));if(e instanceof Error)return e;const t=h.mean(e),s=e.length;let p=0;for(let E=0;E<s;E++)p+=Math.pow(e[E]-t,3);return s*p/((s-1)*(s-2)*Math.pow(h.stdev(e,!0),3))}function Be(e,t){return ie(e=Ee(Y(e)),t=U(t))?e:e.sort((s,p)=>s-p)[t-1]}we.AVG=(e,t,s)=>{if(ie(e=U(e),t=Ee(Y(t))))return u;const p=(s=s||!1)?(z,re)=>z-re:(z,re)=>re-z,E=(t=(t=Y(t)).sort(p)).length;let O=0;for(let z=0;z<E;z++)t[z]===e&&O++;return O>1?(2*t.indexOf(e)+O+1)/2:t.indexOf(e)+1},we.EQ=(e,t,s)=>{if(ie(e=U(e),t=Ee(Y(t))))return u;const p=(s=s||!1)?(E,O)=>E-O:(E,O)=>O-E;return(t=t.sort(p)).indexOf(e)+1},Ne.P=function(){const e=Ee(Y(arguments));if(e instanceof Error)return e;const t=h.mean(e),s=e.length;let p=0,E=0;for(let O=0;O<s;O++)E+=Math.pow(e[O]-t,3),p+=Math.pow(e[O]-t,2);return E/=s,p/=s,E/Math.pow(p,1.5)};const Ze={P:function(){const e=ve.P.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=m),t},S:function(){const e=ve.S.apply(this,arguments);return Math.sqrt(e)}},te={DIST:(e,t,s)=>s!==1&&s!==2?m:s===1?te.DIST.RT(e,t):te.DIST["2T"](e,t)};te.DIST["2T"]=function(e,t){return arguments.length!==2?C:e<0||t<1?m:typeof e!="number"||typeof t!="number"?u:2*(1-h.studentt.cdf(e,t))},te.DIST.RT=function(e,t){return arguments.length!==2?C:e<0||t<1?m:typeof e!="number"||typeof t!="number"?u:1-h.studentt.cdf(e,t)},te.INV=(e,t)=>ie(e=U(e),t=U(t))?u:h.studentt.inv(e,t),te.INV["2T"]=(e,t)=>(e=U(e),t=U(t),e<=0||e>1||t<1?m:ie(e,t)?u:Math.abs(h.studentt.inv(e/2,t))),te.TEST=(e,t)=>{if(ie(e=Ee(Y(e)),t=Ee(Y(t))))return u;const s=h.mean(e),p=h.mean(t);let E,O=0,z=0;for(E=0;E<e.length;E++)O+=Math.pow(e[E]-s,2);for(E=0;E<t.length;E++)z+=Math.pow(t[E]-p,2);O/=e.length-1,z/=t.length-1;const re=Math.abs(s-p)/Math.sqrt(O/e.length+z/t.length);return te.DIST["2T"](re,e.length+t.length-2)};const ve={};function Ce(){const e=Y(arguments),t=e.length;let s=0,p=0;const E=F(e);for(let O=0;O<t;O++){const z=e[O];s+=Math.pow(typeof z=="number"?z-E:z===!0?1-E:0-E,2),z!==null&&p++}return s/(p-1)}function Oe(){const e=Y(arguments),t=e.length;let s=0,p=0;const E=F(e);let O;for(let z=0;z<t;z++){const re=e[z];s+=Math.pow(typeof re=="number"?re-E:re===!0?1-E:0-E,2),re!==null&&p++}return O=s/p,isNaN(O)&&(O=m),O}ve.P=function(){const e=$e(Y(arguments)),t=e.length;let s=0;const p=r(e);let E;for(let O=0;O<t;O++)s+=Math.pow(e[O]-p,2);return E=s/t,isNaN(E)&&(E=m),E},ve.S=function(){const e=$e(Y(arguments)),t=e.length;let s=0;const p=r(e);for(let E=0;E<t;E++)s+=Math.pow(e[E]-p,2);return s/(t-1)};const tt={DIST:(e,t,s,p)=>ie(e=U(e),t=U(t),s=U(s))?u:p?1-Math.exp(-Math.pow(e/s,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/s,t))*t/Math.pow(s,t)},Ke={};function rt(e,t,s){const p=je(e=U(e),t=U(t),s=U(s));if(p)return p;if(t===0)return 0;t=Math.abs(t);const E=-Math.floor(Math.log(t)/Math.log(10));return e>=0?yt(Math.ceil(e/t)*t,E):s===0?-yt(Math.floor(Math.abs(e)/t)*t,E):-yt(Math.ceil(Math.abs(e)/t)*t,E)}function at(e,t){return je(e=U(e),t=U(t))||(e<t?m:qe(e)/(qe(t)*qe(e-t)))}Ke.TEST=(e,t,s)=>{if(ie(e=Ee(Y(e)),t=U(t)))return u;s=s||Ze.S(e);const p=e.length;return 1-J.S.DIST((r(e)-t)/(s/Math.sqrt(p)),!0)},rt.MATH=rt,rt.PRECISE=rt;const Ve=[];function qe(e){if((e=U(e))instanceof Error)return e;const t=Math.floor(e);return t===0||t===1?1:(Ve[t]>0||(Ve[t]=qe(t-1)*t),Ve[t])}function Ct(e,t){const s=je(e=U(e),t=U(t));if(s)return s;if(t===0)return 0;if(!(e>=0&&t>0||e<=0&&t<0))return m;t=Math.abs(t);const p=-Math.floor(Math.log(t)/Math.log(10));return e>=0?yt(Math.floor(e/t)*t,p):-yt(Math.ceil(Math.abs(e)/t),p)}Ct.MATH=(e,t,s)=>{if(t instanceof Error)return t;t=t===void 0?0:t;const p=je(e=U(e),t=U(t),s=U(s));if(p)return p;if(t===0)return 0;t=t?Math.abs(t):1;const E=-Math.floor(Math.log(t)/Math.log(10));return e>=0?yt(Math.floor(e/t)*t,E):s===0||s===void 0?-yt(Math.ceil(Math.abs(e)/t)*t,E):-yt(Math.floor(Math.abs(e)/t)*t,E)},Ct.PRECISE=Ct.MATH;const cn={CEILING:rt};function Qt(e,t){const s=je(e=U(e),t=U(t));if(s)return s;if(e===0&&t===0)return m;const p=Math.pow(e,t);return isNaN(p)?m:p}function Bt(){const e=Y(arguments).filter(p=>p!=null);if(e.length===0)return 0;const t=Ee(e);if(t instanceof Error)return t;let s=1;for(let p=0;p<t.length;p++)s*=t[p];return s}function yt(e,t){return je(e=U(e),t=U(t))||+(Math.round(+(e+"e"+t))+"e"+-1*t)}function kt(){let e=0;return M(N(arguments),t=>{if(e instanceof Error)return!1;if(t instanceof Error)e=t;else if(typeof t=="number")e+=t;else if(typeof t=="string"){const s=parseFloat(t);!isNaN(s)&&(e+=s)}else if(Array.isArray(t)){const s=kt.apply(null,t);s instanceof Error?e=s:e+=s}}),e}var dn=Object.freeze({__proto__:null,ADD:function(e,t){return arguments.length!==2?C:je(e=U(e),t=U(t))||e+t},DIVIDE:function(e,t){return arguments.length!==2?C:je(e=U(e),t=U(t))||(t===0?b:e/t)},EQ:function(e,t){return arguments.length!==2?C:e instanceof Error?e:t instanceof Error?t:(e===null&&(e=void 0),t===null&&(t=void 0),e===t)},GT:function(e,t){return arguments.length!==2?C:e instanceof Error?e:t instanceof Error?t:(ht(e,t)?(e=Ye(e),t=Ye(t)):(e=U(e),t=U(t)),je(e,t)||e>t)},GTE:function(e,t){return arguments.length!==2?C:(ht(e,t)?(e=Ye(e),t=Ye(t)):(e=U(e),t=U(t)),je(e,t)||e>=t)},LT:function(e,t){return arguments.length!==2?C:(ht(e,t)?(e=Ye(e),t=Ye(t)):(e=U(e),t=U(t)),je(e,t)||e<t)},LTE:function(e,t){return arguments.length!==2?C:(ht(e,t)?(e=Ye(e),t=Ye(t)):(e=U(e),t=U(t)),je(e,t)||e<=t)},MINUS:function(e,t){return arguments.length!==2?C:je(e=U(e),t=U(t))||e-t},MULTIPLY:function(e,t){return arguments.length!==2?C:je(e=U(e),t=U(t))||e*t},NE:function(e,t){return arguments.length!==2?C:e instanceof Error?e:t instanceof Error?t:(e===null&&(e=void 0),t===null&&(t=void 0),e!==t)},POW:function(e,t){return arguments.length!==2?C:Qt(e,t)}});const fn=new Date(Date.UTC(1900,0,1)),pn=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],mn=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],Tt=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function Mt(e,t,s){s=s.toUpperCase(),e=He(e),t=He(t);const p=e.getFullYear(),E=e.getMonth(),O=e.getDate(),z=t.getFullYear(),re=t.getMonth(),pe=t.getDate();let ke;switch(s){case"Y":ke=Math.floor(Ut(e,t));break;case"D":ke=At(t,e);break;case"M":ke=re-E+12*(z-p),pe<O&&ke--;break;case"MD":O<=pe?ke=pe-O:(re===0?(e.setFullYear(z-1),e.setMonth(12)):(e.setFullYear(z),e.setMonth(re-1)),ke=At(t,e));break;case"YM":ke=re-E+12*(z-p),pe<O&&ke--,ke%=12;break;case"YD":re>E||re===E&&pe<O?e.setFullYear(z):e.setFullYear(z-1),ke=At(t,e)}return ke}function Ft(e){const t=new Date(e);return t.setHours(0,0,0,0),t}function At(e,t){return e=He(e),t=He(t),e instanceof Error?e:t instanceof Error?t:tn(Ft(e))-tn(Ft(t))}function xt(e,t,s){if(s=Ue(s||"false"),e=He(e),t=He(t),e instanceof Error)return e;if(t instanceof Error)return t;if(s instanceof Error)return s;const p=e.getMonth();let E,O,z=t.getMonth();if(s)E=e.getDate()===31?30:e.getDate(),O=t.getDate()===31?30:t.getDate();else{const re=new Date(e.getFullYear(),p+1,0).getDate(),pe=new Date(t.getFullYear(),z+1,0).getDate();E=e.getDate()===re?30:e.getDate(),t.getDate()===pe?E<30?(z++,O=1):O=30:O=t.getDate()}return 360*(t.getFullYear()-e.getFullYear())+30*(z-p)+(O-E)}function en(e){if((e=He(e))instanceof Error)return e;(e=Ft(e)).setDate(e.getDate()+4-(e.getDay()||7));const t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)}function _t(e,t,s){return _t.INTL(e,t,1,s)}function Ot(e,t,s){return Ot.INTL(e,t,1,s)}function qt(e){return new Date(e,1,29).getMonth()===1}function Ht(e,t){return Math.ceil((t-e)/1e3/60/60/24)}function Ut(e,t,s){if((e=He(e))instanceof Error)return e;if((t=He(t))instanceof Error)return t;s=s||0;let p=e.getDate();const E=e.getMonth()+1,O=e.getFullYear();let z=t.getDate();const re=t.getMonth()+1,pe=t.getFullYear();switch(s){case 0:return p===31&&z===31?(p=30,z=30):p===31?p=30:p===30&&z===31&&(z=30),(z+30*re+360*pe-(p+30*E+360*O))/360;case 1:{const ke=(Xe,et)=>{const nt=Xe.getFullYear(),bt=new Date(nt,2,1);if(qt(nt)&&Xe<bt&&et>=bt)return!0;const ut=et.getFullYear(),wt=new Date(ut,2,1);return qt(ut)&&et>=wt&&Xe<wt};let De=365;if(O===pe||O+1===pe&&(E>re||E===re&&p>=z))return(O===pe&&qt(O)||ke(e,t)||re===1&&z===29)&&(De=366),Ht(e,t)/De;const Pe=pe-O+1,_e=(new Date(pe+1,0,1)-new Date(O,0,1))/1e3/60/60/24/Pe;return Ht(e,t)/_e}case 2:return Ht(e,t)/360;case 3:return Ht(e,t)/365;case 4:return(z+30*re+360*pe-(p+30*E+360*O))/360}}function tn(e){const t=e>-22038912e5?2:1;return Math.ceil((e-fn)/864e5)+t}function nn(e){return(e=U(e))===0?u:e instanceof Error?e:String.fromCharCode(e)}function rn(e){if(ie(e))return e;let t=(e=e||"").charCodeAt(0);return isNaN(t)&&(t=u),t}function on(){const e=Y(arguments),t=je.apply(void 0,e);if(t)return t;let s=0;for(;(s=e.indexOf(!0))>-1;)e[s]="TRUE";let p=0;for(;(p=e.indexOf(!1))>-1;)e[p]="FALSE";return e.join("")}_t.INTL=(e,t,s,p)=>{if((e=He(e))instanceof Error)return e;if((t=He(t))instanceof Error)return t;let E=!1;const O=[],z=[1,2,3,4,5,6,0],re=new RegExp("^[0|1]{7}$");if(s===void 0)s=Tt[1];else if(typeof s=="string"&&re.test(s)){E=!0,s=s.split("");for(let Pe=0;Pe<s.length;Pe++)s[Pe]==="1"&&O.push(z[Pe])}else s=Tt[s];if(!(s instanceof Array))return u;p===void 0?p=[]:p instanceof Array||(p=[p]);for(let Pe=0;Pe<p.length;Pe++){const _e=He(p[Pe]);if(_e instanceof Error)return _e;p[Pe]=_e}const pe=Math.round((t-e)/864e5)+1;let ke=pe;const De=e;for(let Pe=0;Pe<pe;Pe++){const _e=new Date().getTimezoneOffset()>0?De.getUTCDay():De.getDay();let Xe=E?O.includes(_e):_e===s[0]||_e===s[1];for(let et=0;et<p.length;et++){const nt=p[et];if(nt.getDate()===De.getDate()&&nt.getMonth()===De.getMonth()&&nt.getFullYear()===De.getFullYear()){Xe=!0;break}}Xe&&ke--,De.setDate(De.getDate()+1)}return ke},Ot.INTL=(e,t,s,p)=>{if((e=He(e))instanceof Error)return e;if((t=U(t))instanceof Error)return t;if(t<0)return m;if(!((s=s===void 0?Tt[1]:Tt[s])instanceof Array))return u;p===void 0?p=[]:p instanceof Array||(p=[p]);for(let O=0;O<p.length;O++){const z=He(p[O]);if(z instanceof Error)return z;p[O]=z}let E=0;for(;E<t;){e.setDate(e.getDate()+1);const O=e.getDay();if(O!==s[0]&&O!==s[1]){for(let z=0;z<p.length;z++){const re=p[z];if(re.getDate()===e.getDate()&&re.getMonth()===e.getMonth()&&re.getFullYear()===e.getFullYear()){E--;break}}E++}}return e};const bn=on;function sn(e,t=2,s=!1){if(e=U(e),isNaN(e)||(t=U(t),isNaN(t)))return u;if(t<0){const p=Math.pow(10,-t);e=Math.round(e/p)*p}else e=e.toFixed(t);if(s)e=e.toString().replace(/,/g,"");else{const p=e.toString().split(".");p[0]=p[0].replace(/\B(?=(\d{3})+$)/g,","),e=p.join(".")}return e}function gt(e,t){return je(e,t)||(e=Ye(e),(t=U(t))instanceof Error?t:new Array(t+1).join(e))}const hn=nn,gn=rn;function Yt(e){return/^[01]{1,10}$/.test(e)}function pt(e,t,s){if(ie(e=U(e),t=U(t)))return e;if((s=s===void 0?"i":s)!=="i"&&s!=="j")return u;if(e===0&&t===0)return 0;if(e===0)return t===1?s:t.toString()+s;if(t===0)return e.toString();{const p=t>0?"+":"";return e.toString()+p+(t===1?s:t.toString()+s)}}function zt(e,t){return t=t===void 0?0:t,ie(e=U(e),t=U(t))?u:h.erf(e)}function Wt(e){return isNaN(e)?u:h.erfc(e)}function Xt(e){const t=st(e),s=ot(e);return ie(t,s)?u:Math.sqrt(Math.pow(t,2)+Math.pow(s,2))}function ot(e){if(e===void 0||e===!0||e===!1)return u;if(e===0||e==="0")return 0;if(["i","j"].indexOf(e)>=0)return 1;let t=(e=(e+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),s=e.indexOf("-");t===0&&(t=e.indexOf("+",1)),s===0&&(s=e.indexOf("-",1));const p=e.substring(e.length-1,e.length),E=p==="i"||p==="j";return t>=0||s>=0?E?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?m:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,s))||isNaN(e.substring(s+1,e.length-1))?m:-Number(e.substring(s+1,e.length-1)):m:E?isNaN(e.substring(0,e.length-1))?m:e.substring(0,e.length-1):isNaN(e)?m:0}function Gt(e){const t=st(e),s=ot(e);return ie(t,s)?u:t===0&&s===0?b:t===0&&s>0?Math.PI/2:t===0&&s<0?-Math.PI/2:s===0&&t>0?0:s===0&&t<0?-Math.PI:t>0?Math.atan(s/t):t<0&&s>=0?Math.atan(s/t)+Math.PI:Math.atan(s/t)-Math.PI}function Vt(e){const t=st(e),s=ot(e);if(ie(t,s))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.cos(t)*(Math.exp(s)+Math.exp(-s))/2,-Math.sin(t)*(Math.exp(s)-Math.exp(-s))/2,p)}function an(e){const t=st(e),s=ot(e);if(ie(t,s))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.cos(s)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(s)*(Math.exp(t)-Math.exp(-t))/2,p)}function Et(e,t){const s=st(e),p=ot(e),E=st(t),O=ot(t);if(ie(s,p,E,O))return u;const z=e.substring(e.length-1),re=t.substring(t.length-1);let pe="i";if((z==="j"||re==="j")&&(pe="j"),E===0&&O===0)return m;const ke=E*E+O*O;return pt((s*E+p*O)/ke,(p*E-s*O)/ke,pe)}function st(e){if(e===void 0||e===!0||e===!1)return u;if(e===0||e==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;let t=(e+="").indexOf("+"),s=e.indexOf("-");t===0&&(t=e.indexOf("+",1)),s===0&&(s=e.indexOf("-",1));const p=e.substring(e.length-1,e.length),E=p==="i"||p==="j";return t>=0||s>=0?E?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?m:Number(e.substring(0,t)):isNaN(e.substring(0,s))||isNaN(e.substring(s+1,e.length-1))?m:Number(e.substring(0,s)):m:E?isNaN(e.substring(0,e.length-1))?m:0:isNaN(e)?m:e}function Pt(e){const t=st(e),s=ot(e);if(ie(t,s))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.sin(t)*(Math.exp(s)+Math.exp(-s))/2,Math.cos(t)*(Math.exp(s)-Math.exp(-s))/2,p)}function ln(e){const t=st(e),s=ot(e);if(ie(t,s))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.cos(s)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(s)*(Math.exp(t)+Math.exp(-t))/2,p)}zt.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")},Wt.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};const vn=Q.DIST,jn=Q.INV,yn=ee.DIST,xn=rt.MATH,wn=rt.PRECISE,Cn=D.DIST,kn=D.DIST.RT,An=D.INV,En=D.INV.RT,In=D.TEST,Sn=ge.P,Mn=ge.P,Ln=ge.S,Rn=ee.INV,Dn=Wt.PRECISE,Nn=zt.PRECISE,Tn=de.DIST,Fn=fe.DIST,_n=fe.DIST.RT,On=fe.INV,Hn=fe.INV.RT,Vn=Ct.MATH,Pn=Ct.PRECISE,Bn=fe.TEST,qn=he.DIST,Un=he.INV,Yn=Le.PRECISE,zn=We.DIST,Wn=Ae.INV,Xn=Ae.DIST,Gn=Ae.INV,$n=w.MULT,Kn=w.SNGL,Jn=P.DIST,Zn=_t.INTL,Qn=J.DIST,er=J.INV,tr=J.S.DIST,nr=J.S.INV,rr=Z.EXC,or=Z.INC,sr=ue.EXC,ir=ue.INC,ar=ye.DIST,lr=Re.EXC,ur=Re.INC,cr=we.AVG,dr=we.EQ,fr=Ne.P,pr=Ze.P,mr=Ze.S,br=te.DIST,hr=te.DIST.RT,gr=te.INV,vr=te.TEST,jr=ve.P,yr=ve.S,xr=tt.DIST,wr=Ot.INTL,Cr=Ke.TEST;function $t(e){const t=[];return M(e,s=>{s&&t.push(s)}),t}function vt(e,t){const s={};for(let O=1;O<e[0].length;++O)s[O]=!0;let p=t[0].length;for(let O=1;O<t.length;++O)t[O].length>p&&(p=t[O].length);for(let O=1;O<e.length;++O)for(let z=1;z<e[O].length;++z){let re=!1,pe=!1;for(let ke=0;ke<t.length;++ke){const De=t[ke];if(De.length<p)continue;const Pe=De[0];if(e[O][0]===Pe){pe=!0;for(let _e=1;_e<De.length;++_e)if(!re)if(De[_e]===void 0||De[_e]==="*")re=!0;else{const Xe=jt(De[_e]+""),et=[dt(e[O][z],it)].concat(Xe);re=mt(et)}}}pe&&(s[z]=s[z]&&re)}const E=[];for(let O=0;O<e[0].length;++O)s[O]&&E.push(O-1);return E}function Kt(e){return e&&e.getTime&&!isNaN(e.getTime())}function Jt(e){return e instanceof Date?e:new Date(e)}function It(e,t,s,p,E){if(p=p||0,E=E||0,ie(e=U(e),t=U(t),s=U(s),p=U(p),E=U(E)))return u;let O;if(e===0)O=p+s*t;else{const z=Math.pow(1+e,t);O=E===1?p*z+s*(1+e)*(z-1)/e:p*z+s*(z-1)/e}return-O}function un(e,t,s,p,E,O){if(E=E||0,O=O||0,ie(e=U(e),t=U(t),s=U(s),p=U(p),E=U(E),O=U(O)))return u;const z=Lt(e,s,p,E,O);return(t===1?O===1?0:-p:O===1?It(e,t-2,z,p,1)-z:It(e,t-1,z,p,0))*e}function Zt(){const e=Ee(Y(arguments));if(e instanceof Error)return e;const t=e[0];let s=0;for(let p=1;p<e.length;p++)s+=e[p]/Math.pow(1+t,p);return s}function Lt(e,t,s,p,E){if(p=p||0,E=E||0,ie(e=U(e),t=U(t),s=U(s),p=U(p),E=U(E)))return u;let O;if(e===0)O=(s+p)/t;else{const z=Math.pow(1+e,t);O=E===1?(p*e/(z-1)+s*e/(1-1/z))/(1+e):p*e/(z-1)+s*e/(1-1/z)}return-O}const kr={errors:H,symbols:dn};d.ABS=function(e){return(e=U(e))instanceof Error?e:Math.abs(e)},d.ACCRINT=function(e,t,s,p,E,O,z){return e=Jt(e),t=Jt(t),s=Jt(s),Kt(e)&&Kt(t)&&Kt(s)?p<=0||E<=0||[1,2,4].indexOf(O)===-1||[0,1,2,3,4].indexOf(z)===-1||s<=e?m:(E=E||0)*p*Ut(e,s,z=z||0):u},d.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},d.ACOS=function(e){if((e=U(e))instanceof Error)return e;let t=Math.acos(e);return isNaN(t)&&(t=m),t},d.ACOSH=function(e){if((e=U(e))instanceof Error)return e;let t=Math.log(e+Math.sqrt(e*e-1));return isNaN(t)&&(t=m),t},d.ACOT=function(e){return(e=U(e))instanceof Error?e:Math.atan(1/e)},d.ACOTH=function(e){if((e=U(e))instanceof Error)return e;let t=.5*Math.log((e+1)/(e-1));return isNaN(t)&&(t=m),t},d.AGGREGATE=function(e,t,s,p){if(ie(e=U(e),U(e)))return u;switch(e){case 1:return r(s);case 2:return B(s);case 3:return K(s);case 4:return X(s);case 5:return oe(s);case 6:return Bt(s);case 7:return Ze.S(s);case 8:return Ze.P(s);case 9:return kt(s);case 10:return ve.S(s);case 11:return ve.P(s);case 12:return W(s);case 13:return w.SNGL(s);case 14:return Je(s,p);case 15:return Be(s,p);case 16:return Z.INC(s,p);case 17:return Re.INC(s,p);case 18:return Z.EXC(s,p);case 19:return Re.EXC(s,p)}},d.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},d.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},d.AND=function(){const e=Y(arguments);let t=u;for(let s=0;s<e.length;s++){if(e[s]instanceof Error)return e[s];e[s]!==void 0&&e[s]!==null&&typeof e[s]!="string"&&(t===u&&(t=!0),e[s]||(t=!1))}return t},d.ARABIC=function(e){if(e==null)return 0;if(e instanceof Error)return e;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return u;let t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,s=>{t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[s]}),t},d.ASC=function(){throw new Error("ASC is not implemented")},d.ASIN=function(e){if((e=U(e))instanceof Error)return e;let t=Math.asin(e);return isNaN(t)&&(t=m),t},d.ASINH=function(e){return(e=U(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},d.ATAN=function(e){return(e=U(e))instanceof Error?e:Math.atan(e)},d.ATAN2=function(e,t){return je(e=U(e),t=U(t))||Math.atan2(e,t)},d.ATANH=function(e){if((e=U(e))instanceof Error)return e;let t=Math.log((1+e)/(1-e))/2;return isNaN(t)&&(t=m),t},d.AVEDEV=function(){const e=Y(arguments).filter(Ie);if(e.length===0)return m;const t=Ee(e);return t instanceof Error?t:h.sum(h(t).subtract(h.mean(t)).abs()[0])/t.length},d.AVERAGE=r,d.AVERAGEA=F,d.AVERAGEIF=function(e,t,s){if(arguments.length<=1)return C;if(s=Ee(Y(s=s||e).filter(Ie)),e=Y(e),s instanceof Error)return s;let p=0,E=0;const O=t===void 0||t==="*",z=O?null:jt(t+"");for(let re=0;re<e.length;re++){const pe=e[re];if(O)E+=s[re],p++;else{const ke=[dt(pe,it)].concat(z);mt(ke)&&(E+=s[re],p++)}}return E/p},d.AVERAGEIFS=function(){const e=N(arguments),t=(e.length-1)/2,s=Y(e[0]);let p=0,E=0;for(let z=0;z<s.length;z++){let re=!1;for(let pe=0;pe<t;pe++){const ke=e[2*pe+1][z],De=e[2*pe+2];let Pe=!1;if(De===void 0||De==="*")Pe=!0;else{const _e=jt(De+""),Xe=[dt(ke,it)].concat(_e);Pe=mt(Xe)}if(!Pe){re=!1;break}re=!0}re&&(E+=s[z],p++)}const O=E/p;return isNaN(O)?0:O},d.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},d.BASE=function(e,t,s){const p=je(e=U(e),t=U(t),s=U(s));if(p)return p;if(t===0)return m;const E=e.toString(t);return new Array(Math.max(s+1-E.length,0)).join("0")+E},d.BESSELI=function(e,t){return ie(e=U(e),t=U(t))?u:_.besseli(e,t)},d.BESSELJ=function(e,t){return ie(e=U(e),t=U(t))?u:_.besselj(e,t)},d.BESSELK=function(e,t){return ie(e=U(e),t=U(t))?u:_.besselk(e,t)},d.BESSELY=function(e,t){return ie(e=U(e),t=U(t))?u:_.bessely(e,t)},d.BETA=Q,d.BETADIST=vn,d.BETAINV=jn,d.BIN2DEC=function(e){if(!Yt(e))return m;const t=parseInt(e,2),s=e.toString();return s.length===10&&s.substring(0,1)==="1"?parseInt(s.substring(1),2)-512:t},d.BIN2HEX=function(e,t){if(!Yt(e))return m;const s=e.toString();if(s.length===10&&s.substring(0,1)==="1")return(0xfffffffe00+parseInt(s.substring(1),2)).toString(16);const p=parseInt(e,2).toString(16);return t===void 0?p:isNaN(t)?u:t<0?m:(t=Math.floor(t))>=p.length?gt("0",t-p.length)+p:m},d.BIN2OCT=function(e,t){if(!Yt(e))return m;const s=e.toString();if(s.length===10&&s.substring(0,1)==="1")return(1073741312+parseInt(s.substring(1),2)).toString(8);const p=parseInt(e,2).toString(8);return t===void 0?p:isNaN(t)?u:t<0?m:(t=Math.floor(t))>=p.length?gt("0",t-p.length)+p:m},d.BINOM=ee,d.BINOMDIST=yn,d.BITAND=function(e,t){return ie(e=U(e),t=U(t))?u:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?m:e&t},d.BITLSHIFT=function(e,t){return ie(e=U(e),t=U(t))?u:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?m:t>=0?e<<t:e>>-t},d.BITOR=function(e,t){return ie(e=U(e),t=U(t))?u:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?m:e|t},d.BITRSHIFT=function(e,t){return ie(e=U(e),t=U(t))?u:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?m:t>=0?e>>t:e<<-t},d.BITXOR=function(e,t){return ie(e=U(e),t=U(t))?u:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?m:e^t},d.CEILING=rt,d.CEILINGMATH=xn,d.CEILINGPRECISE=wn,d.CELL=function(){throw new Error("CELL is not implemented")},d.CHAR=nn,d.CHIDIST=Cn,d.CHIDISTRT=kn,d.CHIINV=An,d.CHIINVRT=En,d.CHISQ=D,d.CHITEST=In,d.CHOOSE=function(){if(arguments.length<2)return C;const e=arguments[0];return e<1||e>254||arguments.length<e+1?u:arguments[e]},d.CLEAN=function(e){return ie(e)?e:(e=e||"").replace(/[\0-\x1F]/g,"")},d.CODE=rn,d.COLUMN=function(e,t){return arguments.length!==2?C:t<0?m:e instanceof Array&&typeof t=="number"?e.length!==0?h.col(e,t):void 0:u},d.COLUMNS=function(e){return arguments.length!==1?C:e instanceof Array?e.length===0?0:h.cols(e):u},d.COMBIN=at,d.COMBINA=function(e,t){return je(e=U(e),t=U(t))||(e<t?m:e===0&&t===0?1:at(e+t-1,e-1))},d.COMPLEX=pt,d.CONCAT=bn,d.CONCATENATE=on,d.CONFIDENCE=I,d.CONVERT=function(e,t,s){if((e=U(e))instanceof Error)return e;const p=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ngstrm","",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ngstrm","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestrke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ngstrm","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],E={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},O={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let z,re=null,pe=null,ke=t,De=s,Pe=1,_e=1;for(let Xe=0;Xe<p.length;Xe++)z=p[Xe][2]===null?[]:p[Xe][2],(p[Xe][1]===ke||z.indexOf(ke)>=0)&&(re=p[Xe]),(p[Xe][1]===De||z.indexOf(De)>=0)&&(pe=p[Xe]);if(re===null){const Xe=E[t.substring(0,2)];let et=O[t.substring(0,1)];t.substring(0,2)==="da"&&(et=["dekao",10,"da"]),Xe?(Pe=Xe[2],ke=t.substring(2)):et&&(Pe=et[1],ke=t.substring(et[2].length));for(let nt=0;nt<p.length;nt++)z=p[nt][2]===null?[]:p[nt][2],(p[nt][1]===ke||z.indexOf(ke)>=0)&&(re=p[nt])}if(pe===null){const Xe=E[s.substring(0,2)];let et=O[s.substring(0,1)];s.substring(0,2)==="da"&&(et=["dekao",10,"da"]),Xe?(_e=Xe[2],De=s.substring(2)):et&&(_e=et[1],De=s.substring(et[2].length));for(let nt=0;nt<p.length;nt++)z=p[nt][2]===null?[]:p[nt][2],(p[nt][1]===De||z.indexOf(De)>=0)&&(pe=p[nt])}return re===null||pe===null||re[3]!==pe[3]?C:e*re[6]*Pe/(pe[6]*_e)},d.CORREL=function(e,t){return ie(e=Ee(Y(e)),t=Ee(Y(t)))?u:h.corrcoeff(e,t)},d.COS=function(e){return(e=U(e))instanceof Error?e:Math.cos(e)},d.COSH=function(e){return(e=U(e))instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},d.COT=function(e){return(e=U(e))instanceof Error?e:e===0?b:1/Math.tan(e)},d.COTH=function(e){if((e=U(e))instanceof Error)return e;if(e===0)return b;const t=Math.exp(2*e);return(t+1)/(t-1)},d.COUNT=B,d.COUNTA=K,d.COUNTBLANK=ne,d.COUNTIF=function(e,t){if(e=Y(e),t===void 0||t==="*")return e.length;let s=0;const p=jt(t+"");for(let E=0;E<e.length;E++){const O=[dt(e[E],it)].concat(p);mt(O)&&s++}return s},d.COUNTIFS=function(){const e=N(arguments),t=new Array(Y(e[0]).length);for(let p=0;p<t.length;p++)t[p]=!0;for(let p=0;p<e.length;p+=2){const E=Y(e[p]),O=e[p+1];if(O!==void 0&&O!=="*"){const z=jt(O+"");for(let re=0;re<E.length;re++){const pe=[dt(E[re],it)].concat(z);t[re]=t[re]&&mt(pe)}}}let s=0;for(let p=0;p<t.length;p++)t[p]&&s++;return s},d.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},d.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},d.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},d.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},d.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},d.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},d.COVAR=Sn,d.COVARIANCE=ge,d.COVARIANCEP=Mn,d.COVARIANCES=Ln,d.CRITBINOM=Rn,d.CSC=function(e){return(e=U(e))instanceof Error?e:e===0?b:1/Math.sin(e)},d.CSCH=function(e){return(e=U(e))instanceof Error?e:e===0?b:2/(Math.exp(e)-Math.exp(-e))},d.CUMIPMT=function(e,t,s,p,E,O){if(ie(e=U(e),t=U(t),s=U(s)))return u;if(e<=0||t<=0||s<=0||p<1||E<1||p>E||O!==0&&O!==1)return m;const z=Lt(e,t,s,0,O);let re=0;p===1&&(O===0&&(re=-s),p++);for(let pe=p;pe<=E;pe++)re+=O===1?It(e,pe-2,z,s,1)-z:It(e,pe-1,z,s,0);return re*=e,re},d.CUMPRINC=function(e,t,s,p,E,O){if(ie(e=U(e),t=U(t),s=U(s)))return u;if(e<=0||t<=0||s<=0||p<1||E<1||p>E||O!==0&&O!==1)return m;const z=Lt(e,t,s,0,O);let re=0;p===1&&(re=O===0?z+s*e:z,p++);for(let pe=p;pe<=E;pe++)re+=O>0?z-(It(e,pe-2,z,s,1)-z)*e:z-It(e,pe-1,z,s,0)*e;return re},d.DATE=function(e,t,s){let p;return ie(e=U(e),t=U(t),s=U(s))?p=u:(p=new Date(e,t-1,s),p.getFullYear()<0&&(p=m)),p},d.DATEDIF=Mt,d.DATEVALUE=function(e){if(typeof e!="string")return u;const t=Date.parse(e);return isNaN(t)?u:new Date(e)},d.DAVERAGE=function(e,t,s){if(isNaN(t)&&typeof t!="string")return u;const p=vt(e,s);let E=[];if(typeof t=="string"){const z=Se(e,t);E=se(e[z])}else E=se(e[t]);let O=0;return M(p,z=>{O+=E[z]}),p.length===0?b:O/p.length},d.DAY=function(e){const t=He(e);return t instanceof Error?t:t.getDate()},d.DAYS=At,d.DAYS360=xt,d.DB=function(e,t,s,p,E){if(E=E===void 0?12:E,ie(e=U(e),t=U(t),s=U(s),p=U(p),E=U(E)))return u;if(e<0||t<0||s<0||p<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(E)===-1||p>s)return m;if(t>=e)return 0;const O=(1-Math.pow(t/e,1/s)).toFixed(3),z=e*O*E/12;let re=z,pe=0;const ke=p===s?s-1:p;for(let De=2;De<=ke;De++)pe=(e-re)*O,re+=pe;return p===1?z:p===s?(e-re)*O:pe},d.DBCS=function(){throw new Error("DBCS is not implemented")},d.DCOUNT=function(e,t,s){if(isNaN(t)&&typeof t!="string")return u;const p=vt(e,s);let E=[];if(typeof t=="string"){const z=Se(e,t);E=se(e[z])}else E=se(e[t]);const O=[];return M(p,z=>{O.push(E[z])}),B(O)},d.DCOUNTA=function(e,t,s){if(isNaN(t)&&typeof t!="string")return u;const p=vt(e,s);let E=[];if(typeof t=="string"){const z=Se(e,t);E=se(e[z])}else E=se(e[t]);const O=[];return M(p,z=>{O.push(E[z])}),K(O)},d.DDB=function(e,t,s,p,E){if(E=E===void 0?2:E,ie(e=U(e),t=U(t),s=U(s),p=U(p),E=U(E)))return u;if(e<0||t<0||s<0||p<0||E<=0||p>s)return m;if(t>=e)return 0;let O=0,z=0;for(let re=1;re<=p;re++)z=Math.min(E/s*(e-O),e-t-O),O+=z;return z},d.DEC2BIN=function(e,t){if((e=U(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return m;if(e<0)return"1"+gt("0",9-(512+e).toString(2).length)+(512+e).toString(2);const s=parseInt(e,10).toString(2);return t===void 0?s:isNaN(t)?u:t<0?m:(t=Math.floor(t))>=s.length?gt("0",t-s.length)+s:m},d.DEC2HEX=function(e,t){if((e=U(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return m;if(e<0)return(1099511627776+e).toString(16);const s=parseInt(e,10).toString(16);return t===void 0?s:isNaN(t)?u:t<0?m:(t=Math.floor(t))>=s.length?gt("0",t-s.length)+s:m},d.DEC2OCT=function(e,t){if((e=U(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return m;if(e<0)return(1073741824+e).toString(8);const s=parseInt(e,10).toString(8);return t===void 0?s:isNaN(t)?u:t<0?m:(t=Math.floor(t))>=s.length?gt("0",t-s.length)+s:m},d.DECIMAL=function(e,t){return arguments.length<1?u:je(e=U(e),t=U(t))||(t===0?m:parseInt(e,t))},d.DEGREES=function(e){return(e=U(e))instanceof Error?e:180*e/Math.PI},d.DELTA=function(e,t){return t=t===void 0?0:t,ie(e=U(e),t=U(t))?u:e===t?1:0},d.DEVSQ=function(){const e=Ee(Y(arguments));if(e instanceof Error)return e;const t=h.mean(e);let s=0;for(let p=0;p<e.length;p++)s+=Math.pow(e[p]-t,2);return s},d.DGET=function(e,t,s){if(isNaN(t)&&typeof t!="string")return u;const p=vt(e,s);let E=[];return E=se(typeof t=="string"?e[Se(e,t)]:e[t]),p.length===0?u:p.length>1?m:E[p[0]]},d.DISC=function(e,t,s,p,E){if(ie(e=He(e),t=He(t),s=U(s),p=U(p),E=(E=U(E))||0))return u;if(s<=0||p<=0)return m;if(e>=t)return u;let O,z;switch(E){case 0:O=360,z=xt(e,t,!1);break;case 1:case 3:O=365,z=Mt(e,t,"D");break;case 2:O=360,z=Mt(e,t,"D");break;case 4:O=360,z=xt(e,t,!0);break;default:return m}return(p-s)/p*O/z},d.DMAX=function(e,t,s){if(isNaN(t)&&typeof t!="string")return u;const p=vt(e,s);let E=[];if(typeof t=="string"){const z=Se(e,t);E=se(e[z])}else E=se(e[t]);let O=E[p[0]];return M(p,z=>{O<E[z]&&(O=E[z])}),O},d.DMIN=function(e,t,s){if(isNaN(t)&&typeof t!="string")return u;const p=vt(e,s);let E=[];if(typeof t=="string"){const z=Se(e,t);E=se(e[z])}else E=se(e[t]);let O=E[p[0]];return M(p,z=>{O>E[z]&&(O=E[z])}),O},d.DOLLAR=function(e,t=2){if(e=U(e),isNaN(e))return u;const s={style:"currency",currency:"USD",minimumFractionDigits:t>=0?t:0,maximumFractionDigits:t>=0?t:0},p=(e=yt(e,t)).toLocaleString("en-US",s);return e<0?"$("+p.slice(2)+")":p},d.DOLLARDE=function(e,t){if(ie(e=U(e),t=U(t)))return u;if(t<0)return m;if(t>=0&&t<1)return b;t=parseInt(t,10);let s=parseInt(e,10);s+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;const p=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return s=Math.round(s*p)/p,s},d.DOLLARFR=function(e,t){if(ie(e=U(e),t=U(t)))return u;if(t<0)return m;if(t>=0&&t<1)return b;t=parseInt(t,10);let s=parseInt(e,10);return s+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t,s},d.DPRODUCT=function(e,t,s){if(isNaN(t)&&typeof t!="string")return u;const p=vt(e,s);let E=[];if(typeof t=="string"){const re=Se(e,t);E=se(e[re])}else E=se(e[t]);let O=[];M(p,re=>{O.push(E[re])}),O=$t(O);let z=1;return M(O,re=>{z*=re}),z},d.DSTDEV=function(e,t,s){if(isNaN(t)&&typeof t!="string")return u;const p=vt(e,s);let E=[];if(typeof t=="string"){const z=Se(e,t);E=se(e[z])}else E=se(e[t]);let O=[];return M(p,z=>{O.push(E[z])}),O=$t(O),Ze.S(O)},d.DSTDEVP=function(e,t,s){if(isNaN(t)&&typeof t!="string")return u;const p=vt(e,s);let E=[];if(typeof t=="string"){const z=Se(e,t);E=se(e[z])}else E=se(e[t]);let O=[];return M(p,z=>{O.push(E[z])}),O=$t(O),Ze.P(O)},d.DSUM=function(e,t,s){if(isNaN(t)&&typeof t!="string")return u;const p=vt(e,s);let E=[];if(typeof t=="string"){const z=Se(e,t);E=se(e[z])}else E=se(e[t]);const O=[];return M(p,z=>{O.push(E[z])}),kt(O)},d.DURATION=function(){throw new Error("DURATION is not implemented")},d.DVAR=function(e,t,s){if(isNaN(t)&&typeof t!="string")return u;const p=vt(e,s);let E=[];if(typeof t=="string"){const z=Se(e,t);E=se(e[z])}else E=se(e[t]);const O=[];return M(p,z=>{O.push(E[z])}),ve.S(O)},d.DVARP=function(e,t,s){if(isNaN(t)&&typeof t!="string")return u;const p=vt(e,s);let E=[];if(typeof t=="string"){const z=Se(e,t);E=se(e[z])}else E=se(e[t]);const O=[];return M(p,z=>{O.push(E[z])}),ve.P(O)},d.EDATE=function(e,t){return(e=He(e))instanceof Error?e:isNaN(t)?u:(t=parseInt(t,10),e.setMonth(e.getMonth()+t),e)},d.EFFECT=function(e,t){return ie(e=U(e),t=U(t))?u:e<=0||t<1?m:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},d.EOMONTH=function(e,t){return(e=He(e))instanceof Error?e:isNaN(t)?u:(t=parseInt(t,10),new Date(e.getFullYear(),e.getMonth()+t+1,0))},d.ERF=zt,d.ERFC=Wt,d.ERFCPRECISE=Dn,d.ERFPRECISE=Nn,d.ERROR=Rt,d.EVEN=function(e){return(e=U(e))instanceof Error?e:rt(e,-2,-1)},d.EXACT=function(e,t){return arguments.length!==2?C:je(e,t)||(e=Ye(e))===Ye(t)},d.EXP=function(e){return arguments.length<1?C:arguments.length>1?S:(e=U(e))instanceof Error?e:e=Math.exp(e)},d.EXPON=de,d.EXPONDIST=Tn,d.F=fe,d.FACT=qe,d.FACTDOUBLE=function e(t){if((t=U(t))instanceof Error)return t;const s=Math.floor(t);return s<=0?1:s*e(s-2)},d.FALSE=function(){return!1},d.FDIST=Fn,d.FDISTRT=_n,d.FIND=function(e,t,s){if(arguments.length<2)return C;e=Ye(e),s=s===void 0?0:s;const p=(t=Ye(t)).indexOf(e,s-1);return p===-1?u:p+1},d.FINV=On,d.FINVRT=Hn,d.FISHER=function(e){return(e=U(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},d.FISHERINV=function(e){if((e=U(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},d.FIXED=sn,d.FLOOR=Ct,d.FLOORMATH=Vn,d.FLOORPRECISE=Pn,d.FORECAST=le,d.FREQUENCY=function(e,t){if(ie(e=Ee(Y(e)),t=Ee(Y(t))))return u;const s=e.length,p=t.length,E=[];for(let O=0;O<=p;O++){E[O]=0;for(let z=0;z<s;z++)O===0?e[z]<=t[0]&&(E[0]+=1):O<p?e[z]>t[O-1]&&e[z]<=t[O]&&(E[O]+=1):O===p&&e[z]>t[p-1]&&(E[p]+=1)}return E},d.FTEST=Bn,d.FV=It,d.FVSCHEDULE=function(e,t){if(ie(e=U(e),t=Ee(Y(t))))return u;const s=t.length;let p=e;for(let E=0;E<s;E++)p*=1+t[E];return p},d.GAMMA=he,d.GAMMADIST=qn,d.GAMMAINV=Un,d.GAMMALN=Le,d.GAMMALNPRECISE=Yn,d.GAUSS=function(e){return(e=U(e))instanceof Error?e:h.normal.cdf(e,0,1)-.5},d.GCD=function(){const e=Ee(Y(arguments));if(e instanceof Error)return e;const t=e.length,s=e[0];let p=s<0?-s:s;for(let E=1;E<t;E++){const O=e[E];let z=O<0?-O:O;for(;p&&z;)p>z?p%=z:z%=p;p+=z}return p},d.GEOMEAN=function(){const e=Ee(Y(arguments));return e instanceof Error?e:h.geomean(e)},d.GESTEP=function(e,t){return ie(t=t||0,e=U(e))?e:e>=t?1:0},d.GROWTH=function(e,t,s,p){if((e=Ee(e))instanceof Error)return e;let E;if(t===void 0)for(t=[],E=1;E<=e.length;E++)t.push(E);if(s===void 0)for(s=[],E=1;E<=e.length;E++)s.push(E);if(ie(t=Ee(t),s=Ee(s)))return u;p===void 0&&(p=!0);const O=e.length;let z,re,pe=0,ke=0,De=0,Pe=0;for(E=0;E<O;E++){const Xe=t[E],et=Math.log(e[E]);pe+=Xe,ke+=et,De+=Xe*et,Pe+=Xe*Xe}pe/=O,ke/=O,De/=O,Pe/=O,p?(z=(De-pe*ke)/(Pe-pe*pe),re=ke-z*pe):(z=De/Pe,re=0);const _e=[];for(E=0;E<s.length;E++)_e.push(Math.exp(re+z*s[E]));return _e},d.HARMEAN=function(){const e=Ee(Y(arguments));if(e instanceof Error)return e;const t=e.length;let s=0;for(let p=0;p<t;p++)s+=1/e[p];return t/s},d.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return m;const s=!(e.length!==10||e.substring(0,1).toLowerCase()!=="f"),p=s?parseInt(e,16)-1099511627776:parseInt(e,16);if(p<-512||p>511)return m;if(s)return"1"+gt("0",9-(512+p).toString(2).length)+(512+p).toString(2);const E=p.toString(2);return t===void 0?E:isNaN(t)?u:t<0?m:(t=Math.floor(t))>=E.length?gt("0",t-E.length)+E:m},d.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return m;const t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},d.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return m;const s=parseInt(e,16);if(s>536870911&&s<0xffe0000000)return m;if(s>=0xffe0000000)return(s-0xffc0000000).toString(8);const p=s.toString(8);return t===void 0?p:isNaN(t)?u:t<0?m:(t=Math.floor(t))>=p.length?gt("0",t-p.length)+p:m},d.HLOOKUP=function(e,t,s,p){return l(e,xe(t),s,p)},d.HOUR=function(e){return(e=He(e))instanceof Error?e:e.getHours()},d.HYPGEOM=We,d.HYPGEOMDIST=zn,d.IF=function(e,t,s){return e instanceof Error?e:((t=!(arguments.length>=2)||t)==null&&(t=0),(s=arguments.length===3&&s)==null&&(s=0),e?t:s)},d.IFERROR=function(e,t){return ft(e)?t:e},d.IFNA=function(e,t){return e===C?t:e},d.IFS=function(){for(let e=0;e<arguments.length/2;e++)if(arguments[2*e])return arguments[2*e+1];return C},d.IMABS=Xt,d.IMAGINARY=ot,d.IMARGUMENT=Gt,d.IMCONJUGATE=function(e){const t=st(e),s=ot(e);if(ie(t,s))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",s!==0?pt(t,-s,p):e},d.IMCOS=Vt,d.IMCOSH=an,d.IMCOT=function(e){return ie(st(e),ot(e))?u:Et(Vt(e),Pt(e))},d.IMCSC=function(e){return e===!0||e===!1?u:ie(st(e),ot(e))?m:Et("1",Pt(e))},d.IMCSCH=function(e){return e===!0||e===!1?u:ie(st(e),ot(e))?m:Et("1",ln(e))},d.IMDIV=Et,d.IMEXP=function(e){const t=st(e),s=ot(e);if(ie(t,s))return u;let p=e.substring(e.length-1);p=p==="i"||p==="j"?p:"i";const E=Math.exp(t);return pt(E*Math.cos(s),E*Math.sin(s),p)},d.IMLN=function(e){const t=st(e),s=ot(e);if(ie(t,s))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.log(Math.sqrt(t*t+s*s)),Math.atan(s/t),p)},d.IMLOG10=function(e){const t=st(e),s=ot(e);if(ie(t,s))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.log(Math.sqrt(t*t+s*s))/Math.log(10),Math.atan(s/t)/Math.log(10),p)},d.IMLOG2=function(e){const t=st(e),s=ot(e);if(ie(t,s))return u;let p=e.substring(e.length-1);return p=p==="i"||p==="j"?p:"i",pt(Math.log(Math.sqrt(t*t+s*s))/Math.log(2),Math.atan(s/t)/Math.log(2),p)},d.IMPOWER=function(e,t){if(ie(t=U(t),st(e),ot(e)))return u;let s=e.substring(e.length-1);s=s==="i"||s==="j"?s:"i";const p=Math.pow(Xt(e),t),E=Gt(e);return pt(p*Math.cos(t*E),p*Math.sin(t*E),s)},d.IMPRODUCT=function(){let e=arguments[0];if(!arguments.length)return u;for(let t=1;t<arguments.length;t++){const s=st(e),p=ot(e),E=st(arguments[t]),O=ot(arguments[t]);if(ie(s,p,E,O))return u;e=pt(s*E-p*O,s*O+p*E)}return e},d.IMREAL=st,d.IMSEC=function(e){return e===!0||e===!1||ie(st(e),ot(e))?u:Et("1",Vt(e))},d.IMSECH=function(e){return ie(st(e),ot(e))?u:Et("1",an(e))},d.IMSIN=Pt,d.IMSINH=ln,d.IMSQRT=function(e){if(ie(st(e),ot(e)))return u;let t=e.substring(e.length-1);t=t==="i"||t==="j"?t:"i";const s=Math.sqrt(Xt(e)),p=Gt(e);return pt(s*Math.cos(p/2),s*Math.sin(p/2),t)},d.IMSUB=function(e,t){const s=st(e),p=ot(e),E=st(t),O=ot(t);if(ie(s,p,E,O))return u;const z=e.substring(e.length-1),re=t.substring(t.length-1);let pe="i";return(z==="j"||re==="j")&&(pe="j"),pt(s-E,p-O,pe)},d.IMSUM=function(){if(!arguments.length)return u;const e=Y(arguments);let t=e[0];for(let s=1;s<e.length;s++){const p=st(t),E=ot(t),O=st(e[s]),z=ot(e[s]);if(ie(p,E,O,z))return u;t=pt(p+O,E+z)}return t},d.IMTAN=function(e){return e===!0||e===!1||ie(st(e),ot(e))?u:Et(Pt(e),Vt(e))},d.INDEX=function(e,t,s){const p=je(e,t,s);if(p)return p;if(!Array.isArray(e))return u;const E=e.length>0&&!Array.isArray(e[0]);return E&&!s?(s=t,t=1):(s=s||1,t=t||1),s<0||t<0?u:E&&t===1&&s<=e.length?e[s-1]:t<=e.length&&s<=e[t-1].length?e[t-1][s-1]:g},d.INFO=function(){throw new Error("INFO is not implemented")},d.INT=function(e){return(e=U(e))instanceof Error?e:Math.floor(e)},d.INTERCEPT=function(e,t){return ie(e=Ee(e),t=Ee(t))?u:e.length!==t.length?C:le(0,e,t)},d.INTRATE=function(){throw new Error("INTRATE is not implemented")},d.IPMT=un,d.IRR=function(e,t){if(t=t||0,ie(e=Ee(Y(e)),t=U(t)))return u;const s=(_e,Xe,et)=>{const nt=et+1;let bt=_e[0];for(let ut=1;ut<_e.length;ut++)bt+=_e[ut]/Math.pow(nt,(Xe[ut]-Xe[0])/365);return bt},p=(_e,Xe,et)=>{const nt=et+1;let bt=0;for(let ut=1;ut<_e.length;ut++){const wt=(Xe[ut]-Xe[0])/365;bt-=wt*_e[ut]/Math.pow(nt,wt+1)}return bt},E=[];let O=!1,z=!1;for(let _e=0;_e<e.length;_e++)E[_e]=_e===0?0:E[_e-1]+365,e[_e]>0&&(O=!0),e[_e]<0&&(z=!0);if(!O||!z)return m;let re,pe,ke,De=t=t===void 0?.1:t,Pe=!0;do ke=s(e,E,De),re=De-ke/p(e,E,De),pe=Math.abs(re-De),De=re,Pe=pe>1e-10&&Math.abs(ke)>1e-10;while(Pe);return De},d.ISBLANK=function(e){return e===null},d.ISERR=Dt,d.ISERROR=ft,d.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},d.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},d.ISLOGICAL=Nt,d.ISNA=function(e){return e===C},d.ISNONTEXT=function(e){return typeof e!="string"},d.ISNUMBER=St,d.ISO=cn,d.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},d.ISOWEEKNUM=en,d.ISPMT=function(e,t,s,p){return ie(e=U(e),t=U(t),s=U(s),p=U(p))?u:p*e*(t/s-1)},d.ISREF=function(){throw new Error("ISREF is not implemented")},d.ISTEXT=j,d.KURT=function(){const e=Ee(Y(arguments));if(e instanceof Error)return e;const t=h.mean(e),s=e.length;let p=0;for(let E=0;E<s;E++)p+=Math.pow(e[E]-t,4);return p/=Math.pow(h.stdev(e,!0),4),s*(s+1)/((s-1)*(s-2)*(s-3))*p-3*(s-1)*(s-1)/((s-2)*(s-3))},d.LARGE=Je,d.LCM=function(){const e=Ee(Y(arguments));if(e instanceof Error)return e;for(var t,s,p,E,O=1;(p=e.pop())!==void 0;){if(p===0)return 0;for(;p>1;){if(p%2){for(t=3,s=Math.floor(Math.sqrt(p));t<=s&&p%t;t+=2);E=t<=s?t:p}else E=2;for(p/=E,O*=E,t=e.length;t;e[--t]%E==0&&(e[t]/=E)==1&&e.splice(t,1));}}return O},d.LEFT=function(e,t){return je(e,t)||(e=Ye(e),(t=U(t=t===void 0?1:t))instanceof Error||typeof e!="string"?u:e.substring(0,t))},d.LEN=function(e){return arguments.length===0?S:e instanceof Error?e:Array.isArray(e)?u:Ye(e).length},d.LINEST=ce,d.LN=function(e){return(e=U(e))instanceof Error?e:e===0?m:Math.log(e)},d.LOG=function(e,t){return je(e=U(e),t=U(t))||(e===0||t===0?m:Math.log(e)/Math.log(t))},d.LOG10=function(e){return(e=U(e))instanceof Error?e:e===0?m:Math.log(e)/Math.log(10)},d.LOGEST=function(e,t){if(ie(e=Ee(Y(e)),t=Ee(Y(t)))||e.length!==t.length)return u;for(let p=0;p<e.length;p++)e[p]=Math.log(e[p]);const s=ce(e,t);return s[0]=Math.round(1e6*Math.exp(s[0]))/1e6,s[1]=Math.round(1e6*Math.exp(s[1]))/1e6,s},d.LOGINV=Wn,d.LOGNORM=Ae,d.LOGNORMDIST=Xn,d.LOGNORMINV=Gn,d.LOOKUP=function(e,t,s){t=Y(t),s=s?Y(s):t;const p=typeof e=="number";let E=C;for(let O=0;O<t.length;O++){if(t[O]===e)return s[O];if(p&&t[O]<=e||typeof t[O]=="string"&&t[O].localeCompare(e)<0)E=s[O];else if(p&&t[O]>e)return E}return E},d.LOWER=function(e){return arguments.length!==1?u:ie(e=Ye(e))?e:e.toLowerCase()},d.MATCH=function(e,t,s){if(!e||!t||(arguments.length===2&&(s=1),!((t=Y(t))instanceof Array))||s!==-1&&s!==0&&s!==1)return C;let p,E;for(let O=0;O<t.length;O++)if(s===1){if(t[O]===e)return O+1;t[O]<e&&(E?t[O]>E&&(p=O+1,E=t[O]):(p=O+1,E=t[O]))}else if(s===0){if(typeof e=="string"&&typeof t[O]=="string"){const z=e.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\");if(new RegExp("^"+z+"$").test(t[O].toLowerCase()))return O+1}else if(t[O]===e)return O+1}else if(s===-1){if(t[O]===e)return O+1;t[O]>e&&(E?t[O]<E&&(p=O+1,E=t[O]):(p=O+1,E=t[O]))}return p||C},d.MAX=X,d.MAXA=function(){const e=Y(arguments),t=je.apply(void 0,e);if(t)return t;let s=T(e);return s=s.map(p=>p??0),s.length===0?0:Math.max.apply(Math,s)},d.MDURATION=function(){throw new Error("MDURATION is not implemented")},d.MEDIAN=W,d.MID=function(e,t,s){if(t==null)return u;if(ie(t=U(t),s=U(s))||typeof e!="string")return s;const p=t-1,E=p+s;return e.substring(p,E)},d.MIN=oe,d.MINA=function(){const e=Y(arguments),t=je.apply(void 0,e);if(t)return t;let s=T(e);return s=s.map(p=>p??0),s.length===0?0:Math.min.apply(Math,s)},d.MINUTE=function(e){return(e=He(e))instanceof Error?e:e.getMinutes()},d.MIRR=function(e,t,s){if(ie(e=Ee(Y(e)),t=U(t),s=U(s)))return u;const p=e.length,E=[],O=[];for(let pe=0;pe<p;pe++)e[pe]<0?E.push(e[pe]):O.push(e[pe]);const z=-Zt(s,O)*Math.pow(1+s,p-1),re=Zt(t,E)*(1+t);return Math.pow(z/re,1/(p-1))-1},d.MMULT=function(e,t){return!Array.isArray(e)||!Array.isArray(t)||e.some(s=>!s.length)||t.some(s=>!s.length)||ae(e).some(s=>typeof s!="number")||ae(t).some(s=>typeof s!="number")||e[0].length!==t.length?u:Array(e.length).fill(0).map(()=>Array(t[0].length).fill(0)).map((s,p)=>s.map((E,O)=>e[p].reduce((z,re,pe)=>z+re*t[pe][O],0)))},d.MOD=function(e,t){const s=je(e=U(e),t=U(t));if(s)return s;if(t===0)return b;let p=Math.abs(e%t);return p=e<0?t-p:p,t>0?p:-p},d.MODE=w,d.MODEMULT=$n,d.MODESNGL=Kn,d.MONTH=function(e){return(e=He(e))instanceof Error?e:e.getMonth()+1},d.MROUND=function(e,t){return je(e=U(e),t=U(t))||(e*t==0?0:e*t<0?m:Math.round(e/t)*t)},d.MULTINOMIAL=function(){const e=Ee(Y(arguments));if(e instanceof Error)return e;let t=0,s=1;for(let p=0;p<e.length;p++)t+=e[p],s*=qe(e[p]);return qe(t)/s},d.MUNIT=function(e){return arguments.length>1?C:!(e=parseInt(e))||e<=0?u:Array(e).fill(0).map(()=>Array(e).fill(0)).map((t,s)=>(t[s]=1,t))},d.N=function(e){return St(e)?e:e instanceof Date?e.getTime():e===!0?1:e===!1?0:ft(e)?e:0},d.NA=function(){return C},d.NEGBINOM=P,d.NEGBINOMDIST=Jn,d.NETWORKDAYS=_t,d.NETWORKDAYSINTL=Zn,d.NOMINAL=function(e,t){return ie(e=U(e),t=U(t))?u:e<=0||t<1?m:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},d.NORM=J,d.NORMDIST=Qn,d.NORMINV=er,d.NORMSDIST=tr,d.NORMSINV=nr,d.NOT=function(e){return typeof e=="string"?u:e instanceof Error?e:!e},d.NOW=function(){return new Date},d.NPER=function(e,t,s,p,E){if(E=E===void 0?0:E,p=p===void 0?0:p,ie(e=U(e),t=U(t),s=U(s),p=U(p),E=U(E)))return u;if(e===0)return-(s+p)/t;{const O=t*(1+e*E)-p*e,z=s*e+t*(1+e*E);return Math.log(O/z)/Math.log(1+e)}},d.NPV=Zt,d.NUMBERVALUE=function(e,t,s){return typeof(e=Ie(e)?e:"")=="number"?e:typeof e!="string"?C:(t=t===void 0?".":t,s=s===void 0?",":s,Number(e.replace(t,".").replace(s,"")))},d.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return m;const s=!(e.length!==10||e.substring(0,1)!=="7"),p=s?parseInt(e,8)-1073741824:parseInt(e,8);if(p<-512||p>511)return m;if(s)return"1"+gt("0",9-(512+p).toString(2).length)+(512+p).toString(2);const E=p.toString(2);return t===void 0?E:isNaN(t)?u:t<0?m:(t=Math.floor(t))>=E.length?gt("0",t-E.length)+E:m},d.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return m;const t=parseInt(e,8);return t>=536870912?t-1073741824:t},d.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return m;const s=parseInt(e,8);if(s>=536870912)return"ff"+(s+3221225472).toString(16);const p=s.toString(16);return t===void 0?p:isNaN(t)?u:t<0?m:(t=Math.floor(t))>=p.length?gt("0",t-p.length)+p:m},d.ODD=function(e){if((e=U(e))instanceof Error)return e;let t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>=0?t:-t},d.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},d.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},d.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},d.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},d.OR=function(){const e=Y(arguments);let t=u;for(let s=0;s<e.length;s++){if(e[s]instanceof Error)return e[s];e[s]!==void 0&&e[s]!==null&&typeof e[s]!="string"&&(t===u&&(t=!1),e[s]&&(t=!0))}return t},d.PDURATION=function(e,t,s){return ie(e=U(e),t=U(t),s=U(s))?u:e<=0?m:(Math.log(s)-Math.log(t))/Math.log(1+e)},d.PEARSON=me,d.PERCENTILE=Z,d.PERCENTILEEXC=rr,d.PERCENTILEINC=or,d.PERCENTRANK=ue,d.PERCENTRANKEXC=sr,d.PERCENTRANKINC=ir,d.PERMUT=function(e,t){return ie(e=U(e),t=U(t))?u:qe(e)/qe(e-t)},d.PERMUTATIONA=function(e,t){return ie(e=U(e),t=U(t))?u:Math.pow(e,t)},d.PHI=function(e){return(e=U(e))instanceof Error?u:Math.exp(-.5*e*e)/2.5066282746310002},d.PI=function(){return Math.PI},d.PMT=Lt,d.POISSON=ye,d.POISSONDIST=ar,d.POWER=Qt,d.PPMT=function(e,t,s,p,E,O){return E=E||0,O=O||0,ie(e=U(e),s=U(s),p=U(p),E=U(E),O=U(O))?u:Lt(e,s,p,E,O)-un(e,t,s,p,E,O)},d.PRICE=function(){throw new Error("PRICE is not implemented")},d.PRICEDISC=function(e,t,s,p,E){if(ie(e=He(e),t=He(t),s=U(s),p=U(p),E=(E=U(E))||0))return u;if(s<=0||p<=0)return m;if(e>=t)return u;let O,z;switch(E){case 0:O=360,z=xt(e,t,!1);break;case 1:case 3:O=365,z=Mt(e,t,"D");break;case 2:O=360,z=Mt(e,t,"D");break;case 4:O=360,z=xt(e,t,!0);break;default:return m}return p-s*p*z/O},d.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},d.PROB=function(e,t,s,p){if(s===void 0)return 0;if(p=p===void 0?s:p,ie(e=Ee(Y(e)),t=Ee(Y(t)),s=U(s),p=U(p)))return u;if(s===p)return e.indexOf(s)>=0?t[e.indexOf(s)]:0;const E=e.sort((re,pe)=>re-pe),O=E.length;let z=0;for(let re=0;re<O;re++)E[re]>=s&&E[re]<=p&&(z+=t[e.indexOf(E[re])]);return z},d.PRODUCT=Bt,d.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},d.PROPER=function(e){return ie(e)?e:isNaN(e)&&typeof e=="number"?u:(e=Ye(e)).replace(/\w\S*/g,t=>t.charAt(0).toUpperCase()+t.substr(1).toLowerCase())},d.PV=function(e,t,s,p,E){return p=p||0,E=E||0,ie(e=U(e),t=U(t),s=U(s),p=U(p),E=U(E))?u:e===0?-s*t-p:((1-Math.pow(1+e,t))/e*s*(1+e*E)-p)/Math.pow(1+e,t)},d.QUARTILE=Re,d.QUARTILEEXC=lr,d.QUARTILEINC=ur,d.QUOTIENT=function(e,t){return je(e=U(e),t=U(t))||parseInt(e/t,10)},d.RADIANS=function(e){return(e=U(e))instanceof Error?e:e*Math.PI/180},d.RAND=function(){return Math.random()},d.RANDBETWEEN=function(e,t){return je(e=U(e),t=U(t))||e+Math.ceil((t-e+1)*Math.random())-1},d.RANK=we,d.RANKAVG=cr,d.RANKEQ=dr,d.RATE=function(e,t,s,p,E,O){if(O=O===void 0?.01:O,p=p===void 0?0:p,E=E===void 0?0:E,ie(e=U(e),t=U(t),s=U(s),p=U(p),E=U(E),O=U(O)))return u;const z=1e-10;let re=O;E=E?1:0;for(let pe=0;pe<20;pe++){if(re<=-1)return m;let ke,De,Pe;if(Math.abs(re)<z?ke=s*(1+e*re)+t*(1+re*E)*e+p:(De=Math.pow(1+re,e),ke=s*De+t*(1/re+E)*(De-1)+p),Math.abs(ke)<z)return re;if(Math.abs(re)<z)Pe=s*e+t*E*e;else{De=Math.pow(1+re,e);const _e=e*Math.pow(1+re,e-1);Pe=s*_e+t*(1/re+E)*_e+t*(-1/(re*re))*(De-1)}re-=ke/Pe}return re},d.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},d.REPLACE=function(e,t,s,p){return ie(t=U(t),s=U(s))||typeof e!="string"||typeof p!="string"?u:e.substr(0,t-1)+p+e.substr(t-1+s)},d.REPT=gt,d.RIGHT=function(e,t){return je(e,t)||(e=Ye(e),(t=U(t=t===void 0?1:t))instanceof Error?t:e.substring(e.length-t))},d.ROMAN=function(e){if((e=U(e))instanceof Error)return e;const t=String(e).split(""),s=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let p="",E=3;for(;E--;)p=(s[+t.pop()+10*E]||"")+p;return new Array(+t.join("")+1).join("M")+p},d.ROUND=yt,d.ROUNDDOWN=function(e,t){return je(e=U(e),t=U(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},d.ROUNDUP=function(e,t){return je(e=U(e),t=U(t))||(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},d.ROW=function(e,t){return arguments.length!==2?C:t<0?m:e instanceof Array&&typeof t=="number"?e.length!==0?h.row(e,t):void 0:u},d.ROWS=function(e){return arguments.length!==1?C:e instanceof Array?e.length===0?0:h.rows(e):u},d.RRI=function(e,t,s){return ie(e=U(e),t=U(t),s=U(s))?u:e===0||t===0?m:Math.pow(s/t,1/e)-1},d.RSQ=function(e,t){return ie(e=Ee(Y(e)),t=Ee(Y(t)))?u:Math.pow(me(e,t),2)},d.SEARCH=function(e,t,s){let p;return typeof e!="string"||typeof t!="string"?u:(s=s===void 0?0:s,p=t.toLowerCase().indexOf(e.toLowerCase(),s-1)+1,p===0?u:p)},d.SEC=function(e){return(e=U(e))instanceof Error?e:1/Math.cos(e)},d.SECH=function(e){return(e=U(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},d.SECOND=function(e){return(e=He(e))instanceof Error?e:e.getSeconds()},d.SERIESSUM=function(e,t,s,p){if(ie(e=U(e),t=U(t),s=U(s),p=Ee(p)))return u;let E=p[0]*Math.pow(e,t);for(let O=1;O<p.length;O++)E+=p[O]*Math.pow(e,t+O*s);return E},d.SHEET=function(){throw new Error("SHEET is not implemented")},d.SHEETS=function(){throw new Error("SHEETS is not implemented")},d.SIGN=function(e){return(e=U(e))instanceof Error?e:e<0?-1:e===0?0:1},d.SIN=function(e){return(e=U(e))instanceof Error?e:Math.sin(e)},d.SINH=function(e){return(e=U(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},d.SKEW=Ne,d.SKEWP=fr,d.SLN=function(e,t,s){return ie(e=U(e),t=U(t),s=U(s))?u:s===0?m:(e-t)/s},d.SLOPE=function(e,t){if(ie(e=Ee(Y(e)),t=Ee(Y(t))))return u;const s=h.mean(t),p=h.mean(e),E=t.length;let O=0,z=0;for(let re=0;re<E;re++)O+=(t[re]-s)*(e[re]-p),z+=Math.pow(t[re]-s,2);return O/z},d.SMALL=Be,d.SORT=function(e,t=1,s=1,p=!1){if(!e||!Array.isArray(e))return C;if(e.length===0)return 0;if(!(t=U(t))||t<1||(s=U(s))!==1&&s!==-1)return u;if(typeof(p=Ue(p))!="boolean")return v;const E=re=>re.sort((pe,ke)=>(pe=Ye(pe[t-1]),ke=Ye(ke[t-1]),s===1?pe<ke?-1*s:s:pe>ke?s:-1*s)),O=G(e),z=p?xe(O):O;return t>=1&&t<=z[0].length?p?xe(E(z)):E(z):u},d.SQRT=function(e){return(e=U(e))instanceof Error?e:e<0?m:Math.sqrt(e)},d.SQRTPI=function(e){return(e=U(e))instanceof Error?e:Math.sqrt(e*Math.PI)},d.STANDARDIZE=function(e,t,s){return ie(e=U(e),t=U(t),s=U(s))?u:(e-t)/s},d.STDEV=Ze,d.STDEVA=function(){const e=Ce.apply(this,arguments);return Math.sqrt(e)},d.STDEVP=pr,d.STDEVPA=function(){const e=Oe.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=m),t},d.STDEVS=mr,d.STEYX=function(e,t){if(ie(e=Ee(Y(e)),t=Ee(Y(t))))return u;const s=h.mean(t),p=h.mean(e),E=t.length;let O=0,z=0,re=0;for(let pe=0;pe<E;pe++)O+=Math.pow(e[pe]-p,2),z+=(t[pe]-s)*(e[pe]-p),re+=Math.pow(t[pe]-s,2);return Math.sqrt((O-z*z/re)/(E-2))},d.SUBSTITUTE=function(e,t,s,p){if(arguments.length<3)return C;if(e&&t){if(p===void 0)return e.split(t).join(s);{if(p=Math.floor(Number(p)),Number.isNaN(p)||p<=0)return u;let E=0,O=0;for(;E>-1&&e.indexOf(t,E)>-1;)if(E=e.indexOf(t,E+1),O++,E>-1&&O===p)return e.substring(0,E)+s+e.substring(E+t.length);return e}}return e},d.SUBTOTAL=function(e,t){if((e=U(e))instanceof Error)return e;switch(e){case 1:case 101:return r(t);case 2:case 102:return B(t);case 3:case 103:return K(t);case 4:case 104:return X(t);case 5:case 105:return oe(t);case 6:case 106:return Bt(t);case 7:case 107:return Ze.S(t);case 8:case 108:return Ze.P(t);case 9:case 109:return kt(t);case 10:case 110:return ve.S(t);case 11:case 111:return ve.P(t)}},d.SUM=kt,d.SUMIF=function(e,t,s){if(e=Y(e),s=s?Y(s):e,e instanceof Error)return e;if(t==null||t instanceof Error)return 0;let p=0;const E=t==="*",O=E?null:jt(t+"");for(let z=0;z<e.length;z++){const re=e[z],pe=s[z];if(E)p+=re;else{const ke=[dt(re,it)].concat(O);p+=mt(ke)?pe:0}}return p},d.SUMIFS=function(){const e=N(arguments),t=Ee(Y(e.shift()));if(t instanceof Error)return t;const s=e,p=s.length/2;for(let O=0;O<p;O++)s[2*O]=Y(s[2*O]);let E=0;for(let O=0;O<t.length;O++){let z=!1;for(let re=0;re<p;re++){const pe=s[2*re][O],ke=s[2*re+1];let De=!1;if(ke===void 0||ke==="*")De=!0;else{const Pe=jt(ke+""),_e=[dt(pe,it)].concat(Pe);De=mt(_e)}if(!De){z=!1;break}z=!0}z&&(E+=t[O])}return E},d.SUMPRODUCT=function(){if(!arguments||arguments.length===0)return u;const e=arguments.length+1;let t,s,p,E,O=0;for(let z=0;z<arguments[0].length;z++)if(arguments[0][z]instanceof Array)for(let re=0;re<arguments[0][z].length;re++){for(t=1,s=1;s<e;s++){const pe=arguments[s-1][z][re];if(pe instanceof Error)return pe;if(E=U(pe),E instanceof Error)return E;t*=E}O+=t}else{for(t=1,s=1;s<e;s++){const re=arguments[s-1][z];if(re instanceof Error)return re;if(p=U(re),p instanceof Error)return p;t*=p}O+=t}return O},d.SUMSQ=function(){const e=Ee(Y(arguments));if(e instanceof Error)return e;let t=0;const s=e.length;for(let p=0;p<s;p++)t+=St(e[p])?e[p]*e[p]:0;return t},d.SUMX2MY2=function(e,t){if(ie(e=Ee(Y(e)),t=Ee(Y(t))))return u;let s=0;for(let p=0;p<e.length;p++)s+=e[p]*e[p]-t[p]*t[p];return s},d.SUMX2PY2=function(e,t){if(ie(e=Ee(Y(e)),t=Ee(Y(t))))return u;let s=0;e=Ee(Y(e)),t=Ee(Y(t));for(let p=0;p<e.length;p++)s+=e[p]*e[p]+t[p]*t[p];return s},d.SUMXMY2=function(e,t){if(ie(e=Ee(Y(e)),t=Ee(Y(t))))return u;let s=0;e=Y(e),t=Y(t);for(let p=0;p<e.length;p++)s+=Math.pow(e[p]-t[p],2);return s},d.SWITCH=function(){let e;if(arguments.length>0){const t=arguments[0],s=arguments.length-1,p=Math.floor(s/2);let E=!1;const O=s%2!=0,z=s%2==0?null:arguments[arguments.length-1];if(p){for(let re=0;re<p;re++)if(t===arguments[2*re+1]){e=arguments[2*re+2],E=!0;break}}E||(e=O?z:C)}else e=u;return e},d.SYD=function(e,t,s,p){return ie(e=U(e),t=U(t),s=U(s),p=U(p))?u:s===0||p<1||p>s?m:(e-t)*(s-(p=parseInt(p,10))+1)*2/(s*(s+1))},d.T=function(e){return e instanceof Error||typeof e=="string"?e:""},d.TAN=function(e){return(e=U(e))instanceof Error?e:Math.tan(e)},d.TANH=function(e){if((e=U(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},d.TBILLEQ=function(e,t,s){return ie(e=He(e),t=He(t),s=U(s))?u:s<=0||e>t||t-e>31536e6?m:365*s/(360-s*xt(e,t,!1))},d.TBILLPRICE=function(e,t,s){return ie(e=He(e),t=He(t),s=U(s))?u:s<=0||e>t||t-e>31536e6?m:100*(1-s*xt(e,t,!1)/360)},d.TBILLYIELD=function(e,t,s){return ie(e=He(e),t=He(t),s=U(s))?u:s<=0||e>t||t-e>31536e6?m:360*(100-s)/(s*xt(e,t,!1))},d.TDIST=br,d.TDISTRT=hr,d.TEXT=function(e,t){if(e===void 0||e instanceof Error||t instanceof Error)return C;if(t==null)return"";if(typeof t=="number")return String(t);if(typeof t!="string")return u;const s=t.startsWith("$")?"$":"",p=t.endsWith("%");return p&&(e*=100),e=(e=sn(e,(t=t.replace(/%/g,"").replace(/\$/g,"")).split(".")[1].match(/0/g).length,!t.includes(","))).startsWith("-")?"-"+s+(e=e.replace("-","")):s+e,p&&(e+="%"),e},d.TEXTJOIN=function(e,t,...s){if(typeof t!="boolean"&&(t=Ue(t)),arguments.length<3)return C;e=e??"";let p=Y(s),E=t?p.filter(O=>O):p;if(Array.isArray(e)){e=Y(e);let O=E.map(re=>[re]),z=0;for(let re=0;re<O.length-1;re++)O[re].push(e[z]),z++,z===e.length&&(z=0);return E=Y(O),E.join("")}return E.join(e)},d.TIME=function(e,t,s){return ie(e=U(e),t=U(t),s=U(s))?u:e<0||t<0||s<0?m:(3600*e+60*t+s)/86400},d.TIMEVALUE=function(e){return(e=He(e))instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},d.TINV=gr,d.TODAY=function(){return Ft(new Date)},d.TRANSPOSE=function(e){return e?xe(G(e)):C},d.TREND=function(e,t,s){if(ie(e=Ee(Y(e)),t=Ee(Y(t)),s=Ee(Y(s))))return u;const p=ce(e,t),E=p[0],O=p[1],z=[];return s.forEach(re=>{z.push(E*re+O)}),z},d.TRIM=function(e){return(e=Ye(e))instanceof Error?e:e.replace(/\s+/g," ").trim()},d.TRIMMEAN=function(e,t){if(ie(e=Ee(Y(e)),t=U(t)))return u;const s=Ct(e.length*t,2)/2;return h.mean((E=(E=s)||1,(p=se(e.sort((O,z)=>O-z),s))&&typeof p.slice=="function"?p.slice(0,p.length-E):p));var p,E},d.TRUE=function(){return!0},d.TRUNC=function(e,t){return je(e=U(e),t=U(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},d.TTEST=vr,d.TYPE=function(e){return St(e)?1:j(e)?2:Nt(e)?4:ft(e)?16:Array.isArray(e)?64:void 0},d.UNICHAR=hn,d.UNICODE=gn,d.UNIQUE=A,d.UPPER=function(e){return(e=Ye(e))instanceof Error?e:e.toUpperCase()},d.VALUE=function(e){const t=je(e);if(t)return t;if(typeof e=="number")return e;if(Ie(e)||(e=""),typeof e!="string")return u;const s=/(%)$/.test(e)||/^(%)/.test(e);if((e=(e=(e=e.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,""))==="")return 0;let p=Number(e);return isNaN(p)?u:(p=p||0,s&&(p*=.01),p)},d.VAR=ve,d.VARA=Ce,d.VARP=jr,d.VARPA=Oe,d.VARS=yr,d.VDB=function(){throw new Error("VDB is not implemented")},d.VLOOKUP=l,d.WEEKDAY=function(e,t){if((e=He(e))instanceof Error)return e;t===void 0&&(t=1);const s=e.getDay();return mn[t][s]},d.WEEKNUM=function(e,t){if((e=He(e))instanceof Error)return e;if(t===void 0&&(t=1),t===21)return en(e);const s=pn[t];let p=new Date(e.getFullYear(),0,1);const E=p.getDay()<s?1:0;return p-=24*Math.abs(p.getDay()-s)*60*60*1e3,Math.floor((e-p)/864e5/7+1)+E},d.WEIBULL=tt,d.WEIBULLDIST=xr,d.WORKDAY=Ot,d.WORKDAYINTL=wr,d.XIRR=function(e,t,s){if(ie(e=Ee(Y(e)),t=lt(Y(t)),s=U(s)))return u;const p=(_e,Xe,et)=>{const nt=et+1;let bt=_e[0];for(let ut=1;ut<_e.length;ut++)bt+=_e[ut]/Math.pow(nt,At(Xe[ut],Xe[0])/365);return bt},E=(_e,Xe,et)=>{const nt=et+1;let bt=0;for(let ut=1;ut<_e.length;ut++){const wt=At(Xe[ut],Xe[0])/365;bt-=wt*_e[ut]/Math.pow(nt,wt+1)}return bt};let O=!1,z=!1;for(let _e=0;_e<e.length;_e++)e[_e]>0&&(O=!0),e[_e]<0&&(z=!0);if(!O||!z)return m;let re,pe,ke,De=s=s||.1,Pe=!0;do ke=p(e,t,De),re=De-ke/E(e,t,De),pe=Math.abs(re-De),De=re,Pe=pe>1e-10&&Math.abs(ke)>1e-10;while(Pe);return De},d.XNPV=function(e,t,s){if(ie(e=U(e),t=Ee(Y(t)),s=lt(Y(s))))return u;let p=0;for(let E=0;E<t.length;E++)p+=t[E]/Math.pow(1+e,At(s[E],s[0])/365);return p},d.XOR=function(){const e=Y(arguments);let t=u;for(let s=0;s<e.length;s++){if(e[s]instanceof Error)return e[s];e[s]!==void 0&&e[s]!==null&&typeof e[s]!="string"&&(t===u&&(t=0),e[s]&&t++)}return t===u?t:!!(1&Math.floor(Math.abs(t)))},d.YEAR=function(e){return(e=He(e))instanceof Error?e:e.getFullYear()},d.YEARFRAC=Ut,d.YIELD=function(){throw new Error("YIELD is not implemented")},d.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},d.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},d.Z=Ke,d.ZTEST=Cr,d.utils=kr}},f={};function k(q){var d=f[q];if(d!==void 0)return d.exports;var o=f[q]={exports:{}};return c[q].call(o.exports,o,o.exports,k),o.exports}k.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}();var R=k(960);a=R}(),a)},138:function(module,__unused_webpack_exports,__webpack_require__){if(!formula)var formula=__webpack_require__(243);var factory;factory=function(){var Version=(info={title:"Jspreadsheet",version:"4.13.2",type:"CE",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[this.title+" "+this.type+" "+this.version,this.host,this.license].join(`\r
`)}},function(){return info}),info,isFormula=function(n){var a=(""+n)[0];return a=="="||a=="#"},getMask=function(n){if(n.format||n.mask||n.locale){var a={};return n.mask?a.mask=n.mask:n.format?a.mask=n.format:(a.locale=n.locale,a.options=n.options),n.decimal&&(a.options||(a.options={}),a.options={decimal:n.decimal}),a}return null},jexcel=function(el,options){var obj={options:{}};if(!(el instanceof Element||el instanceof HTMLDocument))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;if(el.tagName=="TABLE"){if(!(options=jexcel.createFromTable(el,options)))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;var div=document.createElement("div");el.parentNode.insertBefore(div,el),el.remove(),el=div}var defaults={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",defaultRowHeight:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jspreadsheet",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,classes:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:!0};for(var property in defaults)if(options&&options.hasOwnProperty(property))if(property==="text")for(var textKey in obj.options[property]=defaults[property],options[property])options[property].hasOwnProperty(textKey)&&(obj.options[property][textKey]=options[property][textKey]);else obj.options[property]=options[property];else obj.options[property]=defaults[property];obj.el=el,obj.corner=null,obj.contextMenu=null,obj.textarea=null,obj.ads=null,obj.content=null,obj.table=null,obj.thead=null,obj.tbody=null,obj.rows=[],obj.results=null,obj.searchInput=null,obj.toolbar=null,obj.pagination=null,obj.pageNumber=null,obj.headerContainer=null,obj.colgroupContainer=null,obj.headers=[],obj.records=[],obj.history=[],obj.formula=[],obj.colgroup=[],obj.selection=[],obj.highlighted=[],obj.selectedCell=null,obj.selectedContainer=null,obj.style=[],obj.data=null,obj.filter=null,obj.filters=[],obj.cursor=null,obj.historyIndex=-1,obj.ignoreEvents=!1,obj.ignoreHistory=!1,obj.edition=null,obj.hashString=null,obj.resizing=null,obj.dragging=null,obj.options.lazyLoading==1&&obj.options.tableOverflow==0&&obj.options.fullscreen==0&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),obj.options.lazyLoading=!1),obj.fullscreen=function(n){n==null&&(n=!obj.options.fullscreen),obj.options.fullscreen!=n&&(obj.options.fullscreen=n,n==1?el.classList.add("fullscreen"):el.classList.remove("fullscreen"))},obj.dispatch=function(n){if(!obj.ignoreEvents){if(typeof obj.options.onevent=="function")var a=obj.options.onevent.apply(this,arguments);typeof obj.options[n]=="function"&&(a=obj.options[n].apply(this,Array.prototype.slice.call(arguments,1)))}if(n=="onafterchanges"&&obj.options.persistance){var c=obj.options.persistance==1?obj.options.url:obj.options.persistance,f=obj.prepareJson(arguments[2]);obj.save(c,f)}return a},obj.prepareTable=function(){var n=obj.options.columns.length;if(obj.options.data&&obj.options.data[0]!==void 0){var a=Object.keys(obj.options.data[0]);a.length>n&&(n=a.length)}obj.options.minDimensions[0]>n&&(n=obj.options.minDimensions[0]);for(var c=[],f=0;f<n;f++)obj.options.colHeaders[f]||(obj.options.colHeaders[f]=""),obj.options.colWidths[f]||(obj.options.colWidths[f]=obj.options.defaultColWidth),obj.options.colAlignments[f]||(obj.options.colAlignments[f]=obj.options.defaultColAlign),obj.options.columns[f]?obj.options.columns[f].type||(obj.options.columns[f].type="text"):obj.options.columns[f]={type:"text"},obj.options.columns[f].name||(obj.options.columns[f].name=a&&a[f]?a[f]:f),obj.options.columns[f].source||(obj.options.columns[f].source=[]),obj.options.columns[f].options||(obj.options.columns[f].options=[]),obj.options.columns[f].editor||(obj.options.columns[f].editor=null),obj.options.columns[f].allowEmpty||(obj.options.columns[f].allowEmpty=!1),obj.options.columns[f].title||(obj.options.columns[f].title=obj.options.colHeaders[f]?obj.options.colHeaders[f]:""),obj.options.columns[f].width||(obj.options.columns[f].width=obj.options.colWidths[f]?obj.options.colWidths[f]:obj.options.defaultColWidth),obj.options.columns[f].align||(obj.options.columns[f].align=obj.options.colAlignments[f]?obj.options.colAlignments[f]:"center"),obj.options.columns[f].type=="autocomplete"||obj.options.columns[f].type=="dropdown"?obj.options.columns[f].url&&c.push({url:obj.options.columns[f].url,index:f,method:"GET",dataType:"json",success:function(k){for(var R=0;R<k.length;R++)obj.options.columns[this.index].source.push(k[R])}}):obj.options.columns[f].type=="calendar"&&(obj.options.columns[f].options.format||(obj.options.columns[f].options.format="DD/MM/YYYY"));c.length?jSuites.ajax(c,function(){obj.createTable()}):obj.createTable()},obj.createTable=function(){obj.table=document.createElement("table"),obj.thead=document.createElement("thead"),obj.tbody=document.createElement("tbody"),obj.headers=[],obj.colgroup=[],obj.content=document.createElement("div"),obj.content.classList.add("jexcel_content"),obj.content.onscroll=function(m){obj.scrollControls(m)},obj.content.onwheel=function(m){obj.wheelControls(m)},obj.toolbar=document.createElement("div"),obj.toolbar.classList.add("jexcel_toolbar");var n=document.createElement("div"),a=document.createTextNode(obj.options.text.search+": ");obj.searchInput=document.createElement("input"),obj.searchInput.classList.add("jexcel_search"),n.appendChild(a),n.appendChild(obj.searchInput),obj.searchInput.onfocus=function(){obj.resetSelection()};var c=document.createElement("div");if(obj.options.pagination>0&&obj.options.paginationOptions&&obj.options.paginationOptions.length>0){obj.paginationDropdown=document.createElement("select"),obj.paginationDropdown.classList.add("jexcel_pagination_dropdown"),obj.paginationDropdown.onchange=function(){obj.options.pagination=parseInt(this.value),obj.page(0)};for(var f=0;f<obj.options.paginationOptions.length;f++){var k=document.createElement("option");k.value=obj.options.paginationOptions[f],k.innerHTML=obj.options.paginationOptions[f],obj.paginationDropdown.appendChild(k)}obj.paginationDropdown.value=obj.options.pagination,c.appendChild(document.createTextNode(obj.options.text.show)),c.appendChild(obj.paginationDropdown),c.appendChild(document.createTextNode(obj.options.text.entries))}var R,q=document.createElement("div");if(q.classList.add("jexcel_filter"),q.appendChild(c),q.appendChild(n),obj.colgroupContainer=document.createElement("colgroup"),(R=document.createElement("col")).setAttribute("width","50"),obj.colgroupContainer.appendChild(R),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var d=0;d<obj.options.nestedHeaders.length;d++)obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[d]));else obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));for(obj.headerContainer=document.createElement("tr"),(R=document.createElement("td")).classList.add("jexcel_selectall"),obj.headerContainer.appendChild(R),f=0;f<obj.options.columns.length;f++)obj.createCellHeader(f),obj.headerContainer.appendChild(obj.headers[f]),obj.colgroupContainer.appendChild(obj.colgroup[f]);if(obj.thead.appendChild(obj.headerContainer),obj.options.filters==1){obj.filter=document.createElement("tr");var o=document.createElement("td");for(obj.filter.appendChild(o),f=0;f<obj.options.columns.length;f++)(o=document.createElement("td")).innerHTML="&nbsp;",o.setAttribute("data-x",f),o.className="jexcel_column_filter",obj.options.columns[f].type=="hidden"&&(o.style.display="none"),obj.filter.appendChild(o);obj.thead.appendChild(obj.filter)}obj.table=document.createElement("table"),obj.table.classList.add("jexcel"),obj.table.setAttribute("cellpadding","0"),obj.table.setAttribute("cellspacing","0"),obj.table.setAttribute("unselectable","yes"),obj.table.appendChild(obj.colgroupContainer),obj.table.appendChild(obj.thead),obj.table.appendChild(obj.tbody),obj.options.textOverflow||obj.table.classList.add("jexcel_overflow"),obj.corner=document.createElement("div"),obj.corner.className="jexcel_corner",obj.corner.setAttribute("unselectable","on"),obj.corner.setAttribute("onselectstart","return false"),obj.options.selectionCopy==0&&(obj.corner.style.display="none"),obj.textarea=document.createElement("textarea"),obj.textarea.className="jexcel_textarea",obj.textarea.id="jexcel_textarea",obj.textarea.tabIndex="-1",obj.contextMenu=document.createElement("div"),obj.contextMenu.className="jexcel_contextmenu",jSuites.contextmenu(obj.contextMenu,{onclick:function(){obj.contextMenu.contextmenu.close(!1)}});var h=document.createElement("a");h.setAttribute("href","https://bossanova.uk/jspreadsheet/"),obj.ads=document.createElement("div"),obj.ads.className="jexcel_about";try{if(typeof sessionStorage<"u"&&!sessionStorage.getItem("jexcel")){sessionStorage.setItem("jexcel",!0);var _=document.createElement("img");_.src="//bossanova.uk/jspreadsheet/logo.png",h.appendChild(_)}}catch{}var V=document.createElement("span");V.innerHTML="Jspreadsheet CE",h.appendChild(V),obj.ads.appendChild(h),document.createElement("div").classList.add("jexcel_table"),obj.pagination=document.createElement("div"),obj.pagination.classList.add("jexcel_pagination");var b=document.createElement("div"),u=document.createElement("div");if(obj.pagination.appendChild(b),obj.pagination.appendChild(u),obj.options.pagination||(obj.pagination.style.display="none"),obj.options.search==1&&el.appendChild(q),obj.content.appendChild(obj.table),obj.content.appendChild(obj.corner),obj.content.appendChild(obj.textarea),el.appendChild(obj.toolbar),el.appendChild(obj.content),el.appendChild(obj.pagination),el.appendChild(obj.contextMenu),el.appendChild(obj.ads),el.classList.add("jexcel_container"),obj.options.toolbar&&obj.options.toolbar.length&&obj.createToolbar(),obj.options.fullscreen==1?el.classList.add("fullscreen"):obj.options.tableOverflow==1&&(obj.options.tableHeight&&(obj.content.style["overflow-y"]="auto",obj.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",obj.content.style.maxHeight=obj.options.tableHeight),obj.options.tableWidth&&(obj.content.style["overflow-x"]="auto",obj.content.style.width=obj.options.tableWidth)),obj.options.tableOverflow!=1&&obj.options.toolbar&&el.classList.add("with-toolbar"),obj.options.columnDrag==1&&obj.thead.classList.add("draggable"),obj.options.columnResize==1&&obj.thead.classList.add("resizable"),obj.options.rowDrag==1&&obj.tbody.classList.add("draggable"),obj.options.rowResize==1&&obj.tbody.classList.add("resizable"),obj.setData(),obj.options.style&&obj.setStyle(obj.options.style,null,null,1,1),obj.options.classes){var g=Object.keys(obj.options.classes);for(f=0;f<g.length;f++){var v=jexcel.getIdFromColumnName(g[f],!0);obj.records[v[1]][v[0]].classList.add(obj.options.classes[g[f]])}}},obj.refresh=function(){obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(n){obj.options.data=n.data?n.data:n,obj.setData(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.setData()},obj.setData=function(n){if(n&&(typeof n=="string"&&(n=JSON.parse(n)),obj.options.data=n),obj.options.data||(obj.options.data=[]),obj.options.data&&obj.options.data[0]&&!Array.isArray(obj.options.data[0])){n=[];for(var a=0;a<obj.options.data.length;a++){for(var c=[],f=0;f<obj.options.columns.length;f++)c[f]=obj.options.data[a][obj.options.columns[f].name];n.push(c)}obj.options.data=n}a=0,f=0;var k=obj.options.columns.length,R=obj.options.data.length,q=obj.options.minDimensions[0],d=obj.options.minDimensions[1],o=q>k?q:k,h=d>R?d:R;for(a=0;a<h;a++)for(f=0;f<o;f++)obj.options.data[a]==null&&(obj.options.data[a]=[]),obj.options.data[a][f]==null&&(obj.options.data[a][f]="");if(obj.rows=[],obj.results=null,obj.records=[],obj.history=[],obj.historyIndex=-1,obj.tbody.innerHTML="",obj.options.lazyLoading==1){var _=0,V=obj.options.data.length<100?obj.options.data.length:100;obj.options.pagination&&(obj.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))}else obj.options.pagination?(obj.pageNumber||(obj.pageNumber=0),obj.options.pagination,_=obj.options.pagination*obj.pageNumber,V=obj.options.pagination*obj.pageNumber+obj.options.pagination,obj.options.data.length<V&&(V=obj.options.data.length)):(_=0,V=obj.options.data.length);for(a=0;a<obj.options.data.length;a++){var b=obj.createRow(a,obj.options.data[a]);a>=_&&a<V&&obj.tbody.appendChild(b)}if(obj.options.lazyLoading==1||obj.options.pagination&&obj.updatePagination(),obj.options.mergeCells){var u=Object.keys(obj.options.mergeCells);for(f=0;f<u.length;f++){var g=obj.options.mergeCells[u[f]];obj.setMerge(u[f],g[0],g[1],1)}}obj.updateTable(),obj.dispatch("onload",el,obj)},obj.getData=function(n,a){for(var c=[],f=0,k=0,R=a==1||obj.options.copyCompatibility==0,q=obj.options.columns.length,d=obj.options.data.length,o=0;o<d;o++){f=0;for(var h=0;h<q;h++)n&&!obj.records[o][h].classList.contains("highlight")||(c[k]||(c[k]=[]),c[k][f]=R?obj.options.data[o][h]:obj.records[o][h].innerHTML,f++);f>0&&k++}return c},obj.getJsonRow=function(n){for(var a=obj.options.data[n],c=obj.options.columns.length,f={},k=0;k<c;k++)obj.options.columns[k].name||(obj.options.columns[k].name=k),f[obj.options.columns[k].name]=a[k];return f},obj.getJson=function(n){for(var a=[],c=obj.options.columns.length,f=obj.options.data.length,k=0;k<f;k++){for(var R=null,q=0;q<c;q++)n&&!obj.records[k][q].classList.contains("highlight")||(R==null&&(R={}),obj.options.columns[q].name||(obj.options.columns[q].name=q),R[obj.options.columns[q].name]=obj.options.data[k][q]);R!=null&&a.push(R)}return a},obj.prepareJson=function(n){for(var a=[],c=0;c<n.length;c++){var f=n[c].x,k=n[c].y,R=obj.options.columns[f].name?obj.options.columns[f].name:f;a[k]||(a[k]={row:k,data:{}}),a[k].data[R]=n[c].newValue}return a.filter(function(q){return q!=null})},obj.save=function(n,a){var c=obj.dispatch("onbeforesave",el,obj,a);if(c)a=c;else if(c===!1)return!1;jSuites.ajax({url:n,method:"POST",dataType:"json",data:{data:JSON.stringify(a)},success:function(f){obj.dispatch("onsave",el,obj,a)}})},obj.getRowData=function(n){return obj.options.data[n]},obj.setRowData=function(n,a){for(var c=0;c<obj.headers.length;c++){var f=jexcel.getColumnNameFromId([c,n]);a[c]!=null&&obj.setValue(f,a[c])}},obj.getColumnData=function(n){for(var a=[],c=0;c<obj.options.data.length;c++)a.push(obj.options.data[c][n]);return a},obj.setColumnData=function(n,a){for(var c=0;c<obj.rows.length;c++){var f=jexcel.getColumnNameFromId([n,c]);a[c]!=null&&obj.setValue(f,a[c])}},obj.createRow=function(n,a){obj.records[n]||(obj.records[n]=[]),a||(a=obj.options.data[n]),obj.rows[n]=document.createElement("tr"),obj.rows[n].setAttribute("data-y",n);var c=null;obj.options.defaultRowHeight&&(obj.rows[n].style.height=obj.options.defaultRowHeight+"px"),obj.options.rows[n]&&(obj.options.rows[n].height&&(obj.rows[n].style.height=obj.options.rows[n].height),obj.options.rows[n].title&&(c=obj.options.rows[n].title)),c||(c=parseInt(n+1));var f=document.createElement("td");f.innerHTML=c,f.setAttribute("data-y",n),f.className="jexcel_row",obj.rows[n].appendChild(f);for(var k=0;k<obj.options.columns.length;k++)obj.records[n][k]=obj.createCell(k,n,a[k]),obj.rows[n].appendChild(obj.records[n][k]);return obj.rows[n]},obj.parseValue=function(n,a,c,f){(""+c).substr(0,1)=="="&&obj.options.parseFormulas==1&&(c=obj.executeFormula(c,n,a));var k=obj.options.columns[n];if(k&&!isFormula(c)){var R=null;if(R=getMask(k)){c&&c==Number(c)&&(c=Number(c));var q=jSuites.mask.render(c,R,!0);if(f&&R.mask){var d=R.mask.split(";");d[1]&&(d[1].match(new RegExp("\\[Red\\]","gi"))&&(c<0?f.classList.add("red"):f.classList.remove("red")),d[1].match(new RegExp("\\(","gi"))&&c<0&&(q="("+q+")"))}q&&(c=q)}}return c};var validDate=function(n){return(n=""+n).substr(4,1)=="-"&&n.substr(7,1)=="-"||(n=n.split("-"))[0].length==4&&n[0]==Number(n[0])&&n[1].length==2&&n[1]==Number(n[1])};obj.createCell=function(n,a,c){var f=document.createElement("td");if(f.setAttribute("data-x",n),f.setAttribute("data-y",a),(""+c).substr(0,1)=="="&&obj.options.secureFormulas==1){var k=secureFormula(c);k!=c&&(c=k)}if(obj.options.columns[n].editor)obj.options.stripHTML===!1||obj.options.columns[n].stripHTML===!1?f.innerHTML=c:f.textContent=c,typeof obj.options.columns[n].editor.createCell=="function"&&(f=obj.options.columns[n].editor.createCell(f));else if(obj.options.columns[n].type=="hidden")f.style.display="none",f.textContent=c;else if(obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio"){var R=document.createElement("input");R.type=obj.options.columns[n].type,R.name="c"+n,R.checked=c==1||c==1||c=="true",R.onclick=function(){obj.setValue(f,this.checked)},obj.options.columns[n].readOnly!=1&&obj.options.editable!=0||R.setAttribute("disabled","disabled"),f.appendChild(R),obj.options.data[a][n]=R.checked}else if(obj.options.columns[n].type=="calendar"){var q=null;if(!validDate(c)){var d=jSuites.calendar.extractDateFromString(c,obj.options.columns[n].options.format);d&&(q=d)}f.textContent=jSuites.calendar.getDateString(q||c,obj.options.columns[n].options.format)}else if(obj.options.columns[n].type=="dropdown"||obj.options.columns[n].type=="autocomplete")f.classList.add("jexcel_dropdown"),f.textContent=obj.getDropDownValue(n,c);else if(obj.options.columns[n].type=="color")if(obj.options.columns[n].render=="square"){var o=document.createElement("div");o.className="color",o.style.backgroundColor=c,f.appendChild(o)}else f.style.color=c,f.textContent=c;else if(obj.options.columns[n].type=="image"){if(c&&c.substr(0,10)=="data:image"){var h=document.createElement("img");h.src=c,f.appendChild(h)}}else obj.options.columns[n].type=="html"||obj.options.stripHTML===!1||obj.options.columns[n].stripHTML===!1?f.innerHTML=stripScript(obj.parseValue(n,a,c,f)):f.textContent=obj.parseValue(n,a,c,f);obj.options.columns[n].readOnly==1&&(f.className="readonly");var _=obj.options.columns[n].align?obj.options.columns[n].align:"center";return f.style.textAlign=_,obj.options.columns[n].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[n].wordWrap==1||f.innerHTML.length>200)&&(f.style.whiteSpace="pre-wrap"),n>0&&this.options.textOverflow==1&&(c||f.innerHTML?obj.records[a][n-1].style.overflow="hidden":n==obj.options.columns.length-1&&(f.style.overflow="hidden")),f},obj.createCellHeader=function(n){var a=obj.options.columns[n].width?obj.options.columns[n].width:obj.options.defaultColWidth,c=obj.options.columns[n].align?obj.options.columns[n].align:obj.options.defaultColAlign;obj.headers[n]=document.createElement("td"),obj.options.stripHTML?obj.headers[n].textContent=obj.options.columns[n].title?obj.options.columns[n].title:jexcel.getColumnName(n):obj.headers[n].innerHTML=obj.options.columns[n].title?obj.options.columns[n].title:jexcel.getColumnName(n),obj.headers[n].setAttribute("data-x",n),obj.headers[n].style.textAlign=c,obj.options.columns[n].title&&obj.headers[n].setAttribute("title",obj.headers[n].innerText),obj.options.columns[n].id&&obj.headers[n].setAttribute("id",obj.options.columns[n].id),obj.colgroup[n]=document.createElement("col"),obj.colgroup[n].setAttribute("width",a),obj.options.columns[n].type=="hidden"&&(obj.headers[n].style.display="none",obj.colgroup[n].style.display="none")},obj.updateNestedHeader=function(n,a,c){obj.options.nestedHeaders[a][n].title&&(obj.options.nestedHeaders[a][n].title=c,obj.options.nestedHeaders[a].element.children[n+1].textContent=c)},obj.createNestedHeader=function(n){var a=document.createElement("tr");a.classList.add("jexcel_nested");var c=document.createElement("td");a.appendChild(c),n.element=a;for(var f=0,k=0;k<n.length;k++){n[k].colspan||(n[k].colspan=1),n[k].align||(n[k].align="center"),n[k].title||(n[k].title=""),n[k].id||(n[k].id="");for(var R=n[k].colspan,q=[],d=0;d<R;d++)obj.options.columns[f]&&obj.options.columns[f].type=="hidden"&&R++,q.push(f),f++;(c=document.createElement("td")).setAttribute("data-column",q.join(",")),c.setAttribute("colspan",n[k].colspan),c.setAttribute("align",n[k].align),c.setAttribute("id",n[k].id),c.textContent=n[k].title,a.appendChild(c)}return a},obj.createToolbar=function(n){n?obj.options.toolbar=n:n=obj.options.toolbar;for(var a=0;a<n.length;a++)if(n[a].type=="i")(R=document.createElement("i")).classList.add("jexcel_toolbar_item"),R.classList.add("material-icons"),R.setAttribute("data-k",n[a].k),R.setAttribute("data-v",n[a].v),R.setAttribute("id",n[a].id),n[a].tooltip&&R.setAttribute("title",n[a].tooltip),n[a].onclick&&(n[a].onclick,1)?R.onclick=function(q){var d=q;return function(){n[d].onclick(el,obj,this)}}(a):R.onclick=function(){var q=this.getAttribute("data-k"),d=this.getAttribute("data-v");obj.setStyle(obj.highlighted,q,d)},R.textContent=n[a].content,obj.toolbar.appendChild(R);else if(n[a].type=="select"){var c=!1;(R=document.createElement("select")).classList.add("jexcel_toolbar_item"),R.setAttribute("data-k",n[a].k),n[a].tooltip&&R.setAttribute("title",n[a].tooltip),n[a].onchange&&(n[a].onchange,1)?(R.onchange=n[a].onchange,c=!0):R.onchange=function(){var q=this.getAttribute("data-k");obj.setStyle(obj.highlighted,q,this.value)};for(var f=0;f<n[a].v.length;f++){var k=document.createElement("option");k.value=n[a].v[f],k.textContent=n[a].v[f],n[a].selectedValue&&k.value===n[a].selectedValue&&(k.selected=!0),R.appendChild(k)}c&&R.dispatchEvent(new Event("change")),obj.toolbar.appendChild(R)}else if(n[a].type=="color"){var R;(R=document.createElement("i")).classList.add("jexcel_toolbar_item"),R.classList.add("material-icons"),R.setAttribute("data-k",n[a].k),R.setAttribute("data-v",""),n[a].tooltip&&R.setAttribute("title",n[a].tooltip),obj.toolbar.appendChild(R),R.textContent=n[a].content,jSuites.color(R,{onchange:function(q,d){var o=q.getAttribute("data-k");obj.setStyle(obj.highlighted,o,d)}})}},obj.setMerge=function(n,a,c,f){var k=!1;if(!n){if(!obj.highlighted.length)return alert(obj.options.text.noCellsSelected),null;var R=parseInt(obj.highlighted[0].getAttribute("data-x")),q=parseInt(obj.highlighted[0].getAttribute("data-y")),d=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-x")),o=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-y"));n=jexcel.getColumnNameFromId([R,q]),a=d-R+1,c=o-q+1}var h=jexcel.getIdFromColumnName(n,!0);if(obj.options.mergeCells[n])obj.records[h[1]][h[0]].getAttribute("data-merged")&&(k=obj.options.text.cellAlreadyMerged);else if((!a||a<2)&&(!c||c<2))k=obj.options.text.invalidMergeProperties;else for(var _=h[1];_<h[1]+c;_++)for(var V=h[0];V<h[0]+a;V++)jexcel.getColumnNameFromId([V,_]),obj.records[_][V].getAttribute("data-merged")&&(k=obj.options.text.thereIsAConflictWithAnotherMergedCell);if(k)alert(k);else{a>1?obj.records[h[1]][h[0]].setAttribute("colspan",a):a=1,c>1?obj.records[h[1]][h[0]].setAttribute("rowspan",c):c=1,obj.options.mergeCells[n]=[a,c,[]],obj.records[h[1]][h[0]].setAttribute("data-merged","true"),obj.records[h[1]][h[0]].style.overflow="hidden";for(var b=[],u=h[1];u<h[1]+c;u++)for(var g=h[0];g<h[0]+a;g++)h[0]==g&&h[1]==u||(b.push(obj.options.data[u][g]),obj.updateCell(g,u,"",!0),obj.options.mergeCells[n][2].push(obj.records[u][g]),obj.records[u][g].style.display="none",obj.records[u][g]=obj.records[h[1]][h[0]]);obj.updateSelection(obj.records[h[1]][h[0]]),f||(obj.setHistory({action:"setMerge",column:n,colspan:a,rowspan:c,data:b}),obj.dispatch("onmerge",el,n,a,c))}},obj.getMerge=function(n){var a={};if(n)a=obj.options.mergeCells[n]?[obj.options.mergeCells[n][0],obj.options.mergeCells[n][1]]:null;else if(obj.options.mergeCells){obj.options.mergeCells;for(var c=Object.keys(obj.options.mergeCells),f=0;f<c.length;f++)a[c[f]]=[obj.options.mergeCells[c[f]][0],obj.options.mergeCells[c[f]][1]]}return a},obj.removeMerge=function(n,a,c){if(obj.options.mergeCells[n]){var f=jexcel.getIdFromColumnName(n,!0);obj.records[f[1]][f[0]].removeAttribute("colspan"),obj.records[f[1]][f[0]].removeAttribute("rowspan"),obj.records[f[1]][f[0]].removeAttribute("data-merged");for(var k=obj.options.mergeCells[n],R=0,q=0;q<k[1];q++)for(var d=0;d<k[0];d++)(q>0||d>0)&&(obj.records[f[1]+q][f[0]+d]=k[2][R],obj.records[f[1]+q][f[0]+d].style.display="",a&&a[R]&&obj.updateCell(f[0]+d,f[1]+q,a[R]),R++);obj.updateSelection(obj.records[f[1]][f[0]],obj.records[f[1]+q-1][f[0]+d-1]),c||delete obj.options.mergeCells[n]}},obj.destroyMerged=function(n){if(obj.options.mergeCells){obj.options.mergeCells;for(var a=Object.keys(obj.options.mergeCells),c=0;c<a.length;c++)obj.removeMerge(a[c],null,n)}},obj.isColMerged=function(n,a){var c=[];if(obj.options.mergeCells)for(var f=Object.keys(obj.options.mergeCells),k=0;k<f.length;k++){var R=jexcel.getIdFromColumnName(f[k],!0),q=obj.options.mergeCells[f[k]][0],d=R[0],o=R[0]+(q>1?q-1:0);a==null?d<=n&&o>=n&&c.push(f[k]):a?d<n&&o>=n&&c.push(f[k]):d<=n&&o>n&&c.push(f[k])}return c},obj.isRowMerged=function(n,a){var c=[];if(obj.options.mergeCells)for(var f=Object.keys(obj.options.mergeCells),k=0;k<f.length;k++){var R=jexcel.getIdFromColumnName(f[k],!0),q=obj.options.mergeCells[f[k]][1],d=R[1],o=R[1]+(q>1?q-1:0);a==null?d<=n&&o>=n&&c.push(f[k]):a?d<n&&o>=n&&c.push(f[k]):d<=n&&o>n&&c.push(f[k])}return c},obj.openFilter=function(n){if(obj.options.filters){n=parseInt(n),obj.resetSelection();var a=[];if(obj.options.columns[n].type=="checkbox")a.push({id:"true",name:"True"}),a.push({id:"false",name:"False"});else{for(var c=[],f=!1,k=0;k<obj.options.data.length;k++){var R=obj.options.data[k][n],q=obj.records[k][n].innerHTML;R&&q?c[R]=q:f=!0}var d=Object.keys(c);for(a=[],k=0;k<d.length;k++)a.push({id:d[k],name:c[d[k]]});f&&a.push({value:"",id:"",name:"(Blanks)"})}var o=document.createElement("div");obj.filter.children[n+1].innerHTML="",obj.filter.children[n+1].appendChild(o),obj.filter.children[n+1].style.paddingLeft="0px",obj.filter.children[n+1].style.paddingRight="0px",obj.filter.children[n+1].style.overflow="initial";var h={data:a,multiple:!0,autocomplete:!0,opened:!0,value:obj.filters[n]!==void 0?obj.filters[n]:null,width:"100%",position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(_){obj.resetFilters(),obj.filters[n]=_.dropdown.getValue(!0),obj.filter.children[n+1].innerHTML=_.dropdown.getText(),obj.filter.children[n+1].style.paddingLeft="",obj.filter.children[n+1].style.paddingRight="",obj.filter.children[n+1].style.overflow="",obj.closeFilter(n),obj.refreshSelection()}};jSuites.dropdown(o,h)}else console.log("Jspreadsheet: filters not enabled.")},obj.resetFilters=function(){if(obj.options.filters)for(var n=0;n<obj.filter.children.length;n++)obj.filter.children[n].innerHTML="&nbsp;",obj.filters[n]=null;obj.results=null,obj.updateResult()},obj.closeFilter=function(n){if(!n)for(var a=0;a<obj.filter.children.length;a++)obj.filters[a]&&(n=a);var c=function(R,q,d){for(var o=0;o<R.length;o++){var h=""+obj.options.data[d][q],_=""+obj.records[d][q].innerHTML;if(R[o]==h||R[o]==_)return!0}return!1},f=obj.filters[n];obj.results=[];for(var k=0;k<obj.options.data.length;k++)c(f,n,k)&&obj.results.push(k);obj.results.length||(obj.results=null),obj.updateResult()},obj.openEditor=function(n,a,c){var f=n.getAttribute("data-y"),k=n.getAttribute("data-x");obj.dispatch("oneditionstart",el,n,k,f),k>0&&(obj.records[f][k-1].style.overflow="hidden");var R=function(S){var L=n.getBoundingClientRect(),H=document.createElement(S);return H.style.width=L.width+"px",H.style.height=L.height-2+"px",H.style.minHeight=L.height-2+"px",n.classList.add("editor"),n.innerHTML="",n.appendChild(H),obj.dispatch("oncreateeditor",el,n,k,f,H),H};if(n.classList.contains("readonly")!=1){if(obj.edition=[obj.records[f][k],obj.records[f][k].innerHTML,k,f],obj.options.columns[k].editor)obj.options.columns[k].editor.openEditor(n,el,a,c);else if(obj.options.columns[k].type!="hidden")if(obj.options.columns[k].type=="checkbox"||obj.options.columns[k].type=="radio"){var q=!n.children[0].checked;obj.setValue(n,q),obj.edition=null}else if(obj.options.columns[k].type=="dropdown"||obj.options.columns[k].type=="autocomplete"){if(q=obj.options.data[f][k],obj.options.columns[k].multiple&&!Array.isArray(q)&&(q=q.split(";")),typeof obj.options.columns[k].filter=="function")var d=obj.options.columns[k].filter(el,n,k,f,obj.options.columns[k].source);else d=obj.options.columns[k].source;for(var o=[],h=0;h<d.length;h++)o.push(d[h]);var _=R("div"),V={data:o,multiple:!!obj.options.columns[k].multiple,autocomplete:!(!obj.options.columns[k].autocomplete&&obj.options.columns[k].type!="autocomplete"),opened:!0,value:q,width:"100%",height:_.style.minHeight,position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(){obj.closeEditor(n,!0)}};obj.options.columns[k].options&&obj.options.columns[k].options.type&&(V.type=obj.options.columns[k].options.type),jSuites.dropdown(_,V)}else if(obj.options.columns[k].type=="calendar"||obj.options.columns[k].type=="color")q=obj.options.data[f][k],(_=R("input")).value=q,obj.options.tableOverflow!=1&&obj.options.fullscreen!=1||(obj.options.columns[k].options.position=!0),obj.options.columns[k].options.value=obj.options.data[f][k],obj.options.columns[k].options.opened=!0,obj.options.columns[k].options.onclose=function(S,L){obj.closeEditor(n,!0)},obj.options.columns[k].type=="color"?jSuites.color(_,obj.options.columns[k].options):jSuites.calendar(_,obj.options.columns[k].options),_.focus();else if(obj.options.columns[k].type=="html"){q=obj.options.data[f][k],(_=R("div")).style.position="relative",(g=document.createElement("div")).classList.add("jexcel_richtext"),_.appendChild(g),jSuites.editor(g,{focus:!0,value:q});var b=n.getBoundingClientRect(),u=g.getBoundingClientRect();window.innerHeight<b.bottom+u.height?g.style.top=b.top-(u.height+2)+"px":g.style.top=b.top+"px"}else if(obj.options.columns[k].type=="image"){var g,v=n.children[0];(_=R("div")).style.position="relative",(g=document.createElement("div")).classList.add("jclose"),v&&v.src&&g.appendChild(v),_.appendChild(g),jSuites.image(g,obj.options.imageOptions),b=n.getBoundingClientRect(),u=g.getBoundingClientRect(),window.innerHeight<b.bottom+u.height?g.style.top=b.top-(u.height+2)+"px":g.style.top=b.top+"px"}else{q=a==1?"":obj.options.data[f][k],obj.options.columns[k].wordWrap==0||obj.options.wordWrap!=1&&obj.options.columns[k].wordWrap!=1?_=R("input"):_=R("textarea"),_.focus(),_.value=q,V=obj.options.columns[k];var m=null;if(!isFormula(q)&&(m=getMask(V))){if(!V.disabledMaskOnEdition)if(V.mask){var C=V.mask.split(";");_.setAttribute("data-mask",C[0])}else V.locale&&_.setAttribute("data-locale",V.locale);m.input=_,_.mask=m,jSuites.mask.render(q,m,!1)}_.onblur=function(){obj.closeEditor(n,!0)},_.scrollLeft=_.scrollWidth}}},obj.closeEditor=function(n,a){var c=parseInt(n.getAttribute("data-x")),f=parseInt(n.getAttribute("data-y"));if(a==1){if(obj.options.columns[c].editor)var k=obj.options.columns[c].editor.closeEditor(n,a);else if(!(obj.options.columns[c].type=="checkbox"||obj.options.columns[c].type=="radio"||obj.options.columns[c].type=="hidden"))if(obj.options.columns[c].type=="dropdown"||obj.options.columns[c].type=="autocomplete")k=n.children[0].dropdown.close(!0);else if(obj.options.columns[c].type=="calendar")k=n.children[0].calendar.close(!0);else if(obj.options.columns[c].type=="color")k=n.children[0].color.close(!0);else if(obj.options.columns[c].type=="html")k=n.children[0].children[0].editor.getData();else if(obj.options.columns[c].type=="image"){var R=n.children[0].children[0].children[0];k=R&&R.tagName=="IMG"?R.src:""}else if(obj.options.columns[c].type=="numeric")(""+(k=n.children[0].value)).substr(0,1)!="="&&k==""&&(k=obj.options.columns[c].allowEmpty?"":0),n.children[0].onblur=null;else{k=n.children[0].value,n.children[0].onblur=null;var q,d=obj.options.columns[c];if((q=getMask(d))&&k!==""&&!isFormula(k)&&typeof k!="number"){var o=jSuites.mask.extract(k,q,!0);o&&o.value!==""&&(k=o.value)}}obj.options.data[f][c]==k?n.innerHTML=obj.edition[1]:obj.setValue(n,k)}else obj.options.columns[c].editor?obj.options.columns[c].editor.closeEditor(n,a):obj.options.columns[c].type=="dropdown"||obj.options.columns[c].type=="autocomplete"?n.children[0].dropdown.close(!0):obj.options.columns[c].type=="calendar"?n.children[0].calendar.close(!0):obj.options.columns[c].type=="color"?n.children[0].color.close(!0):n.children[0].onblur=null,n.innerHTML=obj.edition&&obj.edition[1]?obj.edition[1]:"";obj.dispatch("oneditionend",el,n,c,f,k,a),n.classList.remove("editor"),obj.edition=null},obj.getCell=function(n){var a=(n=jexcel.getIdFromColumnName(n,!0))[0],c=n[1];return obj.records[c][a]},obj.getColumnOptions=function(n,a){var c=obj.options.columns[n];return c||(c={type:"text"}),c},obj.getCellFromCoords=function(n,a){return obj.records[a][n]},obj.getLabel=function(n){var a=(n=jexcel.getIdFromColumnName(n,!0))[0],c=n[1];return obj.records[c][a].innerHTML},obj.getLabelFromCoords=function(n,a){return obj.records[a][n].innerHTML},obj.getValue=function(n,a){if(typeof n=="object")var c=n.getAttribute("data-x"),f=n.getAttribute("data-y");else c=(n=jexcel.getIdFromColumnName(n,!0))[0],f=n[1];var k=null;return c!=null&&f!=null&&(obj.records[f]&&obj.records[f][c]&&(a||obj.options.copyCompatibility==1)?k=obj.records[f][c].innerHTML:obj.options.data[f]&&obj.options.data[f][c]!="undefined"&&(k=obj.options.data[f][c])),k},obj.getValueFromCoords=function(n,a,c){var f=null;return n!=null&&a!=null&&(obj.records[a]&&obj.records[a][n]&&c||obj.options.copyCompatibility==1?f=obj.records[a][n].innerHTML:obj.options.data[a]&&obj.options.data[a][n]!="undefined"&&(f=obj.options.data[a][n])),f},obj.setValue=function(n,a,c){var f=[];if(typeof n=="string"){var k=(o=jexcel.getIdFromColumnName(n,!0))[0],R=o[1];f.push(obj.updateCell(k,R,a,c)),obj.updateFormulaChain(k,R,f)}else if(k=null,R=null,n&&n.getAttribute&&(k=n.getAttribute("data-x"),R=n.getAttribute("data-y")),k!=null&&R!=null)f.push(obj.updateCell(k,R,a,c)),obj.updateFormulaChain(k,R,f);else{var q=Object.keys(n);if(q.length>0)for(var d=0;d<q.length;d++){var o;typeof n[d]=="string"?(k=(o=jexcel.getIdFromColumnName(n[d],!0))[0],R=o[1]):n[d].x!=null&&n[d].y!=null?(k=n[d].x,R=n[d].y,n[d].newValue!=null?a=n[d].newValue:n[d].value!=null&&(a=n[d].value)):(k=n[d].getAttribute("data-x"),R=n[d].getAttribute("data-y")),k!=null&&R!=null&&(f.push(obj.updateCell(k,R,a,c)),obj.updateFormulaChain(k,R,f))}}obj.setHistory({action:"setValue",records:f,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,f)},obj.setValueFromCoords=function(n,a,c,f){var k=[];k.push(obj.updateCell(n,a,c,f)),obj.updateFormulaChain(n,a,k),obj.setHistory({action:"setValue",records:k,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,k)},obj.setCheckRadioValue=function(){for(var n=[],a=Object.keys(obj.highlighted),c=0;c<a.length;c++){var f=obj.highlighted[c].getAttribute("data-x"),k=obj.highlighted[c].getAttribute("data-y");obj.options.columns[f].type!="checkbox"&&obj.options.columns[f].type!="radio"||n.push(obj.updateCell(f,k,!obj.options.data[k][f]))}n.length&&(obj.setHistory({action:"setValue",records:n,selection:obj.selectedCell}),obj.onafterchanges(el,n))};var stripScript=function(n){var a=new Option;a.innerHTML=n;var c=null;for(n=a.getElementsByTagName("script");c=n[0];)c.parentNode.removeChild(c);return a.innerHTML};obj.updateCell=function(n,a,c,f){if(obj.records[a][n].classList.contains("readonly")!=1||f){var k;(""+c).substr(0,1)=="="&&obj.options.secureFormulas==1&&(k=secureFormula(c))!=c&&(c=k),(k=obj.dispatch("onbeforechange",el,obj.records[a][n],n,a,c))!=null&&(c=k),obj.options.columns[n].editor&&typeof obj.options.columns[n].editor.updateCell=="function"&&(c=obj.options.columns[n].editor.updateCell(obj.records[a][n],c,f)),_={x:n,y:a,col:n,row:a,newValue:c,oldValue:obj.options.data[a][n]};let V=obj.options.columns[n].editor;if(V)obj.options.data[a][n]=c,typeof V.setValue=="function"&&V.setValue(obj.records[a][n],c);else if(obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio"){if(obj.options.columns[n].type=="radio")for(var R=0;R<obj.options.data.length;R++)obj.options.data[R][n]=!1;obj.records[a][n].children[0].checked=c==1||c==1||c=="true"||c=="TRUE",obj.options.data[a][n]=obj.records[a][n].children[0].checked}else if(obj.options.columns[n].type=="dropdown"||obj.options.columns[n].type=="autocomplete")obj.options.data[a][n]=c,obj.records[a][n].textContent=obj.getDropDownValue(n,c);else if(obj.options.columns[n].type=="calendar"){var q=null;if(!validDate(c)){var d=jSuites.calendar.extractDateFromString(c,obj.options.columns[n].options.format);d&&(q=d)}obj.options.data[a][n]=c,obj.records[a][n].textContent=jSuites.calendar.getDateString(q||c,obj.options.columns[n].options.format)}else if(obj.options.columns[n].type=="color")if(obj.options.data[a][n]=c,obj.options.columns[n].render=="square"){var o=document.createElement("div");o.className="color",o.style.backgroundColor=c,obj.records[a][n].textContent="",obj.records[a][n].appendChild(o)}else obj.records[a][n].style.color=c,obj.records[a][n].textContent=c;else if(obj.options.columns[n].type=="image"){if(c=""+c,obj.options.data[a][n]=c,obj.records[a][n].innerHTML="",c&&c.substr(0,10)=="data:image"){var h=document.createElement("img");h.src=c,obj.records[a][n].appendChild(h)}}else obj.options.data[a][n]=c,obj.options.columns[n].type=="html"?obj.records[a][n].innerHTML=stripScript(obj.parseValue(n,a,c)):obj.options.stripHTML===!1||obj.options.columns[n].stripHTML===!1?obj.records[a][n].innerHTML=stripScript(obj.parseValue(n,a,c,obj.records[a][n])):obj.records[a][n].textContent=obj.parseValue(n,a,c,obj.records[a][n]),obj.options.columns[n].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[n].wordWrap==1||obj.records[a][n].innerHTML.length>200)?obj.records[a][n].style.whiteSpace="pre-wrap":obj.records[a][n].style.whiteSpace="";n>0&&(obj.records[a][n-1].style.overflow=c?"hidden":""),obj.dispatch("onchange",el,obj.records[a]&&obj.records[a][n]?obj.records[a][n]:null,n,a,c,_.oldValue)}else var _={x:n,y:a,col:n,row:a};return _},obj.copyData=function(n,a){var c=obj.getData(!0,!0),f=obj.selectedContainer,k=parseInt(n.getAttribute("data-x")),R=parseInt(n.getAttribute("data-y")),q=parseInt(a.getAttribute("data-x")),d=parseInt(a.getAttribute("data-y")),o=[],h=!1;if(f[0]==k){if(R<f[1])var _=R-f[1];else _=1;var V=0}else V=k<f[0]?k-f[0]:1,_=0;for(var b=0,u=0,g=R;g<=d;g++)if(!obj.rows[g]||obj.rows[g].style.display!="none"){c[u]==null&&(u=0),b=0,f[0]!=k&&(V=k<f[0]?k-f[0]:1);for(var v=k;v<=q;v++){if(obj.records[g][v]&&!obj.records[g][v].classList.contains("readonly")&&obj.records[g][v].style.display!="none"&&h==0){if(!obj.selection.length&&obj.options.data[g][v]!=""){h=!0;continue}(c[u]==null||c[u][b]==null)&&(b=0);var m=c[u][b];if(m&&!c[1]&&obj.options.autoIncrement==1){if(obj.options.columns[v].type=="text"||obj.options.columns[v].type=="number")if((""+m).substr(0,1)=="="){var C=m.match(/([A-Z]+[0-9]+)/g);if(C){for(var S=[],L=0;L<C.length;L++){var H=jexcel.getIdFromColumnName(C[L],1);H[0]+=V,H[1]+=_,H[1]<0&&(H[1]=0);var N=jexcel.getColumnNameFromId([H[0],H[1]]);N!=C[L]&&(S[C[L]]=N)}S&&(m=obj.updateFormula(m,S))}}else m==Number(m)&&(m=Number(m)+_);else if(obj.options.columns[v].type=="calendar"){var M=new Date(m);M.setDate(M.getDate()+_),m=M.getFullYear()+"-"+jexcel.doubleDigitFormat(parseInt(M.getMonth()+1))+"-"+jexcel.doubleDigitFormat(M.getDate())+" 00:00:00"}}o.push(obj.updateCell(v,g,m)),obj.updateFormulaChain(v,g,o)}b++,f[0]!=k&&V++}u++,_++}obj.setHistory({action:"setValue",records:o,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,o)},obj.refreshSelection=function(){obj.selectedCell&&obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.conditionalSelectionUpdate=function(n,a,c){if(n==1){if(obj.selectedCell&&(a>=obj.selectedCell[1]&&a<=obj.selectedCell[3]||c>=obj.selectedCell[1]&&c<=obj.selectedCell[3]))return void obj.resetSelection()}else if(obj.selectedCell&&(a>=obj.selectedCell[0]&&a<=obj.selectedCell[2]||c>=obj.selectedCell[0]&&c<=obj.selectedCell[2]))return void obj.resetSelection()},obj.resetSelection=function(n){if(obj.highlighted.length){h=1;for(var a=0;a<obj.highlighted.length;a++){obj.highlighted[a].classList.remove("highlight"),obj.highlighted[a].classList.remove("highlight-left"),obj.highlighted[a].classList.remove("highlight-right"),obj.highlighted[a].classList.remove("highlight-top"),obj.highlighted[a].classList.remove("highlight-bottom"),obj.highlighted[a].classList.remove("highlight-selected");var c=parseInt(obj.highlighted[a].getAttribute("data-x")),f=parseInt(obj.highlighted[a].getAttribute("data-y"));if(obj.highlighted[a].getAttribute("data-merged"))var k=parseInt(obj.highlighted[a].getAttribute("colspan")),R=parseInt(obj.highlighted[a].getAttribute("rowspan")),q=k>0?c+(k-1):c,d=R>0?f+(R-1):f;else q=c,d=f;for(var o=c;o<=q;o++)obj.headers[o]&&obj.headers[o].classList.remove("selected");for(o=f;o<=d;o++)obj.rows[o]&&obj.rows[o].classList.remove("selected")}}else var h=0;return obj.highlighted=[],obj.selectedCell=null,obj.corner.style.top="-2000px",obj.corner.style.left="-2000px",n==1&&h==1&&obj.dispatch("onblur",el),h},obj.updateSelection=function(n,a,c){var f=n.getAttribute("data-x"),k=n.getAttribute("data-y");if(a)var R=a.getAttribute("data-x"),q=a.getAttribute("data-y");else R=f,q=k;obj.updateSelectionFromCoords(f,k,R,q,c)},obj.updateSelectionFromCoords=function(n,a,c,f,k){var R=obj.resetSelection();if(a==null&&(a=0,f=obj.rows.length-1),c==null&&(c=n),f==null&&(f=a),n>=obj.headers.length&&(n=obj.headers.length-1),a>=obj.rows.length&&(a=obj.rows.length-1),c>=obj.headers.length&&(c=obj.headers.length-1),f>=obj.rows.length&&(f=obj.rows.length-1),obj.selectedCell=[n,a,c,f],n!=null){if(obj.records[a][n]&&obj.records[a][n].classList.add("highlight-selected"),parseInt(n)<parseInt(c))var q=parseInt(n),d=parseInt(c);else q=parseInt(c),d=parseInt(n);if(parseInt(a)<parseInt(f))var o=parseInt(a),h=parseInt(f);else o=parseInt(f),h=parseInt(a);for(var _=q;_<=d;_++)for(var V=o;V<=h;V++)if(obj.records[V][_]&&obj.records[V][_].getAttribute("data-merged")){var b=parseInt(obj.records[V][_].getAttribute("data-x")),u=parseInt(obj.records[V][_].getAttribute("data-y")),g=parseInt(obj.records[V][_].getAttribute("colspan")),v=parseInt(obj.records[V][_].getAttribute("rowspan"));g>1&&(b<q&&(q=b),b+g>d&&(d=b+g-1)),v&&(u<o&&(o=u),u+v>h&&(h=u+v-1))}var m=null,C=null,S=null,L=null;for(V=o;V<=h;V++)obj.rows[V].style.display!="none"&&(S==null&&(S=V),L=V);for(_=q;_<=d;_++){for(V=o;V<=h;V++)obj.rows[V].style.display!="none"&&obj.records[V][_].style.display!="none"&&(obj.records[V][_].classList.add("highlight"),obj.highlighted.push(obj.records[V][_]));obj.options.columns[_].type!="hidden"&&(m==null&&(m=_),C=_)}for(m||(m=0),C||(C=0),_=m;_<=C;_++)obj.options.columns[_].type!="hidden"&&(obj.records[S]&&obj.records[S][_]&&obj.records[S][_].classList.add("highlight-top"),obj.records[L]&&obj.records[L][_]&&obj.records[L][_].classList.add("highlight-bottom"),obj.headers[_].classList.add("selected"));for(V=S;V<=L;V++)obj.rows[V]&&obj.rows[V].style.display!="none"&&(obj.records[V][m].classList.add("highlight-left"),obj.records[V][C].classList.add("highlight-right"),obj.rows[V].classList.add("selected"));obj.selectedContainer=[m,S,C,L]}R==0&&(obj.dispatch("onfocus",el),obj.removeCopyingSelection()),obj.dispatch("onselection",el,m,S,C,L,k),obj.updateCornerPosition()},obj.removeCopySelection=function(){for(var n=0;n<obj.selection.length;n++)obj.selection[n].classList.remove("selection"),obj.selection[n].classList.remove("selection-left"),obj.selection[n].classList.remove("selection-right"),obj.selection[n].classList.remove("selection-top"),obj.selection[n].classList.remove("selection-bottom");obj.selection=[]},obj.updateCopySelection=function(n,a){obj.removeCopySelection();var c=obj.selectedContainer[0],f=obj.selectedContainer[1],k=obj.selectedContainer[2],R=obj.selectedContainer[3];if(n!=null&&a!=null){if(n-k>0)var q=parseInt(k)+1,d=parseInt(n);else q=parseInt(n),d=parseInt(c)-1;if(a-R>0)var o=parseInt(R)+1,h=parseInt(a);else o=parseInt(a),h=parseInt(f)-1;d-q<=h-o?(q=parseInt(c),d=parseInt(k)):(o=parseInt(f),h=parseInt(R));for(var _=o;_<=h;_++)for(var V=q;V<=d;V++)obj.records[_][V]&&obj.rows[_].style.display!="none"&&obj.records[_][V].style.display!="none"&&(obj.records[_][V].classList.add("selection"),obj.records[o][V].classList.add("selection-top"),obj.records[h][V].classList.add("selection-bottom"),obj.records[_][q].classList.add("selection-left"),obj.records[_][d].classList.add("selection-right"),obj.selection.push(obj.records[_][V]))}},obj.updateCornerPosition=function(){if(obj.highlighted.length){var n=obj.highlighted[obj.highlighted.length-1],a=n.getAttribute("data-x"),c=obj.content.getBoundingClientRect(),f=c.left,k=c.top,R=n.getBoundingClientRect(),q=R.left,d=R.top,o=R.width,h=R.height,_=q-f+obj.content.scrollLeft+o-4,V=d-k+obj.content.scrollTop+h-4;if(obj.corner.style.top=V+"px",obj.corner.style.left=_+"px",obj.options.freezeColumns){var b=obj.getFreezeWidth();a>obj.options.freezeColumns-1&&q-f+o<b?obj.corner.style.display="none":obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.corner.style.top="-2000px",obj.corner.style.left="-2000px"},obj.updateScroll=function(n){var a=obj.content.getBoundingClientRect(),c=a.left,f=a.top,k=a.width,R=a.height,q=obj.records[obj.selectedCell[3]][obj.selectedCell[2]].getBoundingClientRect(),d=q.left,o=q.top,h=q.width,_=q.height;if(n==0||n==1)var V=d-c+obj.content.scrollLeft,b=o-f+obj.content.scrollTop-2;else V=d-c+obj.content.scrollLeft+h,b=o-f+obj.content.scrollTop+_;b>obj.content.scrollTop+30&&b<obj.content.scrollTop+R||(b<obj.content.scrollTop+30?obj.content.scrollTop=b-_:obj.content.scrollTop=b-(R-2));var u=obj.getFreezeWidth();V>obj.content.scrollLeft+u&&V<obj.content.scrollLeft+k||(V<obj.content.scrollLeft+30?(obj.content.scrollLeft=V,obj.content.scrollLeft<50&&(obj.content.scrollLeft=0)):V<obj.content.scrollLeft+u?obj.content.scrollLeft=V-u-1:obj.content.scrollLeft=V-(k-20))},obj.getWidth=function(n){if(n===void 0)for(var a=[],c=0;c<obj.headers.length;c++)a.push(obj.options.columns[c].width);else typeof n=="object"&&(n=n.getAttribute("data-x")),a=obj.colgroup[n].getAttribute("width");return a},obj.setWidth=function(n,a,c){if(a){if(Array.isArray(n)){c||(c=[]);for(var f=0;f<n.length;f++){c[f]||(c[f]=obj.colgroup[n[f]].getAttribute("width"));var k=Array.isArray(a)&&a[f]?a[f]:a;obj.colgroup[n[f]].setAttribute("width",k),obj.options.columns[n[f]].width=k}}else c||(c=obj.colgroup[n].getAttribute("width")),obj.colgroup[n].setAttribute("width",a),obj.options.columns[n].width=a;obj.setHistory({action:"setWidth",column:n,oldValue:c,newValue:a}),obj.dispatch("onresizecolumn",el,n,a,c),obj.updateCornerPosition()}},obj.setHeight=function(n,a,c){a>0&&(typeof n=="object"&&(n=n.getAttribute("data-y")),c||(c=obj.rows[n].getAttribute("height"))||(c=obj.rows[n].getBoundingClientRect().height),a=parseInt(a),obj.rows[n].style.height=a+"px",obj.options.rows[n]||(obj.options.rows[n]={}),obj.options.rows[n].height=a,obj.setHistory({action:"setHeight",row:n,oldValue:c,newValue:a}),obj.dispatch("onresizerow",el,n,a,c),obj.updateCornerPosition())},obj.getHeight=function(n){if(n===void 0)for(var a=[],c=0;c<obj.rows.length;c++){var f=obj.rows[c].style.height;f&&(a[c]=f)}else typeof n=="object"&&(n=$(n).getAttribute("data-y")),a=obj.rows[n].style.height;return a},obj.setFooter=function(n){if(n&&(obj.options.footers=n),obj.options.footers){obj.tfoot||(obj.tfoot=document.createElement("tfoot"),obj.table.appendChild(obj.tfoot));for(var a=0;a<obj.options.footers.length;a++){if(obj.tfoot.children[a])var c=obj.tfoot.children[a];else{c=document.createElement("tr");var f=document.createElement("td");c.appendChild(f),obj.tfoot.appendChild(c)}for(var k=0;k<obj.headers.length;k++){if(obj.options.footers[a][k]||(obj.options.footers[a][k]=""),obj.tfoot.children[a].children[k+1])f=obj.tfoot.children[a].children[k+1];else{f=document.createElement("td"),c.appendChild(f);var R=obj.options.columns[k].align?obj.options.columns[k].align:"center";f.style.textAlign=R}f.textContent=obj.parseValue(+obj.records.length+k,a,obj.options.footers[a][k]),f.style.display=obj.colgroup[k].style.display}}}},obj.getHeader=function(n){return obj.headers[n].textContent},obj.setHeader=function(n,a){if(obj.headers[n]){var c=obj.headers[n].textContent;a||(a=prompt(obj.options.text.columnName,c)),a&&(obj.headers[n].textContent=a,obj.headers[n].setAttribute("title",a),obj.options.columns[n].title=a),obj.setHistory({action:"setHeader",column:n,oldValue:c,newValue:a}),obj.dispatch("onchangeheader",el,n,c,a)}},obj.getHeaders=function(n){for(var a=[],c=0;c<obj.headers.length;c++)a.push(obj.getHeader(c));return n?a:a.join(obj.options.csvDelimiter)},obj.getMeta=function(n,a){return n?a?obj.options.meta[n]&&obj.options.meta[n][a]?obj.options.meta[n][a]:null:obj.options.meta[n]?obj.options.meta[n]:null:obj.options.meta},obj.setMeta=function(n,a,c){if(obj.options.meta||(obj.options.meta={}),a&&c)obj.options.meta[n]||(obj.options.meta[n]={}),obj.options.meta[n][a]=c;else for(var f=Object.keys(n),k=0;k<f.length;k++){obj.options.meta[f[k]]||(obj.options.meta[f[k]]={});for(var R=Object.keys(n[f[k]]),q=0;q<R.length;q++)obj.options.meta[f[k]][R[q]]=n[f[k]][R[q]]}obj.dispatch("onchangemeta",el,n,a,c)},obj.updateMeta=function(n){if(obj.options.meta){for(var a={},c=Object.keys(obj.options.meta),f=0;f<c.length;f++)n[c[f]]?a[n[c[f]]]=obj.options.meta[c[f]]:a[c[f]]=obj.options.meta[c[f]];obj.options.meta=a}},obj.getStyle=function(n,a){if(n)return n=jexcel.getIdFromColumnName(n,!0),a?obj.records[n[1]][n[0]].style[a]:obj.records[n[1]][n[0]].getAttribute("style");for(var c={},f=obj.options.data[0].length,k=obj.options.data.length,R=0;R<k;R++)for(var q=0;q<f;q++){var d=a?obj.records[R][q].style[a]:obj.records[R][q].getAttribute("style");d&&(c[jexcel.getColumnNameFromId([q,R])]=d)}return c},obj.resetStyle=function(n,a){for(var c=Object.keys(n),f=0;f<c.length;f++){var k=jexcel.getIdFromColumnName(c[f],!0);obj.records[k[1]]&&obj.records[k[1]][k[0]]&&obj.records[k[1]][k[0]].setAttribute("style","")}obj.setStyle(n,null,null,null,a)},obj.setStyle=function(n,a,c,f,k){var R={},q={},d=function(m,C,S){var L=jexcel.getIdFromColumnName(m,!0);if(obj.records[L[1]]&&obj.records[L[1]][L[0]]&&(obj.records[L[1]][L[0]].classList.contains("readonly")==0||f)){var H=obj.records[L[1]][L[0]].style[C];H!=S||f?obj.records[L[1]][L[0]].style[C]=S:(S="",obj.records[L[1]][L[0]].style[C]=""),q[m]||(q[m]=[]),R[m]||(R[m]=[]),q[m].push([C+":"+H]),R[m].push([C+":"+S])}};if(a&&c)if(typeof n=="string")d(n,a,c);else for(var o=[],h=0;h<n.length;h++){var _=n[h].getAttribute("data-x"),V=n[h].getAttribute("data-y"),b=jexcel.getColumnNameFromId([_,V]);o[b]||(d(b,a,c),o[b]=!0)}else{var u=Object.keys(n);for(h=0;h<u.length;h++){var g=n[u[h]];typeof g=="string"&&(g=g.split(";"));for(var v=0;v<g.length;v++)typeof g[v]=="string"&&(g[v]=g[v].split(":")),g[v][0].trim()&&d(u[h],g[v][0].trim(),g[v][1])}}for(u=Object.keys(q),h=0;h<u.length;h++)q[u[h]]=q[u[h]].join(";");for(u=Object.keys(R),h=0;h<u.length;h++)R[u[h]]=R[u[h]].join(";");k||obj.setHistory({action:"setStyle",oldValue:q,newValue:R}),obj.dispatch("onchangestyle",el,n,a,c)},obj.getComments=function(n,a){if(n)return typeof n=="string"&&(n=jexcel.getIdFromColumnName(n,!0)),a?[obj.records[n[1]][n[0]].getAttribute("title"),obj.records[n[1]][n[0]].getAttribute("author")]:obj.records[n[1]][n[0]].getAttribute("title")||"";for(var c={},f=0;f<obj.options.data.length;f++)for(var k=0;k<obj.options.columns.length;k++){var R=obj.records[f][k].getAttribute("title");R&&(c[n=jexcel.getColumnNameFromId([k,f])]=R)}return c},obj.setComments=function(n,a,c){if(typeof n=="string")var f=jexcel.getIdFromColumnName(n,!0);else f=n;var k=obj.records[f[1]][f[0]].getAttribute("title"),R=[k,c=obj.records[f[1]][f[0]].getAttribute("data-author")];obj.records[f[1]][f[0]].setAttribute("title",a||""),obj.records[f[1]][f[0]].setAttribute("data-author",c||""),a?obj.records[f[1]][f[0]].classList.add("jexcel_comments"):obj.records[f[1]][f[0]].classList.remove("jexcel_comments"),obj.setHistory({action:"setComments",column:n,newValue:[a,c],oldValue:R}),obj.dispatch("oncomments",el,a,k,f,f[0],f[1])},obj.getConfig=function(){var n=obj.options;return n.style=obj.getStyle(),n.mergeCells=obj.getMerge(),n.comments=obj.getComments(),n},obj.orderBy=function(n,a){if(n>=0){if(Object.keys(obj.options.mergeCells).length>0){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}a=a==null?obj.headers[n].classList.contains("arrow-down")?1:0:a?1:0;var c=[];if(obj.options.columns[n].type=="number"||obj.options.columns[n].type=="numeric"||obj.options.columns[n].type=="percentage"||obj.options.columns[n].type=="autonumber"||obj.options.columns[n].type=="color")for(var f=0;f<obj.options.data.length;f++)c[f]=[f,Number(obj.options.data[f][n])];else if(obj.options.columns[n].type=="calendar"||obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio")for(f=0;f<obj.options.data.length;f++)c[f]=[f,obj.options.data[f][n]];else for(f=0;f<obj.options.data.length;f++)c[f]=[f,obj.records[f][n].textContent.toLowerCase()];typeof obj.options.sorting!="function"&&(obj.options.sorting=function(R){return function(q,d){var o=q[1],h=d[1];return R?o===""&&h!==""?1:o!==""&&h===""||o>h?-1:o<h?1:0:o===""&&h!==""?1:o!==""&&h===""?-1:o>h?1:o<h?-1:0}}),c=c.sort(obj.options.sorting(a));var k=[];for(f=0;f<c.length;f++)k[f]=c[f][0];return obj.setHistory({action:"orderBy",rows:k,column:n,order:a}),obj.updateOrderArrow(n,a),obj.updateOrder(k),obj.dispatch("onsort",el,n,a),!0}},obj.updateOrderArrow=function(n,a){for(var c=0;c<obj.headers.length;c++)obj.headers[c].classList.remove("arrow-up"),obj.headers[c].classList.remove("arrow-down");a?obj.headers[n].classList.add("arrow-up"):obj.headers[n].classList.add("arrow-down")},obj.updateOrder=function(n){for(var a=[],c=0;c<n.length;c++)a[c]=obj.options.data[n[c]];for(obj.options.data=a,a=[],c=0;c<n.length;c++)a[c]=obj.records[n[c]];for(obj.records=a,a=[],c=0;c<n.length;c++)a[c]=obj.rows[n[c]];if(obj.rows=a,obj.updateTableReferences(),obj.results&&obj.results.length)obj.searchInput.value?obj.search(obj.searchInput.value):obj.closeFilter();else if(obj.results=null,obj.pageNumber=0,obj.options.pagination>0)obj.page(0);else if(obj.options.lazyLoading==1)obj.loadPage(0);else for(c=0;c<obj.rows.length;c++)obj.tbody.appendChild(obj.rows[c])},obj.moveRow=function(n,a,c){if(Object.keys(obj.options.mergeCells).length>0){if(n>a)var f=1;else f=0;if(obj.isRowMerged(n).length||obj.isRowMerged(a,f).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}c||(Array.prototype.indexOf.call(obj.tbody.children,obj.rows[a])>=0?n>a?obj.tbody.insertBefore(obj.rows[n],obj.rows[a]):obj.tbody.insertBefore(obj.rows[n],obj.rows[a].nextSibling):obj.tbody.removeChild(obj.rows[n])),obj.rows.splice(a,0,obj.rows.splice(n,1)[0]),obj.records.splice(a,0,obj.records.splice(n,1)[0]),obj.options.data.splice(a,0,obj.options.data.splice(n,1)[0]),obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"moveRow",oldValue:n,newValue:a}),obj.updateTableReferences(),obj.dispatch("onmoverow",el,n,a)},obj.insertRow=function(n,a,c){if(obj.options.allowInsertRow==1){var f=[];if(n>0)var k=n;else k=1,n&&(f=n);c=!!c;var R=obj.options.data.length-1;if((a==null||a>=parseInt(R)||a<0)&&(a=R),obj.dispatch("onbeforeinsertrow",el,a,k,c)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isRowMerged(a,c).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(var q=c?a:a+1,d=obj.records.splice(q),o=obj.options.data.splice(q),h=obj.rows.splice(q),_=[],V=[],b=[],u=q;u<k+q;u++){obj.options.data[u]=[];for(var g=0;g<obj.options.columns.length;g++)obj.options.data[u][g]=f[g]?f[g]:"";var v=obj.createRow(u,obj.options.data[u]);h[0]?Array.prototype.indexOf.call(obj.tbody.children,h[0])>=0&&obj.tbody.insertBefore(v,h[0]):Array.prototype.indexOf.call(obj.tbody.children,obj.rows[a])>=0&&obj.tbody.appendChild(v),_.push(obj.records[u]),V.push(obj.options.data[u]),b.push(v)}Array.prototype.push.apply(obj.records,d),Array.prototype.push.apply(obj.options.data,o),Array.prototype.push.apply(obj.rows,h),obj.options.pagination>0&&obj.page(obj.pageNumber),obj.setHistory({action:"insertRow",rowNumber:a,numOfRows:k,insertBefore:c,rowRecords:_,rowData:V,rowNode:b}),obj.updateTableReferences(),obj.dispatch("oninsertrow",el,a,k,_,c)}},obj.deleteRow=function(n,a){if(obj.options.allowDeleteRow==1)if(obj.options.allowDeletingAllRows==1||obj.options.data.length>1){if(n==null){var c=obj.getSelectedRows();c[0]?(n=parseInt(c[0].getAttribute("data-y")),a=c.length):(n=obj.options.data.length-1,a=1)}var f=obj.options.data.length-1;if((n==null||n>f||n<0)&&(n=f),a||(a=1),n+a>=obj.options.data.length&&(a=obj.options.data.length-n),obj.dispatch("onbeforedeleterow",el,n,a)===!1)return!1;if(parseInt(n)>-1){var k=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var R=n;R<n+a;R++)obj.isRowMerged(R,!1).length&&(k=!0);if(k){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(obj.options.allowDeletingAllRows==0&&f+1===a&&(a--,console.error("Jspreadsheet: It is not possible to delete the last row")),R=n;R<n+a;R++)Array.prototype.indexOf.call(obj.tbody.children,obj.rows[R])>=0&&(obj.rows[R].className="",obj.rows[R].parentNode.removeChild(obj.rows[R]));var q=obj.records.splice(n,a),d=obj.options.data.splice(n,a),o=obj.rows.splice(n,a);obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.conditionalSelectionUpdate(1,n,n+a-1),obj.setHistory({action:"deleteRow",rowNumber:n,numOfRows:a,insertBefore:1,rowRecords:q,rowData:d,rowNode:o}),obj.updateTableReferences(),obj.dispatch("ondeleterow",el,n,a,q)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},obj.moveColumn=function(n,a){if(Object.keys(obj.options.mergeCells).length>0){if(n>a)var c=1;else c=0;if(obj.isColMerged(n).length||obj.isColMerged(a,c).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if((n=parseInt(n))>(a=parseInt(a))){obj.headerContainer.insertBefore(obj.headers[n],obj.headers[a]),obj.colgroupContainer.insertBefore(obj.colgroup[n],obj.colgroup[a]);for(var f=0;f<obj.rows.length;f++)obj.rows[f].insertBefore(obj.records[f][n],obj.records[f][a])}else for(obj.headerContainer.insertBefore(obj.headers[n],obj.headers[a].nextSibling),obj.colgroupContainer.insertBefore(obj.colgroup[n],obj.colgroup[a].nextSibling),f=0;f<obj.rows.length;f++)obj.rows[f].insertBefore(obj.records[f][n],obj.records[f][a].nextSibling);for(obj.options.columns.splice(a,0,obj.options.columns.splice(n,1)[0]),obj.headers.splice(a,0,obj.headers.splice(n,1)[0]),obj.colgroup.splice(a,0,obj.colgroup.splice(n,1)[0]),f=0;f<obj.rows.length;f++)obj.options.data[f].splice(a,0,obj.options.data[f].splice(n,1)[0]),obj.records[f].splice(a,0,obj.records[f].splice(n,1)[0]);if(obj.options.footers)for(f=0;f<obj.options.footers.length;f++)obj.options.footers[f].splice(a,0,obj.options.footers[f].splice(n,1)[0]);obj.setHistory({action:"moveColumn",oldValue:n,newValue:a}),obj.updateTableReferences(),obj.dispatch("onmovecolumn",el,n,a)},obj.insertColumn=function(n,a,c,f){if(obj.options.allowInsertColumn==1){var k=[];if(n>0)var R=n;else R=1,n&&(k=n);c=!!c;var q=obj.options.columns.length-1;if((a==null||a>=parseInt(q)||a<0)&&(a=q),obj.dispatch("onbeforeinsertcolumn",el,a,R,c)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isColMerged(a,c).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}f||(f=[]);for(var d=0;d<R;d++)f[d]||(f[d]={type:"text",source:[],options:[],width:obj.options.defaultColWidth,align:obj.options.defaultColAlign});var o=c?a:a+1;obj.options.columns=jexcel.injectArray(obj.options.columns,o,f);for(var h=obj.headers.splice(o),_=obj.colgroup.splice(o),V=[],b=[],u=[],g=[],v=[],m=o;m<R+o;m++)obj.createCellHeader(m),obj.headerContainer.insertBefore(obj.headers[m],obj.headerContainer.children[m+1]),obj.colgroupContainer.insertBefore(obj.colgroup[m],obj.colgroupContainer.children[m+1]),V.push(obj.headers[m]),b.push(obj.colgroup[m]);if(obj.options.footers)for(var C=0;C<obj.options.footers.length;C++){for(v[C]=[],d=0;d<R;d++)v[C].push("");obj.options.footers[C].splice(o,0,v[C])}for(var S=0;S<obj.options.data.length;S++){var L=obj.options.data[S].splice(o),H=obj.records[S].splice(o);for(g[S]=[],u[S]=[],m=o;m<R+o;m++){var N=k[S]?k[S]:"";obj.options.data[S][m]=N;var M=obj.createCell(m,S,obj.options.data[S][m]);obj.records[S][m]=M,obj.rows[S]&&obj.rows[S].insertBefore(M,obj.rows[S].children[m+1]),g[S].push(N),u[S].push(M)}Array.prototype.push.apply(obj.options.data[S],L),Array.prototype.push.apply(obj.records[S],H)}if(Array.prototype.push.apply(obj.headers,h),Array.prototype.push.apply(obj.colgroup,_),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(C=0;C<obj.options.nestedHeaders.length;C++){var T=parseInt(obj.options.nestedHeaders[C][obj.options.nestedHeaders[C].length-1].colspan)+R;obj.options.nestedHeaders[C][obj.options.nestedHeaders[C].length-1].colspan=T,obj.thead.children[C].children[obj.thead.children[C].children.length-1].setAttribute("colspan",T);var G=obj.thead.children[C].children[obj.thead.children[C].children.length-1].getAttribute("data-column");for(G=G.split(","),m=o;m<R+o;m++)G.push(m);obj.thead.children[C].children[obj.thead.children[C].children.length-1].setAttribute("data-column",G)}else T=parseInt(obj.options.nestedHeaders[0].colspan)+R,obj.options.nestedHeaders[0].colspan=T,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",T);obj.setHistory({action:"insertColumn",columnNumber:a,numOfColumns:R,insertBefore:c,columns:f,headers:V,colgroup:b,records:u,footers:v,data:g}),obj.updateTableReferences(),obj.dispatch("oninsertcolumn",el,a,R,u,c)}},obj.deleteColumn=function(n,a){if(obj.options.allowDeleteColumn==1)if(obj.headers.length>1){if(n==null){var c=obj.getSelectedColumns(!0);c.length?(n=parseInt(c[0]),a=parseInt(c.length)):(n=obj.headers.length-1,a=1)}var f=obj.options.data[0].length-1;if((n==null||n>f||n<0)&&(n=f),a||(a=1),a>obj.options.data[0].length-n&&(a=obj.options.data[0].length-n),obj.dispatch("onbeforedeletecolumn",el,n,a)===!1)return!1;if(parseInt(n)>-1){var k=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var R=n;R<n+a;R++)obj.isColMerged(R,!1).length&&(k=!0);if(k){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}var q=obj.options.columns.splice(n,a);for(R=n;R<n+a;R++)obj.colgroup[R].className="",obj.headers[R].className="",obj.colgroup[R].parentNode.removeChild(obj.colgroup[R]),obj.headers[R].parentNode.removeChild(obj.headers[R]);for(var d=obj.headers.splice(n,a),o=obj.colgroup.splice(n,a),h=[],_=[],V=[],b=0;b<obj.options.data.length;b++)for(R=n;R<n+a;R++)obj.records[b][R].className="",obj.records[b][R].parentNode.removeChild(obj.records[b][R]);for(b=0;b<obj.options.data.length;b++)_[b]=obj.options.data[b].splice(n,a),h[b]=obj.records[b].splice(n,a);if(obj.options.footers)for(b=0;b<obj.options.footers.length;b++)V[b]=obj.options.footers[b].splice(n,a);if(obj.conditionalSelectionUpdate(0,n,n+a-1),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var u=0;u<obj.options.nestedHeaders.length;u++){var g=parseInt(obj.options.nestedHeaders[u][obj.options.nestedHeaders[u].length-1].colspan)-a;obj.options.nestedHeaders[u][obj.options.nestedHeaders[u].length-1].colspan=g,obj.thead.children[u].children[obj.thead.children[u].children.length-1].setAttribute("colspan",g)}else g=parseInt(obj.options.nestedHeaders[0].colspan)-a,obj.options.nestedHeaders[0].colspan=g,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",g);obj.setHistory({action:"deleteColumn",columnNumber:n,numOfColumns:a,insertBefore:1,columns:q,headers:d,colgroup:o,records:h,footers:V,data:_}),obj.updateTableReferences(),obj.dispatch("ondeletecolumn",el,n,a,h)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},obj.getSelectedRows=function(n){for(var a=[],c=0;c<obj.rows.length;c++)obj.rows[c].classList.contains("selected")&&(n?a.push(c):a.push(obj.rows[c]));return a},obj.getSelectedColumns=function(){for(var n=[],a=0;a<obj.headers.length;a++)obj.headers[a].classList.contains("selected")&&n.push(a);return n},obj.getHighlighted=function(){return obj.highlighted},obj.updateTableReferences=function(){for(var n=0;n<obj.headers.length;n++)(R=obj.headers[n].getAttribute("data-x"))!=n&&(obj.headers[n].setAttribute("data-x",n),obj.headers[n].getAttribute("title")||(obj.headers[n].innerHTML=jexcel.getColumnName(n)));for(var a=0;a<obj.rows.length;a++)obj.rows[a]&&(q=obj.rows[a].getAttribute("data-y"))!=a&&(obj.rows[a].setAttribute("data-y",a),obj.rows[a].children[0].setAttribute("data-y",a),obj.rows[a].children[0].innerHTML=a+1);var c=[],f=[],k=function(u,g,v,m){if(u!=v&&obj.records[m][v].setAttribute("data-x",v),g!=m&&obj.records[m][v].setAttribute("data-y",m),u!=v||g!=m){var C=jexcel.getColumnNameFromId([u,g]),S=jexcel.getColumnNameFromId([v,m]);c[C]=S}};for(a=0;a<obj.records.length;a++)for(n=0;n<obj.records[0].length;n++)if(obj.records[a][n]){var R=obj.records[a][n].getAttribute("data-x"),q=obj.records[a][n].getAttribute("data-y");if(obj.records[a][n].getAttribute("data-merged")){var d=jexcel.getColumnNameFromId([R,q]),o=jexcel.getColumnNameFromId([n,a]);if(f[d]==null)if(d==o)f[d]=!1;else{var h=parseInt(n-R),_=parseInt(a-q);f[d]=[o,h,_]}}else k(R,q,n,a)}var V=Object.keys(f);if(V.length){for(n=0;n<V.length;n++)if(f[V[n]]){var b=jexcel.getIdFromColumnName(V[n],!0);for(k(R=b[0],q=b[1],R+f[V[n]][1],q+f[V[n]][2]),d=V[n],o=f[V[n]][0],a=0;a<obj.options.mergeCells[d][2].length;a++)R=parseInt(obj.options.mergeCells[d][2][a].getAttribute("data-x")),q=parseInt(obj.options.mergeCells[d][2][a].getAttribute("data-y")),obj.options.mergeCells[d][2][a].setAttribute("data-x",R+f[V[n]][1]),obj.options.mergeCells[d][2][a].setAttribute("data-y",q+f[V[n]][2]);obj.options.mergeCells[o]=obj.options.mergeCells[d],delete obj.options.mergeCells[d]}}obj.updateFormulas(c),obj.updateMeta(c),obj.refreshSelection(),obj.updateTable()},obj.updateTable=function(){if(obj.options.minSpareRows>0){for(var n=0,a=obj.rows.length-1;a>=0;a--){for(var c=!1,f=0;f<obj.headers.length;f++)obj.options.data[a][f]&&(c=!0);if(c)break;n++}obj.options.minSpareRows-n>0&&obj.insertRow(obj.options.minSpareRows-n)}if(obj.options.minSpareCols>0){var k=0;for(f=obj.headers.length-1;f>=0;f--){for(c=!1,a=0;a<obj.rows.length;a++)obj.options.data[a][f]&&(c=!0);if(c)break;k++}obj.options.minSpareCols-k>0&&obj.insertColumn(obj.options.minSpareCols-k)}if(typeof obj.options.updateTable=="function"){for(obj.options.detachForUpdates&&el.removeChild(obj.content),a=0;a<obj.rows.length;a++)for(f=0;f<obj.headers.length;f++)obj.options.updateTable(el,obj.records[a][f],f,a,obj.options.data[a][f],obj.records[a][f].textContent,jexcel.getColumnNameFromId([f,a]));obj.options.detachForUpdates&&el.insertBefore(obj.content,obj.pagination)}obj.options.footers&&obj.setFooter(),setTimeout(function(){obj.updateCornerPosition()},0)},obj.isReadOnly=function(n){if(n=obj.getCell(n))return!!n.classList.contains("readonly")},obj.setReadOnly=function(n,a){(n=obj.getCell(n))&&(a?n.classList.add("readonly"):n.classList.remove("readonly"))},obj.showRow=function(n){obj.rows[n].style.display=""},obj.hideRow=function(n){obj.rows[n].style.display="none"},obj.showColumn=function(n){obj.headers[n].style.display="",obj.colgroup[n].style.display="",obj.filter&&obj.filter.children.length>n+1&&(obj.filter.children[n+1].style.display="");for(var a=0;a<obj.options.data.length;a++)obj.records[a][n].style.display="";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.hideColumn=function(n){obj.headers[n].style.display="none",obj.colgroup[n].style.display="none",obj.filter&&obj.filter.children.length>n+1&&(obj.filter.children[n+1].style.display="none");for(var a=0;a<obj.options.data.length;a++)obj.records[a][n].style.display="none";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.showIndex=function(){obj.table.classList.remove("jexcel_hidden_index")},obj.hideIndex=function(){obj.table.classList.add("jexcel_hidden_index")};var chainLoopProtection=[];obj.updateFormulaChain=function(n,a,c){var f=jexcel.getColumnNameFromId([n,a]);if(obj.formula[f]&&obj.formula[f].length>0)if(chainLoopProtection[f])obj.records[a][n].innerHTML="#ERROR",obj.formula[f]="";else{chainLoopProtection[f]=!0;for(var k=0;k<obj.formula[f].length;k++){var R=jexcel.getIdFromColumnName(obj.formula[f][k],!0),q=""+obj.options.data[R[1]][R[0]];q.substr(0,1)=="="?c.push(obj.updateCell(R[0],R[1],q,!0)):Object.keys(obj.formula)[k]=null,obj.updateFormulaChain(R[0],R[1],c)}}chainLoopProtection=[]},obj.updateFormulas=function(n){for(var a=0;a<obj.options.data.length;a++)for(var c=0;c<obj.options.data[0].length;c++)if((d=""+obj.options.data[a][c]).substr(0,1)=="="){var f=obj.updateFormula(d,n);f!=d&&(obj.options.data[a][c]=f)}var k=[],R=Object.keys(obj.formula);for(a=0;a<R.length;a++){var q=R[a],d=obj.formula[q];for(n[q]&&(q=n[q]),k[q]=[],c=0;c<d.length;c++){var o=d[c];n[o]&&(o=n[o]),k[q].push(o)}}obj.formula=k},obj.updateFormula=function(n,a){for(var c=/[A-Z]/,f=/[0-9]/,k="",R=null,q=null,d="",o=0;o<n.length;o++)c.exec(n[o])?(R=1,q=0,d+=n[o]):f.exec(n[o])?(q=R?1:0,d+=n[o]):(R&&q&&(d=a[d]?a[d]:d),k+=d,k+=n[o],R=0,q=0,d="");return d&&(R&&q&&(d=a[d]?a[d]:d),k+=d),k};var secureFormula=function(n){for(var a="",c=0,f=0;f<n.length;f++)n[f]=='"'&&(c=c==0?1:0),a+=c==1?n[f]:n[f].toUpperCase();return a};obj.executeFormula=function(expression,x,y){var formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){var parentId=jexcel.getColumnNameFromId([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(n){for(var a=0;a<n.length;a++){var c=[],f=n[a].split(":"),k=jexcel.getIdFromColumnName(f[0],!0),R=jexcel.getIdFromColumnName(f[1],!0);if(k[0]<=R[0])var q=k[0],d=R[0];else q=R[0],d=k[0];if(k[1]<=R[1])var o=k[1],h=R[1];else o=R[1],h=k[1];for(var _=o;_<=h;_++)for(var V=q;V<=d;V++)c.push(jexcel.getColumnNameFromId([V,_]));expression=expression.replace(n[a],c.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");var tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);tokens&&tokens.length&&tokensUpdate(tokens);var tokens=expression.match(/([A-Z]+[0-9]+)/g);if(tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";var formulaExpressions={};if(tokens){for(var i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){var position=jexcel.getIdFromColumnName(tokens[i],1);if(obj.options.data[position[1]]!==void 0&&obj.options.data[position[1]][position[0]]!==void 0)var value=obj.options.data[position[1]][position[0]];else var value="";if((""+value).substr(0,1)=="="&&(formulaResults[tokens[i]]!==void 0?value=formulaResults[tokens[i]]:(value=execute(value,position[0],position[1]),formulaResults[tokens[i]]=value)),(""+value).trim()=="")formulaExpressions[tokens[i]]=null;else if(value==Number(value)&&obj.options.autoCasting==1)formulaExpressions[tokens[i]]=Number(value);else{var number=obj.parseNumber(value,position[0]);obj.options.autoCasting==1&&number?formulaExpressions[tokens[i]]=number:formulaExpressions[tokens[i]]='"'+value+'"'}}}try{var res=jexcel.formula(expression.substr(1),formulaExpressions,x,y,obj)}catch(n){var res="#ERROR";console.log(n)}return res};return execute(expression,x,y)},obj.parseNumber=function(n,a){var c=a&&obj.options.columns[a].decimal?obj.options.columns[a].decimal:".",f=""+n;return(f=f.split(c))[0]=f[0].match(/[+-]?[0-9]/g),f[0]&&(f[0]=f[0].join("")),f[1]&&(f[1]=f[1].match(/[0-9]*/g).join("")),f[0]&&Number.isInteger(Number(f[0]))?f[1]?n=+(f[0]+"."+f[1]):n=+(f[0]+".00"):n=null,n},obj.row=function(n){},obj.col=function(n){},obj.up=function(n,a){if(n?obj.selectedCell[3]>0&&obj.up.visible(1,a?0:1):(obj.selectedCell[1]>0&&obj.up.visible(0,a?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)if(obj.selectedCell[1]==0||obj.selectedCell[3]==0)obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var c=parseInt(obj.tbody.firstChild.getAttribute("data-y"));obj.selectedCell[1]-c<30&&(obj.loadUp(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))}else if(obj.options.pagination>0){var f=obj.whichPage(obj.selectedCell[3]);f!=obj.pageNumber&&obj.page(f)}obj.updateScroll(1)},obj.up.visible=function(n,a){if(n==0)var c=parseInt(obj.selectedCell[0]),f=parseInt(obj.selectedCell[1]);else c=parseInt(obj.selectedCell[2]),f=parseInt(obj.selectedCell[3]);if(a==0){for(var k=0;k<f;k++)if(obj.records[k][c].style.display!="none"&&obj.rows[k].style.display!="none"){f=k;break}}else f=obj.up.get(c,f);n==0?(obj.selectedCell[0]=c,obj.selectedCell[1]=f):(obj.selectedCell[2]=c,obj.selectedCell[3]=f)},obj.up.get=function(n,a){n=parseInt(n);for(var c=(a=parseInt(a))-1;c>=0;c--)if(obj.records[c][n].style.display!="none"&&obj.rows[c].style.display!="none"){if(obj.records[c][n].getAttribute("data-merged")&&obj.records[c][n]==obj.records[a][n])continue;a=c;break}return a},obj.down=function(n,a){if(n?obj.selectedCell[3]<obj.records.length-1&&obj.down.visible(1,a?0:1):(obj.selectedCell[1]<obj.records.length-1&&obj.down.visible(0,a?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1?(obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):obj.loadValidation()?obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]):parseInt(obj.tbody.lastChild.getAttribute("data-y"))-obj.selectedCell[3]<30&&(obj.loadDown(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]));else if(obj.options.pagination>0){var c=obj.whichPage(obj.selectedCell[3]);c!=obj.pageNumber&&obj.page(c)}obj.updateScroll(3)},obj.down.visible=function(n,a){if(n==0)var c=parseInt(obj.selectedCell[0]),f=parseInt(obj.selectedCell[1]);else c=parseInt(obj.selectedCell[2]),f=parseInt(obj.selectedCell[3]);if(a==0){for(var k=obj.rows.length-1;k>f;k--)if(obj.records[k][c].style.display!="none"&&obj.rows[k].style.display!="none"){f=k;break}}else f=obj.down.get(c,f);n==0?(obj.selectedCell[0]=c,obj.selectedCell[1]=f):(obj.selectedCell[2]=c,obj.selectedCell[3]=f)},obj.down.get=function(n,a){n=parseInt(n);for(var c=(a=parseInt(a))+1;c<obj.rows.length;c++)if(obj.records[c][n].style.display!="none"&&obj.rows[c].style.display!="none"){if(obj.records[c][n].getAttribute("data-merged")&&obj.records[c][n]==obj.records[a][n])continue;a=c;break}return a},obj.right=function(n,a){n?obj.selectedCell[2]<obj.headers.length-1&&obj.right.visible(1,a?0:1):(obj.selectedCell[0]<obj.headers.length-1&&obj.right.visible(0,a?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(2)},obj.right.visible=function(n,a){if(n==0)var c=parseInt(obj.selectedCell[0]),f=parseInt(obj.selectedCell[1]);else c=parseInt(obj.selectedCell[2]),f=parseInt(obj.selectedCell[3]);if(a==0){for(var k=obj.headers.length-1;k>c;k--)if(obj.records[f][k].style.display!="none"){c=k;break}}else c=obj.right.get(c,f);n==0?(obj.selectedCell[0]=c,obj.selectedCell[1]=f):(obj.selectedCell[2]=c,obj.selectedCell[3]=f)},obj.right.get=function(n,a){n=parseInt(n),a=parseInt(a);for(var c=n+1;c<obj.headers.length;c++)if(obj.records[a][c].style.display!="none"){if(obj.records[a][c].getAttribute("data-merged")&&obj.records[a][c]==obj.records[a][n])continue;n=c;break}return n},obj.left=function(n,a){n?obj.selectedCell[2]>0&&obj.left.visible(1,a?0:1):(obj.selectedCell[0]>0&&obj.left.visible(0,a?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(0)},obj.left.visible=function(n,a){if(n==0)var c=parseInt(obj.selectedCell[0]),f=parseInt(obj.selectedCell[1]);else c=parseInt(obj.selectedCell[2]),f=parseInt(obj.selectedCell[3]);if(a==0){for(var k=0;k<c;k++)if(obj.records[f][k].style.display!="none"){c=k;break}}else c=obj.left.get(c,f);n==0?(obj.selectedCell[0]=c,obj.selectedCell[1]=f):(obj.selectedCell[2]=c,obj.selectedCell[3]=f)},obj.left.get=function(n,a){n=parseInt(n),a=parseInt(a);for(var c=n-1;c>=0;c--)if(obj.records[a][c].style.display!="none"){if(obj.records[a][c].getAttribute("data-merged")&&obj.records[a][c]==obj.records[a][n])continue;n=c;break}return n},obj.first=function(n,a){if(n?a?obj.selectedCell[3]=0:obj.left.visible(1,0):(a?obj.selectedCell[1]=0:obj.left.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=0&&obj.selectedCell[3]!=0){if(obj.options.pagination>0){var c=obj.whichPage(obj.selectedCell[3]);c!=obj.pageNumber&&obj.page(c)}}else obj.loadPage(0);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(1)},obj.last=function(n,a){if(n?a?obj.selectedCell[3]=obj.records.length-1:obj.right.visible(1,0):(a?obj.selectedCell[1]=obj.records.length-1:obj.right.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=obj.records.length-1&&obj.selectedCell[3]!=obj.records.length-1){if(obj.options.pagination>0){var c=obj.whichPage(obj.selectedCell[3]);c!=obj.pageNumber&&obj.page(c)}}else obj.loadPage(-1);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(3)},obj.selectAll=function(){obj.selectedCell||(obj.selectedCell=[]),obj.selectedCell[0]=0,obj.selectedCell[1]=0,obj.selectedCell[2]=obj.headers.length-1,obj.selectedCell[3]=obj.records.length-1,obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.loadPage=function(n){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)a=obj.rows;else var a=obj.results;var c=100;n!=null&&n!=-1||(n=Math.ceil(a.length/c)-1);var f=n*c,k=n*c+c;k>a.length&&(k=a.length),(f=k-100)<0&&(f=0);for(var R=f;R<k;R++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[R]):obj.tbody.appendChild(obj.rows[a[R]]),obj.tbody.children.length>c&&obj.tbody.removeChild(obj.tbody.firstChild)},obj.loadUp=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows;else var n=obj.results;var a=0;if(n.length>100){var c=parseInt(obj.tbody.firstChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(c=n.indexOf(c)),c>0)for(var f=0;f<30;f++)(c-=1)>-1&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.insertBefore(obj.rows[c],obj.tbody.firstChild):obj.tbody.insertBefore(obj.rows[n[c]],obj.tbody.firstChild),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.lastChild),a=1))}return a},obj.loadDown=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows;else var n=obj.results;var a=0;if(n.length>100){var c=parseInt(obj.tbody.lastChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(c=n.indexOf(c)),c<obj.rows.length-1)for(var f=0;f<=30;f++)c<n.length&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[c]):obj.tbody.appendChild(obj.rows[n[c]]),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.firstChild),a=1)),c+=1}return a},obj.loadValidation=function(){if(obj.selectedCell){var n=parseInt(obj.tbody.firstChild.getAttribute("data-y"))/100,a=parseInt(obj.selectedCell[3]/100),c=parseInt(obj.rows.length/100);if(n!=a&&a<=c&&!Array.prototype.indexOf.call(obj.tbody.children,obj.rows[obj.selectedCell[3]]))return obj.loadPage(a),!0}return!1},obj.resetSearch=function(){obj.searchInput.value="",obj.search(""),obj.results=null},obj.search=function(n){if(obj.options.filters&&obj.resetFilters(),obj.resetSelection(),obj.pageNumber=0,obj.results=[],n){var a=function(f){obj.results.indexOf(f)==-1&&obj.results.push(f)},c=n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");c=new RegExp(c,"i"),obj.options.data.forEach(function(f,k){if(function(h,_,V){for(var b=0;b<h.length;b++)if((""+h[b]).toLowerCase().search(_)>=0||(""+obj.records[V][b].innerHTML).toLowerCase().search(_)>=0)return!0;return!1}(f,c,k)){var R=obj.isRowMerged(k);if(R.length)for(var q=0;q<R.length;q++)for(var d=jexcel.getIdFromColumnName(R[q],!0),o=0;o<obj.options.mergeCells[R[q]][1];o++)a(d[1]+o);else a(k)}})}else obj.results=null;return obj.updateResult()},obj.updateResult=function(){var n,a=0;for(n=obj.options.lazyLoading==1?100:obj.options.pagination>0?obj.options.pagination:obj.results?obj.results.length:obj.rows.length;obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var c=0;c<obj.rows.length;c++)!obj.results||obj.results.indexOf(c)>-1?(a<n&&(obj.tbody.appendChild(obj.rows[c]),a++),obj.rows[c].style.display=""):obj.rows[c].style.display="none";return obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),n},obj.whichPage=function(n){return obj.options.search!=1&&obj.options.filters!=1||!obj.results||(n=obj.results.indexOf(n)),Math.ceil((parseInt(n)+1)/parseInt(obj.options.pagination))-1},obj.page=function(n){var a=obj.pageNumber;if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)c=obj.rows;else var c=obj.results;var f=parseInt(obj.options.pagination);n!=null&&n!=-1||(n=Math.ceil(c.length/f)-1),obj.pageNumber=n;var k=n*f,R=n*f+f;for(R>c.length&&(R=c.length),k<0&&(k=0);obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var q=k;q<R;q++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[q]):obj.tbody.appendChild(obj.rows[c[q]]);obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),obj.dispatch("onchangepage",el,n,a)},obj.updatePagination=function(){if(obj.pagination.children[0].innerHTML="",obj.pagination.children[1].innerHTML="",obj.options.pagination){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows.length;else var n=obj.results.length;if(n){var a=Math.ceil(n/obj.options.pagination);if(obj.pageNumber<6)var c=1,f=a<10?a:10;else a-obj.pageNumber<5?(f=a,(c=a-9)<1&&(c=1)):(c=obj.pageNumber-4,f=obj.pageNumber+5);c>1&&((R=document.createElement("div")).className="jexcel_page",R.innerHTML="<",R.title=1,obj.pagination.children[1].appendChild(R));for(var k=c;k<=f;k++){var R;(R=document.createElement("div")).className="jexcel_page",R.innerHTML=k,obj.pagination.children[1].appendChild(R),obj.pageNumber==k-1&&R.classList.add("jexcel_page_selected")}f<a&&((R=document.createElement("div")).className="jexcel_page",R.innerHTML=">",R.title=a,obj.pagination.children[1].appendChild(R)),obj.pagination.children[0].innerHTML=function(q){var d=Array.prototype.slice.call(arguments,1);return q.replace(/{(\d+)}/g,function(o,h){return d[h]!==void 0?d[h]:o})}(obj.options.text.showingPage,obj.pageNumber+1,a)}else obj.pagination.children[0].innerHTML=obj.options.text.noRecordsFound}},obj.download=function(n){if(obj.options.allowExport==0)console.error("Export not allowed");else{var a="";a+=obj.copy(!1,obj.options.csvDelimiter,!0,n,!0);var c=new Blob(["\uFEFF"+a],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(c,obj.options.csvFileName+".csv");else{var f=document.createElement("a"),k=URL.createObjectURL(c);f.href=k,f.setAttribute("download",obj.options.csvFileName+".csv"),document.body.appendChild(f),f.click(),f.parentNode.removeChild(f)}}},obj.setHistory=function(n){if(obj.ignoreHistory!=1){var a=++obj.historyIndex;obj.history=obj.history=obj.history.slice(0,a+1),obj.history[a]=n}},obj.copy=function(n,a,c,f,k){a||(a="	");for(var R=new RegExp(a,"ig"),q=[],d=[],o=[],h=[],_=[],V=obj.options.data[0].length,b=obj.options.data.length,u="",g=!1,v="",m="",C=0,S=0,L=0,H=0,N=!0,M=0;M<b;M++)for(var T=0;T<V;T++)n&&!obj.records[M][T].classList.contains("highlight")||(L<=T&&(L=T),H<=M&&(H=M));if(V===L+1&&b===H+1&&(N=!1),k&&obj.options.includeHeadersOnDownload==1||!k&&obj.options.includeHeadersOnCopy==1&&!N||f){if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)for(u=obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0]?obj.options.nestedHeaders:[obj.options.nestedHeaders],M=0;M<u.length;M++){var G=[];for(T=0;T<u[M].length;T++){var Y=parseInt(u[M][T].colspan);G.push(u[M][T].title);for(var ae=0;ae<Y-1;ae++)G.push("")}m+=G.join(a)+`\r
`}g=!0}for(obj.style=[],M=0;M<b;M++){for(d=[],o=[],T=0;T<V;T++)if(!n||obj.records[M][T].classList.contains("highlight")){g==1&&q.push(obj.headers[T].textContent);var be=obj.options.data[M][T];if(be.match&&(be.match(R)||be.match(/,/g)||be.match(/\n/)||be.match(/\"/))&&(be='"'+(be=be.replace(new RegExp('"',"g"),'""'))+'"'),d.push(be),obj.options.columns[T].type=="checkbox"||obj.options.columns[T].type=="radio")var se=be;else(se=obj.options.stripHTMLOnCopy==1?obj.records[M][T].textContent:obj.records[M][T].innerHTML).match&&(se.match(R)||se.match(/,/g)||se.match(/\n/)||se.match(/\"/))&&(se='"'+(se=se.replace(new RegExp('"',"g"),'""'))+'"');o.push(se),u=(u=obj.records[M][T].getAttribute("style")).replace("display: none;",""),obj.style.push(u||"")}d.length&&(g&&(C=d.length,h.push(q.join(a))),h.push(d.join(a))),o.length&&(S++,g&&(_.push(q.join(a)),g=!1),_.push(o.join(a)))}V==C&&b==S&&(v=m);var xe=v+h.join(`\r
`),Se=v+_.join(`\r
`);if(c||(obj.options.copyCompatibility==1?obj.textarea.value=Se:obj.textarea.value=xe,obj.textarea.select(),document.execCommand("copy")),obj.options.copyCompatibility==1?obj.data=Se:obj.data=xe,obj.hashString=obj.hash(obj.data),!c){if(obj.removeCopyingSelection(),obj.highlighted)for(T=0;T<obj.highlighted.length;T++)obj.highlighted[T].classList.add("copying"),obj.highlighted[T].classList.contains("highlight-left")&&obj.highlighted[T].classList.add("copying-left"),obj.highlighted[T].classList.contains("highlight-right")&&obj.highlighted[T].classList.add("copying-right"),obj.highlighted[T].classList.contains("highlight-top")&&obj.highlighted[T].classList.add("copying-top"),obj.highlighted[T].classList.contains("highlight-bottom")&&obj.highlighted[T].classList.add("copying-bottom");obj.dispatch("oncopy",el,obj.options.copyCompatibility==1?_:h,obj.hashString)}return obj.data},obj.paste=function(n,a,c){var f=obj.dispatch("onbeforepaste",el,c,n,a);if(f===!1)return!1;f&&(c=f);var k=obj.hash(c),R=k==obj.hashString?obj.style:null;if(obj.options.copyCompatibility==1&&k==obj.hashString&&(c=obj.data),c=obj.parseCSV(c,"	"),n!=null&&a!=null&&c){for(var q=0,d=0,o=[],h={},_={},V=0,b=parseInt(n),u=parseInt(a),g=null;g=c[d];){for(q=0,b=parseInt(n);g[q]!=null;){var v=obj.updateCell(b,u,g[q]);if(o.push(v),obj.updateFormulaChain(b,u,o),R&&R[V]){var m=jexcel.getColumnNameFromId([b,u]);h[m]=R[V],_[m]=obj.getStyle(m),obj.records[u][b].setAttribute("style",R[V]),V++}if(g[++q]!=null){if(b>=obj.headers.length-1){if(obj.options.allowInsertColumn!=1)break;obj.insertColumn()}b=obj.right.get(b,u)}}if(c[++d]){if(u>=obj.rows.length-1){if(obj.options.allowInsertRow!=1)break;obj.insertRow()}u=obj.down.get(n,u)}}obj.updateSelectionFromCoords(n,a,b,u),obj.setHistory({action:"setValue",records:o,selection:obj.selectedCell,newStyle:h,oldStyle:_}),obj.updateTable(),obj.dispatch("onpaste",el,c),obj.onafterchanges(el,o)}obj.removeCopyingSelection()},obj.removeCopyingSelection=function(){for(var n=document.querySelectorAll(".jexcel .copying"),a=0;a<n.length;a++)n[a].classList.remove("copying"),n[a].classList.remove("copying-left"),n[a].classList.remove("copying-right"),n[a].classList.remove("copying-top"),n[a].classList.remove("copying-bottom")},obj.historyProcessRow=function(n,a){var c=a.insertBefore?+a.rowNumber:a.rowNumber+1;if(obj.options.search==1&&obj.results&&obj.results.length!=obj.rows.length&&obj.resetSearch(),n==1){for(var f=a.numOfRows,k=c;k<f+c;k++)obj.rows[k].parentNode.removeChild(obj.rows[k]);obj.records.splice(c,f),obj.options.data.splice(c,f),obj.rows.splice(c,f),obj.conditionalSelectionUpdate(1,c,f+c-1)}else{obj.records=jexcel.injectArray(obj.records,c,a.rowRecords),obj.options.data=jexcel.injectArray(obj.options.data,c,a.rowData),obj.rows=jexcel.injectArray(obj.rows,c,a.rowNode);var R=0;for(k=c;k<a.numOfRows+c;k++)obj.tbody.insertBefore(a.rowNode[R],obj.tbody.children[k]),R++}obj.options.pagination>0&&obj.page(obj.pageNumber),obj.updateTableReferences()},obj.historyProcessColumn=function(n,a){var c=a.insertBefore?a.columnNumber:a.columnNumber+1;if(n==1){var f=a.numOfColumns;obj.options.columns.splice(c,f);for(var k=c;k<f+c;k++)obj.headers[k].parentNode.removeChild(obj.headers[k]),obj.colgroup[k].parentNode.removeChild(obj.colgroup[k]);obj.headers.splice(c,f),obj.colgroup.splice(c,f);for(var R=0;R<a.data.length;R++){for(k=c;k<f+c;k++)obj.records[R][k].parentNode.removeChild(obj.records[R][k]);obj.records[R].splice(c,f),obj.options.data[R].splice(c,f)}if(obj.options.footers)for(R=0;R<obj.options.footers.length;R++)obj.options.footers[R].splice(c,f)}else{obj.options.columns=jexcel.injectArray(obj.options.columns,c,a.columns),obj.headers=jexcel.injectArray(obj.headers,c,a.headers),obj.colgroup=jexcel.injectArray(obj.colgroup,c,a.colgroup);var q=0;for(k=c;k<a.numOfColumns+c;k++)obj.headerContainer.insertBefore(a.headers[q],obj.headerContainer.children[k+1]),obj.colgroupContainer.insertBefore(a.colgroup[q],obj.colgroupContainer.children[k+1]),q++;for(R=0;R<a.data.length;R++)for(obj.options.data[R]=jexcel.injectArray(obj.options.data[R],c,a.data[R]),obj.records[R]=jexcel.injectArray(obj.records[R],c,a.records[R]),q=0,k=c;k<a.numOfColumns+c;k++)obj.rows[R].insertBefore(a.records[R][q],obj.rows[R].children[k+1]),q++;if(obj.options.footers)for(R=0;R<obj.options.footers.length;R++)obj.options.footers[R]=jexcel.injectArray(obj.options.footers[R],c,a.footers[R])}if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(R=0;R<obj.options.nestedHeaders.length;R++){if(n==1)var d=parseInt(obj.options.nestedHeaders[R][obj.options.nestedHeaders[R].length-1].colspan)-a.numOfColumns;else d=parseInt(obj.options.nestedHeaders[R][obj.options.nestedHeaders[R].length-1].colspan)+a.numOfColumns;obj.options.nestedHeaders[R][obj.options.nestedHeaders[R].length-1].colspan=d,obj.thead.children[R].children[obj.thead.children[R].children.length-1].setAttribute("colspan",d)}else d=n==1?parseInt(obj.options.nestedHeaders[0].colspan)-a.numOfColumns:parseInt(obj.options.nestedHeaders[0].colspan)+a.numOfColumns,obj.options.nestedHeaders[0].colspan=d,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",d);obj.updateTableReferences()},obj.undo=function(){var n=!!obj.ignoreEvents,a=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;var c=[];if(obj.historyIndex>=0){var f=obj.history[obj.historyIndex--];if(f.action=="insertRow")obj.historyProcessRow(1,f);else if(f.action=="deleteRow")obj.historyProcessRow(0,f);else if(f.action=="insertColumn")obj.historyProcessColumn(1,f);else if(f.action=="deleteColumn")obj.historyProcessColumn(0,f);else if(f.action=="moveRow")obj.moveRow(f.newValue,f.oldValue);else if(f.action=="moveColumn")obj.moveColumn(f.newValue,f.oldValue);else if(f.action=="setMerge")obj.removeMerge(f.column,f.data);else if(f.action=="setStyle")obj.setStyle(f.oldValue,null,null,1);else if(f.action=="setWidth")obj.setWidth(f.column,f.oldValue);else if(f.action=="setHeight")obj.setHeight(f.row,f.oldValue);else if(f.action=="setHeader")obj.setHeader(f.column,f.oldValue);else if(f.action=="setComments")obj.setComments(f.column,f.oldValue[0],f.oldValue[1]);else if(f.action=="orderBy"){for(var k=[],R=0;R<f.rows.length;R++)k[f.rows[R]]=R;obj.updateOrderArrow(f.column,f.order?0:1),obj.updateOrder(k)}else if(f.action=="setValue"){for(var q=0;q<f.records.length;q++)c.push({x:f.records[q].x,y:f.records[q].y,newValue:f.records[q].oldValue}),f.oldStyle&&obj.resetStyle(f.oldStyle);obj.setValue(c),f.selection&&obj.updateSelectionFromCoords(f.selection[0],f.selection[1],f.selection[2],f.selection[3])}}obj.ignoreEvents=n,obj.ignoreHistory=a,obj.dispatch("onundo",el,f)},obj.redo=function(){var n=!!obj.ignoreEvents,a=!!obj.ignoreHistory;if(obj.ignoreEvents=!0,obj.ignoreHistory=!0,obj.historyIndex<obj.history.length-1){var c=obj.history[++obj.historyIndex];if(c.action=="insertRow")obj.historyProcessRow(0,c);else if(c.action=="deleteRow")obj.historyProcessRow(1,c);else if(c.action=="insertColumn")obj.historyProcessColumn(0,c);else if(c.action=="deleteColumn")obj.historyProcessColumn(1,c);else if(c.action=="moveRow")obj.moveRow(c.oldValue,c.newValue);else if(c.action=="moveColumn")obj.moveColumn(c.oldValue,c.newValue);else if(c.action=="setMerge")obj.setMerge(c.column,c.colspan,c.rowspan,1);else if(c.action=="setStyle")obj.setStyle(c.newValue,null,null,1);else if(c.action=="setWidth")obj.setWidth(c.column,c.newValue);else if(c.action=="setHeight")obj.setHeight(c.row,c.newValue);else if(c.action=="setHeader")obj.setHeader(c.column,c.newValue);else if(c.action=="setComments")obj.setComments(c.column,c.newValue[0],c.newValue[1]);else if(c.action=="orderBy")obj.updateOrderArrow(c.column,c.order),obj.updateOrder(c.rows);else if(c.action=="setValue"){obj.setValue(c.records);for(var f=0;f<c.records.length;f++)c.oldStyle&&obj.resetStyle(c.newStyle);c.selection&&obj.updateSelectionFromCoords(c.selection[0],c.selection[1],c.selection[2],c.selection[3])}}obj.ignoreEvents=n,obj.ignoreHistory=a,obj.dispatch("onredo",el,c)},obj.getDropDownValue=function(n,a){var c=[];if(obj.options.columns[n]&&obj.options.columns[n].source){for(var f=[],k=obj.options.columns[n].source,R=0;R<k.length;R++)typeof k[R]=="object"?f[k[R].id]=k[R].name:f[k[R]]=k[R];var q=Array.isArray(a)?a:(""+a).split(";");for(R=0;R<q.length;R++)typeof q[R]=="object"?c.push(f[q[R].id]):f[q[R]]&&c.push(f[q[R]])}else console.error("Invalid column");return c.length>0?c.join("; "):""},obj.parseCSV=function(n,a){(n=n.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(n.length-1)==9&&(n+="\0"),a=a||",";for(var c=[],f=!1,k=0,R=0,q=0;q<n.length;q++){var d=n[q],o=n[q+1];c[k]=c[k]||[],c[k][R]=c[k][R]||"",d=='"'&&f&&o=='"'?(c[k][R]+=d,++q):d!='"'?d!=a||f?d!="\r"||o!=`
`||f?d==`
`&&!f||d=="\r"&&!f?(++k,R=0):c[k][R]+=d:(++k,R=0,++q):++R:f=!f}return c},obj.hash=function(n){var a,c=0;if(n.length===0)return c;for(a=0;a<n.length;a++)c=(c<<5)-c+n.charCodeAt(a),c|=0;return c},obj.onafterchanges=function(n,a){obj.dispatch("onafterchanges",n,a)},obj.destroy=function(){jexcel.destroy(el)},obj.init=function(){jexcel.current=obj,typeof jexcel.build=="function"&&(obj.options.root?jexcel.build(obj.options.root):(jexcel.build(document),jexcel.build=null)),el.setAttribute("tabindex",1),el.addEventListener("focus",function(n){jexcel.current&&!obj.selectedCell&&(obj.updateSelectionFromCoords(0,0,0,0),obj.left())}),obj.options.csv?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.csv,method:obj.options.method,data:obj.options.requestVariables,dataType:"text",success:function(n){var a=obj.parseCSV(n,obj.options.csvDelimiter);if(obj.options.csvHeaders==1&&a.length>0)for(var c=a.shift(),f=0;f<c.length;f++)obj.options.columns[f]||(obj.options.columns[f]={type:"text",align:obj.options.defaultColAlign,width:obj.options.defaultColWidth}),obj.options.columns[f].title===void 0&&(obj.options.columns[f].title=c[f]);obj.options.data=a,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(n){obj.options.data=n.data?n.data:n,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.prepareTable()},options&&options.contextMenu!=null?obj.options.contextMenu=options.contextMenu:obj.options.contextMenu=function(n,a,c,f){var k=[];if(c==null)obj.options.allowInsertColumn==1&&k.push({title:obj.options.text.insertANewColumnBefore,onclick:function(){obj.insertColumn(1,parseInt(a),1)}}),obj.options.allowInsertColumn==1&&k.push({title:obj.options.text.insertANewColumnAfter,onclick:function(){obj.insertColumn(1,parseInt(a),0)}}),obj.options.allowDeleteColumn==1&&k.push({title:obj.options.text.deleteSelectedColumns,onclick:function(){obj.deleteColumn(obj.getSelectedColumns().length?void 0:parseInt(a))}}),obj.options.allowRenameColumn==1&&k.push({title:obj.options.text.renameThisColumn,onclick:function(){obj.setHeader(a)}}),obj.options.columnSorting==1&&(k.push({type:"line"}),k.push({title:obj.options.text.orderAscending,onclick:function(){obj.orderBy(a,0)}}),k.push({title:obj.options.text.orderDescending,onclick:function(){obj.orderBy(a,1)}}));else if(obj.options.allowInsertRow==1&&(k.push({title:obj.options.text.insertANewRowBefore,onclick:function(){obj.insertRow(1,parseInt(c),1)}}),k.push({title:obj.options.text.insertANewRowAfter,onclick:function(){obj.insertRow(1,parseInt(c))}})),obj.options.allowDeleteRow==1&&k.push({title:obj.options.text.deleteSelectedRows,onclick:function(){obj.deleteRow(obj.getSelectedRows().length?void 0:parseInt(c))}}),a&&obj.options.allowComments==1){k.push({type:"line"});var R=obj.records[c][a].getAttribute("title")||"";k.push({title:R?obj.options.text.editComments:obj.options.text.addComments,onclick:function(){var q=prompt(obj.options.text.comments,R);q&&obj.setComments([a,c],q)}}),R&&k.push({title:obj.options.text.clearComments,onclick:function(){obj.setComments([a,c],"")}})}return k.push({type:"line"}),k.push({title:obj.options.text.copy,shortcut:"Ctrl + C",onclick:function(){obj.copy(!0)}}),navigator&&navigator.clipboard&&k.push({title:obj.options.text.paste,shortcut:"Ctrl + V",onclick:function(){obj.selectedCell&&navigator.clipboard.readText().then(function(q){q&&jexcel.current.paste(obj.selectedCell[0],obj.selectedCell[1],q)})}}),obj.options.allowExport&&k.push({title:obj.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){obj.download()}}),obj.options.about&&k.push({title:obj.options.text.about,onclick:function(){obj.options.about===!0?alert(Version().print()):alert(obj.options.about)}}),k},obj.scrollControls=function(n){obj.wheelControls(),obj.options.freezeColumns>0&&obj.content.scrollLeft!=scrollLeft&&obj.updateFreezePosition(),obj.options.lazyLoading!=1&&obj.options.tableOverflow!=1||obj.edition&&n.target.className.substr(0,9)!="jdropdown"&&obj.closeEditor(obj.edition[0],!0)},obj.wheelControls=function(n){obj.options.lazyLoading==1&&jexcel.timeControlLoading==null&&(jexcel.timeControlLoading=setTimeout(function(){obj.content.scrollTop+obj.content.clientHeight>=obj.content.scrollHeight-10?obj.loadDown()&&(obj.content.scrollTop+obj.content.clientHeight>obj.content.scrollHeight-10&&(obj.content.scrollTop=obj.content.scrollTop-obj.content.clientHeight),obj.updateCornerPosition()):obj.content.scrollTop<=obj.content.clientHeight&&obj.loadUp()&&(obj.content.scrollTop<10&&(obj.content.scrollTop=obj.content.scrollTop+obj.content.clientHeight),obj.updateCornerPosition()),jexcel.timeControlLoading=null},100))},obj.getFreezeWidth=function(){var n=0;if(obj.options.freezeColumns>0)for(var a=0;a<obj.options.freezeColumns;a++)n+=parseInt(obj.options.columns[a].width);return n};var scrollLeft=0;return obj.updateFreezePosition=function(){var n=0;if((scrollLeft=obj.content.scrollLeft)>50)for(var a=0;a<obj.options.freezeColumns;a++){a>0&&obj.options.columns[a-1].type!=="hidden"&&(n+=parseInt(obj.options.columns[a-1].width)),obj.headers[a].classList.add("jexcel_freezed"),obj.headers[a].style.left=n+"px";for(var c=0;c<obj.rows.length;c++)if(obj.rows[c]&&obj.records[c][a]){var f=scrollLeft+(a>0?obj.records[c][a-1].style.width:0)-51+"px";obj.records[c][a].classList.add("jexcel_freezed"),obj.records[c][a].style.left=f}}else for(a=0;a<obj.options.freezeColumns;a++)for(obj.headers[a].classList.remove("jexcel_freezed"),obj.headers[a].style.left="",c=0;c<obj.rows.length;c++)obj.records[c][a]&&(obj.records[c][a].classList.remove("jexcel_freezed"),obj.records[c][a].style.left="");obj.updateCornerPosition()},el.addEventListener("DOMMouseScroll",obj.wheelControls),el.addEventListener("mousewheel",obj.wheelControls),el.jexcel=obj,el.jspreadsheet=obj,obj.init(),obj};jexcel.setDictionary=function(n){jSuites.setDictionary(n)},jexcel.setExtensions=function(n){for(var a=Object.keys(n),c=0;c<a.length;c++)typeof n[a[c]]=="function"&&(jexcel[a[c]]=n[a[c]],jexcel.license&&typeof n[a[c]].license=="function"&&n[a[c]].license(jexcel.license))},formula!==void 0&&(jexcel.formula=formula),jexcel.version=Version,jexcel.current=null,jexcel.timeControl=null,jexcel.timeControlLoading=null;const destroyEvents=function(n){n.removeEventListener("mouseup",jexcel.mouseUpControls),n.removeEventListener("mousedown",jexcel.mouseDownControls),n.removeEventListener("mousemove",jexcel.mouseMoveControls),n.removeEventListener("mouseover",jexcel.mouseOverControls),n.removeEventListener("dblclick",jexcel.doubleClickControls),n.removeEventListener("paste",jexcel.pasteControls),n.removeEventListener("contextmenu",jexcel.contextMenuControls),n.removeEventListener("touchstart",jexcel.touchStartControls),n.removeEventListener("touchend",jexcel.touchEndControls),n.removeEventListener("touchcancel",jexcel.touchEndControls),document.removeEventListener("keydown",jexcel.keyDownControls)};var component;return jexcel.destroy=function(n,a){if(n.jexcel){var c=n.jexcel.options.root?n.jexcel.options.root:document;n.removeEventListener("DOMMouseScroll",n.jexcel.scrollControls),n.removeEventListener("mousewheel",n.jexcel.scrollControls),n.jexcel=null,n.innerHTML="",a&&(destroyEvents(c),jexcel=null)}},jexcel.build=function(n){destroyEvents(n),n.addEventListener("mouseup",jexcel.mouseUpControls),n.addEventListener("mousedown",jexcel.mouseDownControls),n.addEventListener("mousemove",jexcel.mouseMoveControls),n.addEventListener("mouseover",jexcel.mouseOverControls),n.addEventListener("dblclick",jexcel.doubleClickControls),n.addEventListener("paste",jexcel.pasteControls),n.addEventListener("contextmenu",jexcel.contextMenuControls),n.addEventListener("touchstart",jexcel.touchStartControls),n.addEventListener("touchend",jexcel.touchEndControls),n.addEventListener("touchcancel",jexcel.touchEndControls),n.addEventListener("touchmove",jexcel.touchEndControls),document.addEventListener("keydown",jexcel.keyDownControls)},jexcel.keyDownControls=function(n){if(jexcel.current){if(jexcel.current.edition)if(n.which==27)jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!1),n.preventDefault();else if(n.which==13){if(jexcel.current.options.columns[jexcel.current.edition[2]].type=="calendar")jexcel.current.closeEditor(jexcel.current.edition[0],!0);else if(!(jexcel.current.options.columns[jexcel.current.edition[2]].type=="dropdown"||jexcel.current.options.columns[jexcel.current.edition[2]].type=="autocomplete"))if((jexcel.current.options.wordWrap==1||jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap==1||jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length>200)&&n.altKey){var a=jexcel.current.edition[0].children[0],c=jexcel.current.edition[0].children[0].value,f=a.selectionStart;c=c.slice(0,f)+`
`+c.slice(f),a.value=c,a.focus(),a.selectionStart=f+1,a.selectionEnd=f+1}else jexcel.current.edition[0].children[0].blur()}else n.which==9&&(["calendar","html"].includes(jexcel.current.options.columns[jexcel.current.edition[2]].type)?jexcel.current.closeEditor(jexcel.current.edition[0],!0):jexcel.current.edition[0].children[0].blur());if(!jexcel.current.edition&&jexcel.current.selectedCell)if(n.which==37)jexcel.current.left(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==39)jexcel.current.right(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==38)jexcel.current.up(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==40)jexcel.current.down(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==36)jexcel.current.first(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==35)jexcel.current.last(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==46)jexcel.current.options.editable==1&&(jexcel.current.selectedRow?jexcel.current.options.allowDeleteRow==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)&&jexcel.current.deleteRow():jexcel.current.selectedHeader?jexcel.current.options.allowDeleteColumn==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)&&jexcel.current.deleteColumn():jexcel.current.setValue(jexcel.current.highlighted,""));else if(n.which==13)n.shiftKey?jexcel.current.up():(jexcel.current.options.allowInsertRow==1&&jexcel.current.options.allowManualInsertRow==1&&jexcel.current.selectedCell[1]==jexcel.current.options.data.length-1&&jexcel.current.insertRow(),jexcel.current.down()),n.preventDefault();else if(n.which==9)n.shiftKey?jexcel.current.left():(jexcel.current.options.allowInsertColumn==1&&jexcel.current.options.allowManualInsertColumn==1&&jexcel.current.selectedCell[0]==jexcel.current.options.data[0].length-1&&jexcel.current.insertColumn(),jexcel.current.right()),n.preventDefault();else if(!n.ctrlKey&&!n.metaKey||n.shiftKey){if(jexcel.current.selectedCell&&jexcel.current.options.editable==1){var k=jexcel.current.selectedCell[1],R=jexcel.current.selectedCell[0];jexcel.current.options.columns[R].type!="readonly"&&(n.keyCode==32?(n.preventDefault(),jexcel.current.options.columns[R].type=="checkbox"||jexcel.current.options.columns[R].type=="radio"?jexcel.current.setCheckRadioValue():jexcel.current.openEditor(jexcel.current.records[k][R],!0)):n.keyCode==113?jexcel.current.openEditor(jexcel.current.records[k][R],!1):(n.keyCode==8||n.keyCode>=48&&n.keyCode<=57||n.keyCode>=96&&n.keyCode<=111||n.keyCode>=187&&n.keyCode<=190||(String.fromCharCode(n.keyCode)==n.key||String.fromCharCode(n.keyCode).toLowerCase()==n.key.toLowerCase())&&jexcel.validLetter(String.fromCharCode(n.keyCode)))&&(jexcel.current.openEditor(jexcel.current.records[k][R],!0),jexcel.current.options.columns[R].type=="calendar"&&n.preventDefault()))}}else n.which==65?(jexcel.current.selectAll(),n.preventDefault()):n.which==83?(jexcel.current.download(),n.preventDefault()):n.which==89?(jexcel.current.redo(),n.preventDefault()):n.which==90?(jexcel.current.undo(),n.preventDefault()):n.which==67?(jexcel.current.copy(!0),n.preventDefault()):n.which==88?(jexcel.current.options.editable==1?jexcel.cutControls():jexcel.copyControls(),n.preventDefault()):n.which==86&&jexcel.pasteControls();else n.target.classList.contains("jexcel_search")&&(jexcel.timeControl&&clearTimeout(jexcel.timeControl),jexcel.timeControl=setTimeout(function(){jexcel.current.search(n.target.value)},200))}},jexcel.isMouseAction=!1,jexcel.mouseDownControls=function(n){if((n=n||window.event).buttons)var a=n.buttons;else a=n.button?n.button:n.which;var c=jexcel.getElement(n.target);if(c[0]?jexcel.current!=c[0].jexcel&&(jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection()),jexcel.current=c[0].jexcel):jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection(!0),jexcel.current=null),jexcel.current&&a==1){if(n.target.classList.contains("jexcel_selectall"))jexcel.current&&jexcel.current.selectAll();else if(n.target.classList.contains("jexcel_corner"))jexcel.current.options.editable==1&&(jexcel.current.selectedCorner=!0);else{if(c[1]==1){if(u=n.target.getAttribute("data-x")){var f=n.target.getBoundingClientRect();if(jexcel.current.options.columnResize==1&&f.width-n.offsetX<6){jexcel.current.resizing={mousePosition:n.pageX,column:u,width:f.width},jexcel.current.headers[u].classList.add("resizing");for(var k=0;k<jexcel.current.records.length;k++)jexcel.current.records[k][u]&&jexcel.current.records[k][u].classList.add("resizing")}else if(jexcel.current.options.columnDrag==1&&f.height-n.offsetY<6)if(jexcel.current.isColMerged(u).length)console.error("Jspreadsheet: This column is part of a merged cell.");else for(jexcel.current.resetSelection(),jexcel.current.dragging={element:n.target,column:u,destination:u},jexcel.current.headers[u].classList.add("dragging"),k=0;k<jexcel.current.records.length;k++)jexcel.current.records[k][u]&&jexcel.current.records[k][u].classList.add("dragging");else{if(jexcel.current.selectedHeader&&(n.shiftKey||n.ctrlKey))var R=jexcel.current.selectedHeader,q=u;else jexcel.current.selectedHeader==u&&jexcel.current.options.allowRenameColumn==1&&(jexcel.timeControl=setTimeout(function(){jexcel.current.setHeader(u)},800)),jexcel.current.selectedHeader=u,R=u,q=u;jexcel.current.updateSelectionFromCoords(R,0,q,jexcel.current.options.data.length-1)}}else if(n.target.parentNode.classList.contains("jexcel_nested")){if(n.target.getAttribute("data-column"))var d=n.target.getAttribute("data-column").split(","),o=parseInt(d[0]),h=parseInt(d[d.length-1]);else o=0,h=jexcel.current.options.columns.length-1;jexcel.current.updateSelectionFromCoords(o,0,h,jexcel.current.options.data.length-1)}}else jexcel.current.selectedHeader=!1;if(c[1]==2){var _=n.target.getAttribute("data-y");if(n.target.classList.contains("jexcel_row"))f=n.target.getBoundingClientRect(),jexcel.current.options.rowResize==1&&f.height-n.offsetY<6?(jexcel.current.resizing={element:n.target.parentNode,mousePosition:n.pageY,row:_,height:f.height},n.target.parentNode.classList.add("resizing")):jexcel.current.options.rowDrag==1&&f.width-n.offsetX<6?jexcel.current.isRowMerged(_).length?console.error("Jspreadsheet: This row is part of a merged cell"):jexcel.current.options.search==1&&jexcel.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(jexcel.current.resetSelection(),jexcel.current.dragging={element:n.target.parentNode,row:_,destination:_},n.target.parentNode.classList.add("dragging")):(jexcel.current.selectedRow&&(n.shiftKey||n.ctrlKey)?(R=jexcel.current.selectedRow,q=_):(jexcel.current.selectedRow=_,R=_,q=_),jexcel.current.updateSelectionFromCoords(0,R,jexcel.current.options.data[0].length-1,q));else if(n.target.classList.contains("jclose")&&n.target.clientWidth-n.offsetX<50&&n.offsetY<50)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else{var V=function(g){var v=g.getAttribute("data-x"),m=g.getAttribute("data-y");return v&&m?[v,m]:g.parentNode?V(g.parentNode):void 0},b=V(n.target);if(b){var u=b[0];_=b[1],jexcel.current.edition&&(jexcel.current.edition[2]==u&&jexcel.current.edition[3]==_||jexcel.current.closeEditor(jexcel.current.edition[0],!0)),jexcel.current.edition||(n.shiftKey?jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],u,_):jexcel.current.updateSelectionFromCoords(u,_)),jexcel.current.selectedHeader=null,jexcel.current.selectedRow=null}}}else jexcel.current.selectedRow=!1;n.target.classList.contains("jexcel_page")&&(n.target.textContent=="<"?jexcel.current.page(0):n.target.textContent==">"?jexcel.current.page(n.target.getAttribute("title")-1):jexcel.current.page(n.target.textContent-1))}jexcel.current.edition?jexcel.isMouseAction=!1:jexcel.isMouseAction=!0}else jexcel.isMouseAction=!1},jexcel.mouseUpControls=function(n){if(jexcel.current)if(jexcel.current.resizing){if(jexcel.current.resizing.column){var a=jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute("width"),c=jexcel.current.getSelectedColumns();if(c.length>1){for(var f=[],k=0;k<c.length;k++)f.push(parseInt(jexcel.current.colgroup[c[k]].getAttribute("width")));f[c.indexOf(parseInt(jexcel.current.resizing.column))]=jexcel.current.resizing.width,jexcel.current.setWidth(c,a,f)}else jexcel.current.setWidth(jexcel.current.resizing.column,a,jexcel.current.resizing.width);jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");for(var R=0;R<jexcel.current.records.length;R++)jexcel.current.records[R][jexcel.current.resizing.column]&&jexcel.current.records[R][jexcel.current.resizing.column].classList.remove("resizing")}else{jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove("resizing");var q=jexcel.current.rows[jexcel.current.resizing.row].getAttribute("height");jexcel.current.setHeight(jexcel.current.resizing.row,q,jexcel.current.resizing.height),jexcel.current.resizing.element.classList.remove("resizing")}jexcel.current.resizing=null}else if(jexcel.current.dragging){if(jexcel.current.dragging){if(jexcel.current.dragging.column){var d=n.target.getAttribute("data-x");for(jexcel.current.headers[jexcel.current.dragging.column].classList.remove("dragging"),R=0;R<jexcel.current.rows.length;R++)jexcel.current.records[R][jexcel.current.dragging.column]&&jexcel.current.records[R][jexcel.current.dragging.column].classList.remove("dragging");for(k=0;k<jexcel.current.headers.length;k++)jexcel.current.headers[k].classList.remove("dragging-left"),jexcel.current.headers[k].classList.remove("dragging-right");d&&jexcel.current.dragging.column!=jexcel.current.dragging.destination&&jexcel.current.moveColumn(jexcel.current.dragging.column,jexcel.current.dragging.destination)}else{if(jexcel.current.dragging.element.nextSibling){var o=parseInt(jexcel.current.dragging.element.nextSibling.getAttribute("data-y"));jexcel.current.dragging.row<o&&(o-=1)}else o=parseInt(jexcel.current.dragging.element.previousSibling.getAttribute("data-y"));jexcel.current.dragging.row!=jexcel.current.dragging.destination&&jexcel.current.moveRow(jexcel.current.dragging.row,o,!0),jexcel.current.dragging.element.classList.remove("dragging")}jexcel.current.dragging=null}}else jexcel.current.selectedCorner&&(jexcel.current.selectedCorner=!1,jexcel.current.selection.length>0&&(jexcel.current.copyData(jexcel.current.selection[0],jexcel.current.selection[jexcel.current.selection.length-1]),jexcel.current.removeCopySelection()));jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null),jexcel.isMouseAction=!1},jexcel.mouseMoveControls=function(n){if((n=n||window.event).buttons)var a=n.buttons;else a=n.button?n.button:n.which;if(a||(jexcel.isMouseAction=!1),jexcel.current)if(jexcel.isMouseAction==1){if(jexcel.current.resizing)if(jexcel.current.resizing.column){var c=n.pageX-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.width+c>0){var f=jexcel.current.resizing.width+c;jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute("width",f),jexcel.current.updateCornerPosition()}}else{var k=n.pageY-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.height+k>0){var R=jexcel.current.resizing.height+k;jexcel.current.rows[jexcel.current.resizing.row].setAttribute("height",R),jexcel.current.updateCornerPosition()}}else if(jexcel.current.dragging)if(jexcel.current.dragging.column){var q=n.target.getAttribute("data-x");if(q)if(jexcel.current.isColMerged(q).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(var d=0;d<jexcel.current.headers.length;d++)jexcel.current.headers[d].classList.remove("dragging-left"),jexcel.current.headers[d].classList.remove("dragging-right");jexcel.current.dragging.column==q?jexcel.current.dragging.destination=parseInt(q):n.target.clientWidth/2>n.offsetX?(jexcel.current.dragging.column<q?jexcel.current.dragging.destination=parseInt(q)-1:jexcel.current.dragging.destination=parseInt(q),jexcel.current.headers[q].classList.add("dragging-left")):(jexcel.current.dragging.column<q?jexcel.current.dragging.destination=parseInt(q):jexcel.current.dragging.destination=parseInt(q)+1,jexcel.current.headers[q].classList.add("dragging-right"))}}else{var o=n.target.getAttribute("data-y");if(o)if(jexcel.current.isRowMerged(o).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{var h=n.target.clientHeight/2>n.offsetY?n.target.parentNode.nextSibling:n.target.parentNode;jexcel.current.dragging.element!=h&&(n.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element,h),jexcel.current.dragging.destination=Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children,jexcel.current.dragging.element))}}}else{var _=n.target.getAttribute("data-x"),V=n.target.getAttribute("data-y"),b=n.target.getBoundingClientRect();jexcel.current.cursor&&(jexcel.current.cursor.style.cursor="",jexcel.current.cursor=null),n.target.parentNode.parentNode&&n.target.parentNode.parentNode.className&&(n.target.parentNode.parentNode.classList.contains("resizable")&&(n.target&&_&&!V&&b.width-(n.clientX-b.left)<6?(jexcel.current.cursor=n.target,jexcel.current.cursor.style.cursor="col-resize"):n.target&&!_&&V&&b.height-(n.clientY-b.top)<6&&(jexcel.current.cursor=n.target,jexcel.current.cursor.style.cursor="row-resize")),n.target.parentNode.parentNode.classList.contains("draggable")&&(n.target&&!_&&V&&b.width-(n.clientX-b.left)<6||n.target&&_&&!V&&b.height-(n.clientY-b.top)<6)&&(jexcel.current.cursor=n.target,jexcel.current.cursor.style.cursor="move"))}},jexcel.mouseOverControls=function(n){if((n=n||window.event).buttons)var a=n.buttons;else a=n.button?n.button:n.which;if(a||(jexcel.isMouseAction=!1),jexcel.current&&jexcel.isMouseAction==1){var c=jexcel.getElement(n.target);if(c[0]){if(jexcel.current!=c[0].jexcel&&jexcel.current)return!1;var f=n.target.getAttribute("data-x"),k=n.target.getAttribute("data-y");if(!(jexcel.current.resizing||jexcel.current.dragging)){if(c[1]==1&&jexcel.current.selectedHeader){f=n.target.getAttribute("data-x");var R=jexcel.current.selectedHeader,q=f;jexcel.current.updateSelectionFromCoords(R,0,q,jexcel.current.options.data.length-1)}c[1]==2&&(n.target.classList.contains("jexcel_row")?jexcel.current.selectedRow&&(R=jexcel.current.selectedRow,q=k,jexcel.current.updateSelectionFromCoords(0,R,jexcel.current.options.data[0].length-1,q)):jexcel.current.edition||f&&k&&(jexcel.current.selectedCorner?jexcel.current.updateCopySelection(f,k):jexcel.current.selectedCell&&jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],f,k)))}}}jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null)},jexcel.doubleClickControls=function(n){if(jexcel.current)if(n.target.classList.contains("jexcel_corner")){if(jexcel.current.highlighted.length>0){var a=jexcel.current.highlighted[0].getAttribute("data-x"),c=parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-y"))+1,f=jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-x"),k=jexcel.current.records.length-1;jexcel.current.copyData(jexcel.current.records[c][a],jexcel.current.records[k][f])}}else if(n.target.classList.contains("jexcel_column_filter")){var R=n.target.getAttribute("data-x");jexcel.current.openFilter(R)}else{var q=jexcel.getElement(n.target);if(q[1]==1&&jexcel.current.options.columnSorting==1&&(R=n.target.getAttribute("data-x"))&&jexcel.current.orderBy(R),q[1]==2&&jexcel.current.options.editable==1&&!jexcel.current.edition){var d=function(h){if(h.parentNode){var _=h.getAttribute("data-x"),V=h.getAttribute("data-y");return _&&V?h:d(h.parentNode)}},o=d(n.target);o&&o.classList.contains("highlight")&&jexcel.current.openEditor(o)}}},jexcel.copyControls=function(n){jexcel.current&&jexcel.copyControls.enabled&&(jexcel.current.edition||jexcel.current.copy(!0))},jexcel.cutControls=function(n){jexcel.current&&(jexcel.current.edition||(jexcel.current.copy(!0),jexcel.current.options.editable==1&&jexcel.current.setValue(jexcel.current.highlighted,"")))},jexcel.pasteControls=function(n){jexcel.current&&jexcel.current.selectedCell&&(jexcel.current.edition||jexcel.current.options.editable==1&&(n&&n.clipboardData?(jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],n.clipboardData.getData("text")),n.preventDefault()):window.clipboardData&&jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],window.clipboardData.getData("text"))))},jexcel.contextMenuControls=function(n){if("buttons"in(n=n||window.event)?n.buttons:n.which||n.button,jexcel.current){if(jexcel.current.edition)n.preventDefault();else if(jexcel.current.options.contextMenu&&(jexcel.current.contextMenu.contextmenu.close(),jexcel.current)){var a=n.target.getAttribute("data-x"),c=n.target.getAttribute("data-y");if(a||c){(a<parseInt(jexcel.current.selectedCell[0])||a>parseInt(jexcel.current.selectedCell[2])||c<parseInt(jexcel.current.selectedCell[1])||c>parseInt(jexcel.current.selectedCell[3]))&&jexcel.current.updateSelectionFromCoords(a,c,a,c);var f=jexcel.current.options.contextMenu(jexcel.current,a,c,n);jexcel.current.contextMenu.contextmenu.open(n,f),n.preventDefault()}}}},jexcel.touchStartControls=function(n){var a=jexcel.getElement(n.target);if(a[0]?jexcel.current!=a[0].jexcel&&(jexcel.current&&jexcel.current.resetSelection(),jexcel.current=a[0].jexcel):jexcel.current&&(jexcel.current.resetSelection(),jexcel.current=null),jexcel.current&&!jexcel.current.edition){var c=n.target.getAttribute("data-x"),f=n.target.getAttribute("data-y");c&&f&&(jexcel.current.updateSelectionFromCoords(c,f),jexcel.timeControl=setTimeout(function(){jexcel.current.options.columns[c].type=="color"?jexcel.tmpElement=null:jexcel.tmpElement=n.target,jexcel.current.openEditor(n.target,!1,n)},500))}},jexcel.touchEndControls=function(n){jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null,jexcel.tmpElement&&jexcel.tmpElement.children[0].tagName=="INPUT"&&jexcel.tmpElement.children[0].focus(),jexcel.tmpElement=null)},jexcel.tabs=function(n,a){var c=[];if(n.classList.contains("jexcel_tabs"))k=n.children[0],R=n.children[1];else{n.innerHTML="",n.classList.add("jexcel_tabs"),n.jexcel=[];var f=document.createElement("div"),k=n.appendChild(f),R=(f=document.createElement("div"),n.appendChild(f))}for(var q=[],d=[],o=0;o<a.length;o++){q[o]=document.createElement("div"),q[o].classList.add("jexcel_tab");var h=jexcel(q[o],a[o]);R.appendChild(q[o]),c[o]=n.jexcel.push(h),d[o]=document.createElement("div"),d[o].classList.add("jexcel_tab_link"),d[o].setAttribute("data-spreadsheet",n.jexcel.length-1),d[o].innerHTML=a[o].sheetName,d[o].onclick=function(){for(var V=0;V<k.children.length;V++)k.children[V].classList.remove("selected"),R.children[V].style.display="none";var b=this.getAttribute("data-spreadsheet");R.children[b].style.display="block",k.children[b].classList.add("selected")},k.appendChild(d[o])}for(var _=0;_<k.children.length;_++)k.children[_].classList.remove("selected"),R.children[_].style.display="none";return k.children[k.children.length-1].classList.add("selected"),R.children[k.children.length-1].style.display="block",c},jexcel.createTabs=jexcel.tabs,jexcel.fromSpreadsheet=function(n,a){var c,f=function(k){var R=[];return k.SheetNames.forEach(function(q){var d={rows:[],columns:[],data:[],style:{}};if(d.sheetName=q,(m=k.Sheets[q]["!cols"])&&m.length)for(var o=0;o<m.length;o++)d.columns[o]={},m[o]&&m[o].wpx&&(d.columns[o].width=m[o].wpx+"px");if((m=k.Sheets[q]["!rows"])&&m.length)for(o=0;o<m.length;o++)m[o]&&m[o].hpx&&(d.rows[o]={},d.rows[o].height=m[o].hpx+"px");if((m=k.Sheets[q]["!merges"])&&m.length>0)for(d.mergeCells=[],o=0;o<m.length;o++){var h=m[o].s.c,_=m[o].s.r,V=m[o].e.c,b=m[o].e.r,u=jexcel.getColumnNameFromId([h,_]);d.mergeCells[u]=[V-h+1,b-_+1]}var g=0,v=0,m=Object.keys(k.Sheets[q]);for(o=0;o<m.length;o++)if(m[o].substr(0,1)!="!"){var C=k.Sheets[q][m[o]],S=jexcel.getIdFromColumnName(m[o],!0);d.data[S[1]]||(d.data[S[1]]=[]),d.data[S[1]][S[0]]=C.f?"="+C.f:C.w,g<S[0]&&(g=S[0]),v<S[1]&&(v=S[1]),C.style&&Object.keys(C.style).length>0&&(d.style[m[o]]=C.style),C.s&&C.s.fgColor&&(d.style[m[o]]&&(d.style[m[o]]+=";"),d.style[m[o]]+="background-color:#"+C.s.fgColor.rgb)}for(var L=d.columns,H=0;H<=v;H++)for(o=0;o<=g;o++)d.data[H]||(d.data[H]=[]),d.data[H][o]||L<o&&(d.data[H][o]="");R.push(d)}),R};(c=new XMLHttpRequest).open("GET",n,!0),typeof Uint8Array<"u"?(c.responseType="arraybuffer",c.onload=function(k){var R=c.response,q=new Uint8Array(R),d=XLSX.read(q,{type:"array",cellFormula:!0,cellStyles:!0});a(f(d))}):(c.setRequestHeader("Accept-Charset","x-user-defined"),c.onreadystatechange=function(){if(c.readyState==4&&c.status==200){var k=convertResponseBodyToText(c.responseBody),R=XLSX.read(k,{type:"binary",cellFormula:!0,cellStyles:!0});a(f(R))}}),c.send()},jexcel.validLetter=function(n){return n.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?1:0},jexcel.injectArray=function(n,a,c){return n.slice(0,a).concat(c).concat(n.slice(a))},jexcel.getColumnName=function(n){var a="";return n>701?(a+=String.fromCharCode(64+parseInt(n/676)),a+=String.fromCharCode(64+parseInt(n%676/26))):n>25&&(a+=String.fromCharCode(64+parseInt(n/26))),a+String.fromCharCode(65+n%26)},jexcel.getIdFromColumnName=function(n,a){var c=/^[a-zA-Z]+/.exec(n);if(c){for(var f=0,k=0;k<c[0].length;k++)f+=parseInt(c[0].charCodeAt(k)-64)*Math.pow(26,c[0].length-1-k);--f<0&&(f=0);var R=parseInt(/[0-9]+$/.exec(n));R>0&&R--,n=a==1?[f,R]:f+"-"+R}return n},jexcel.getColumnNameFromId=function(n){return Array.isArray(n)||(n=n.split("-")),jexcel.getColumnName(parseInt(n[0]))+(parseInt(n[1])+1)},jexcel.getElement=function(n){var a=0,c=0;return function f(k){k.className&&k.classList.contains("jexcel_container")&&(c=k),k.tagName=="THEAD"?a=1:k.tagName=="TBODY"&&(a=2),k.parentNode&&(c||f(k.parentNode))}(n),[c,a]},jexcel.doubleDigitFormat=function(n){return(n=""+n).length==1&&(n="0"+n),n},jexcel.createFromTable=function(n,a){if(n.tagName=="TABLE"){a||(a={}),a.columns=[],a.data=[];var c=n.querySelectorAll("colgroup > col");if(c.length)for(var f=0;f<c.length;f++){if(!(k=c[f].style.width))var k=c[f].getAttribute("width");k&&(a.columns[f]||(a.columns[f]={}),a.columns[f].width=k)}var R=function(xe){var Se=xe.getBoundingClientRect(),je=Se.width>50?Se.width:50;a.columns[f]||(a.columns[f]={}),xe.getAttribute("data-celltype")?a.columns[f].type=xe.getAttribute("data-celltype"):a.columns[f].type="text",a.columns[f].width=je+"px",a.columns[f].title=xe.innerHTML,a.columns[f].align=xe.style.textAlign||"center",(Se=xe.getAttribute("name"))&&(a.columns[f].name=Se),(Se=xe.getAttribute("id"))&&(a.columns[f].id=Se),(Se=xe.getAttribute("data-mask"))&&(a.columns[f].mask=Se)},q=[],d=n.querySelectorAll(":scope > thead > tr");if(d.length){for(var o=0;o<d.length-1;o++){var h=[];for(f=0;f<d[o].children.length;f++){var _={title:d[o].children[f].textContent,colspan:d[o].children[f].getAttribute("colspan")||1};h.push(_)}q.push(h)}for(d=d[d.length-1].children,f=0;f<d.length;f++)R(d[f])}var V=0,b={},u={},g={},v={},m=n.querySelectorAll(":scope > tr, :scope > tbody > tr");for(o=0;o<m.length;o++)if(a.data[V]=[],a.parseTableFirstRowAsHeader!=1||d.length||o!=0){for(f=0;f<m[o].children.length;f++){if(C=m[o].children[f].getAttribute("data-formula"))C.substr(0,1)!="="&&(C="="+C);else var C=m[o].children[f].innerHTML;a.data[V].push(C);var S=jexcel.getColumnNameFromId([f,o]),L=m[o].children[f].getAttribute("class");L&&(v[S]=L);var H=parseInt(m[o].children[f].getAttribute("colspan"))||0,N=parseInt(m[o].children[f].getAttribute("rowspan"))||0;(H||N)&&(b[S]=[H||1,N||1]),m[o].children[f].style&&m[o].children[f].style.display=="none"&&(m[o].children[f].style.display="");var M=m[o].children[f].getAttribute("style");M&&(g[S]=M),m[o].children[f].classList.contains("styleBold")&&(g[S]?g[S]+="; font-weight:bold;":g[S]="font-weight:bold;")}m[o].style&&m[o].style.height&&(u[o]={height:m[o].style.height}),V++}else for(f=0;f<m[o].children.length;f++)R(m[o].children[f]);if(Object.keys(q).length>0&&(a.nestedHeaders=q),Object.keys(g).length>0&&(a.style=g),Object.keys(b).length>0&&(a.mergeCells=b),Object.keys(u).length>0&&(a.rows=u),Object.keys(v).length>0&&(a.classes=v),(m=n.querySelectorAll("tfoot tr")).length){var T=[];for(o=0;o<m.length;o++){var G=[];for(f=0;f<m[o].children.length;f++)G.push(m[o].children[f].textContent);T.push(G)}Object.keys(T).length>0&&(a.footers=T)}if(a.parseTableAutoCellType==1){var Y=[];for(f=0;f<a.columns.length;f++){var ae=!0,be=!0;for(Y[f]=[],o=0;o<a.data.length;o++)C=a.data[o][f],Y[f][C]||(Y[f][C]=0),Y[f][C]++,C.length>25&&(ae=!1),C.length==10&&C.substr(4,1)=="-"&&C.substr(7,1)=="-"||(be=!1);var se=Object.keys(Y[f]).length;be?a.columns[f].type="calendar":ae==1&&se>1&&se<=parseInt(.1*a.data.length)&&(a.columns[f].type="dropdown",a.columns[f].source=Object.keys(Y[f]))}}return a}console.log("Element is not a table")},jexcel.helpers=(component={getCaretIndex:function(n){if(this.config.root)var a=this.config.root;else a=window;var c=0,f=a.getSelection();if(f&&f.rangeCount!==0){var k=f.getRangeAt(0),R=k.cloneRange();R.selectNodeContents(n),R.setEnd(k.endContainer,k.endOffset),c=R.toString().length}return c},invert:function(n){for(var a=[],c=Object.keys(n),f=0;f<c.length;f++)a[n[c[f]]]=c[f];return a},getColumnName:function(n){var a="";return n>701?(a+=String.fromCharCode(64+parseInt(n/676)),a+=String.fromCharCode(64+parseInt(n%676/26))):n>25&&(a+=String.fromCharCode(64+parseInt(n/26))),a+String.fromCharCode(65+n%26)},getColumnNameFromCoords:function(n,a){return component.getColumnName(parseInt(n))+(parseInt(a)+1)},getCoordsFromColumnName:function(n){var a=/^[a-zA-Z]+/.exec(n);if(a){for(var c=0,f=0;f<a[0].length;f++)c+=parseInt(a[0].charCodeAt(f)-64)*Math.pow(26,a[0].length-1-f);--c<0&&(c=0);var k=parseInt(/[0-9]+$/.exec(n))||null;return k>0&&k--,[c,k]}},createFromTable:function(){},injectArray:function(n,a,c){return n.slice(0,a).concat(c).concat(n.slice(a))},parseCSV:function(n,a){a=a||",";for(var c=0,f=0,k=[[]],R=0,q=null,d=!1,o=!1,h=0;h<n.length;h++)if(k[f]||(k[f]=[]),k[f][c]||(k[f][c]=""),n[h]!="\r")if(n[h]!=`
`&&n[h]!=a||d!=0&&o!=1&&q){if(n[h]=='"'&&(d=!d),q===null){if((q=d)==1)continue}else if(q===!0&&!o&&n[h]=='"'){n[h+1]=='"'?(d=!0,k[f][c]+=n[h],h++):o=!0;continue}k[f][c]+=n[h]}else{if(q=null,d=!1,o=!1,k[f][c][0]=='"'){var _=k[f][c].trim();_[_.length-1]=='"'&&(k[f][c]=_.substr(1,_.length-2))}n[h]==`
`?(c=0,f++):++c>R&&(R=c)}for(var V=0;V<k.length;V++)for(h=0;h<=R;h++)k[V][h]===void 0&&(k[V][h]="");return k}},component),typeof jQuery<"u"&&function(n){n.fn.jspreadsheet=n.fn.jexcel=function(a){var c=n(this).get(0);return c.jexcel?Array.isArray(c.jexcel)?c.jexcel[a][arguments[1]].apply(this,Array.prototype.slice.call(arguments,2)):c.jexcel[a].apply(this,Array.prototype.slice.call(arguments,1)):jexcel(n(this).get(0),arguments[0])}}(jQuery),jexcel},module.exports=factory()}},__webpack_module_cache__={};function __webpack_require__(n){var a=__webpack_module_cache__[n];if(a!==void 0)return a.exports;var c=__webpack_module_cache__[n]={exports:{}};return __webpack_modules__[n].call(c.exports,c,c.exports,__webpack_require__),c.exports}var __webpack_exports__=__webpack_require__(138);return __webpack_exports__}()})}(dist)),dist.exports}var distExports=requireDist();const jspreadsheet=getDefaultExportFromCjs(distExports);function updateEncode(){var n=document.getElementById("assemblyString").value,a=encodeInstruction({assemblyString:n});document.getElementById("result").innerHTML="Encoded result: "+a.binary.slice(2)}function updateDecode(){var n=document.getElementById("encodedvalue").value;n=parseInt(n,2);var a=decodeInstruction({value:n});document.getElementById("result").innerHTML="Decoded result: "+JSON.stringify(a,null,2)}function updatePruned(){for(var n=[],a={},c=document.getElementsByClassName("bit-button"),f=0;f<c.length;f++){var k=c[f].textContent,R=k==="1"?"1":k==="0"?"0":"-";n.push(R)}a=pruneInstructions({constraints:n});var{tabulatedData:q,generatedColumns:d}=tableEncoder({prunedInstructions:a});document.getElementById("spreadsheet").innerHTML="",jspreadsheet(document.getElementById("spreadsheet"),{data:q,columns:d})}let sliderules$1={loadInto:n=>{document.getElementById(n).append(Encoder(),Decoder(),Pruner(),_div({id:"result"}),_div({id:"spreadsheet"}))},updateEncode,updateDecode,updatePruned};return window.sliderules=sliderules$1,sliderules$1});
